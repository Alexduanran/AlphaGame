{"version":3,"sources":["pages/Genetic.module.css","pages/Reinforcement.module.css","pages/Battle.module.css","pages/App.module.css","games/genetic_algorithm/individual.js","games/pong/neural_network.js","games/pong/Paddle.js","games/pong/Ball.js","games/pong/settings.js","games/genetic_algorithm/population.js","games/genetic_algorithm/selection.js","games/genetic_algorithm/mutation.js","games/genetic_algorithm/crossover.js","games/pong/Pong.js","games/snake/sprite.js","games/snake/util.js","games/snake/snakeClass.js","games/snake/snakeGameClass.js","games/snake/agentClass.js","games/snake/train.js","games/snake/config.js","games/snake/SnakeEnv.js","pages/Genetic.js","media/snake.png","media/pong.png","media/flappybird.png","media/home2_gif.gif","media/snake_gif.gif","media/pong_gif.gif","media/flappybird_gif.gif","pages/Home.js","pages/Reinforcement.js","pages/Battle.js","pages/App.js","reportWebVitals.js","index.js","pages/Home.module.css"],"names":["module","exports","Individual","nj","require","random","sigmoid","x","exp","tanh","relu","arr","i","push","linear","FeedForwardNetwork","layer_nodes","hidden_activation","output_activation","init_method","feed_forward","X","A_prev","L","length","W","b","Z","l","params","toString","dot","add","array","tolist","out","this","inputs","Error","arrW","j","uniform","arrb","get_activation_by_name","name","activations","func","toLowerCase","console","assert","Paddle","p5","xPaddle","yPaddle","ySpeed","boardSize","chromosome","hidden_layer_architecture","fitness","calculate_fitness","hit","Math","min","distance_travelled","ball_travelled","board_size","distance_to_ball","max","reset","is_alive","update","ball","network","yBall","move","abs","draw","winner","champion","fill","rect","num_inputs","network_architecture","Ball","xBall","xSpeed","paddle","xLast","yLast","ellipse","settings","Population","individuals","num_individuals","num_individuals_","num_genes","shape","num_genes_","average_fitness","sum","average_fitness_","fittest_individual","best","indi","individual","fittest_individual_","get_fitness_std","std","map","a","roulette_wheel_selection","population","selection","wheel","pick","float","current","gaussian_mutation","prob_mutation","scale","mu","sigma","mutation_array","normal","set","get","simulated_binary_crossover","parent1","parent2","eta","rand","gamma","zeros","multiply","ones","subtract","single_point_binary_crossover","offspring1","copy","offspring2","Pong","props","cumulativeSum","value","_mutation_bins","_crossover_bins","_SPBX_type","_SBX_eta","_mutation_rate","_next_gen_size","lower","format","dimension","log","balls","current_generation","winner_index","champion_index","champion_fitness","Number","NEGATIVE_INFINITY","num_hit","best_hit","training_paddle","newball","next_generation","indexOf","sort","reverse","slice","elitism_selection","shuffle","next_pop","p1","p2","c1_params","c2_params","c1_W_l","c2_W_l","c1_b_l","c2_b_l","p1_W_l","p2_W_l","p1_b_l","p2_b_l","_crossover","_mutation","c1","c2","parent1_weights","parent2_weights","parent1_bias","parent2_bias","rand_crossover","crossover_bucket","child1_weights","child2_weights","child1_bias","child2_bias","SBX","rand_mutation","mutation_bucket","mutation_rate","sqrt","temporaryValue","randomIndex","currentIndex","floor","setup","canvasParentRef","createCanvas","parent","background","textSize","text","bally","int","speedy","still_alive","Rect","y","w","h","context","sprite","point","overlap","contains","Sprite","fname","PI","image","undefined","Image","src","ctx","drawImage","rotate","angle","save","dpr","translate","TO_RADIAN","width","height","restore","getRandInt","step","ceil","arrayEqual","compare","arrayContains","obj","boo","forEach","item","euclidean","x1","y1","x2","y2","random_sample","batch_size","array_copy","sample","rand_idx","splice","String","prototype","args","arguments","replace","Snake","direction","boxSize","board_x","board_y","body","initialize","head","k1","k2","tempRect","DIRECTION","collideWall","newHead","unshift","pop","tail","part","collideRect","extraWalls","wallRect","bool","max_width","max_height","Apple","boxLength","avoid","avoidCompare","util","rand_x","rand_y","inAvoid","snakeGame","key","FPS","snakeLength","collideBody","manual","stateType","rewardType","rewardValues","eat","die","closer","away","gridSize","array2d","size","pix","walls","generateExtraWalls","timer","snake","apple","done","score","best_score","key_pressed","keyboard_events","last_snake","last_apple","rewardMeasures","action","update_state_12bool","new_state","Array","test_case","oppo","state","test","collideWithWall","tf","reward_basic","check","_direction","move_apple","clearInterval","manual_play","update_state","avoid_wall","concat","canvas","clearRect","snakeSprite","wallSprite","appleSprite","self","setInterval","tempTail","changeDirection","addHead","end_game","deleteTail","collideWithBody","addTail","conclude_step","last_distance","distance","next_state","reward","clear_reward","document","addEventListener","event","Deque","maxlen","shift","Agent","state_size","action_size","epsilon","epsilon_decay","epsilon_min","learning_rate","model","build_model","memory","dense","units","inputShape","activation","compile","optimizer","adam","learningRate","loss","pushDeque","exploit","Promise","resolve","reject","predict","reshape","pred","argMax","data","mini_batch","target","future_value","dataSync","target_state","then","fit","performanceArray","train","env","agent","n_episodes","max_moves","last_episode","exp_replay","e","cum_reward","act","remember","replay","processLog","EXTRA_WALL","row","col","SnakeEnv","screen_width","screen_height","adaptive_grid_size","screen_size","text_size","round","button_radius","button_x","button_y","env_params","doManual","game","doTest","id","position","doTrain","stroke","mouseClicked","mouseX","mouseY","Genetic","gameParentRef","useRef","plotParentRef","useState","gameScreenDimension","setGameScreenDimension","setPlotScreenDimension","useEffect","offsetWidth","offsetHeight","basename","process","className","css","container","onClick","history","to","gameScreen","ref","path","plotScreen","footer","href","style","textDecoration","color","Home","home2_gif","setBackground","swipeIndex","setSwipeIndex","GameSwiper","swiperContainer","effect","spaceBetween","slidesPerView","dynamicBullets","mousewheel","pagination","clickable","centeredSlides","loop","initialSlide","square","backgroundImage","snake_png","pong_png","flappybird_png","GameModes","prop","snake_gif","pong_gif","flappybird_gif","grid","smallpic","smallsquare","mode","SwiperCore","use","EffectCoverflow","Pagination","Mousewheel","screen","swiper","Reinforcement","Battle","createBrowserHistory","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"2FACAA,EAAOC,QAAU,CAAC,WAAa,4BAA4B,UAAY,2BAA2B,OAAS,wBAAwB,WAAa,4BAA4B,KAAO,sBAAsB,KAAO,sBAAsB,WAAa,8B,oBCAnPD,EAAOC,QAAU,CAAC,WAAa,kCAAkC,UAAY,iCAAiC,OAAS,8BAA8B,WAAa,kCAAkC,KAAO,4BAA4B,KAAO,4BAA4B,WAAa,oC,oBCAvRD,EAAOC,QAAU,CAAC,WAAa,2BAA2B,UAAY,0BAA0B,OAAS,uBAAuB,WAAa,2BAA2B,KAAO,qBAAqB,KAAO,qBAAqB,WAAa,6B,oBCA7OD,EAAOC,QAAU,CAAC,WAAa,0B,uYC6BhBC,MA9Bf,aCAIC,EAAKC,EAAQ,KACXC,EAASD,EAAQ,KAEVE,EAAU,SAAAC,GAAM,OAAO,GAAO,EAAMJ,EAAGK,KAAKD,KAC5CE,EAAO,SAAAF,GAAM,OAAOJ,EAAGM,KAAKF,IAC5BG,EAAO,SAAAH,GAChB,IADqB,EACjBI,EAAM,GADW,cAEPJ,GAFO,IAErB,2BAAiB,CAAC,IAATK,EAAQ,QACTA,GAAK,EACLD,EAAIE,KAAKD,GAETD,EAAIE,KAAK,CAAC,KANG,8BAQrB,OAAOF,GAEEG,EAAS,SAAAP,GAAC,OAAIA,GAEdQ,EACT,WAAYC,EAAaC,EAAmBC,GAAsD,IAAD,OAAlCC,EAAkC,uDAAtB,UAAsB,yBAiCjGC,aAAe,SAACC,GAOZ,IANA,IAAIC,EAASD,EACPE,EAAI,EAAKP,YAAYQ,OAAS,EAChCC,EAAI,KACJC,EAAI,KACJC,EAAI,KAECC,EAAE,EAAGA,EAAEL,EAAGK,IACfH,EAAI,EAAKI,OAAO,IAAMD,EAAEE,YACxBJ,EAAI,EAAKG,OAAO,IAAMD,EAAEE,YAIxBH,EAAIxB,EAAG4B,IAAIN,EAAGH,GAAQU,IAAI7B,EAAG8B,MAAMP,IAEnCJ,EAAS,EAAKL,kBAAkBU,EAAEO,UAElC,EAAKL,OAAO,IAAMD,EAAEE,YAAcR,EAGtCG,EAAI,EAAKI,OAAO,IAAMN,EAAEO,YACxBJ,EAAI,EAAKG,OAAO,IAAMN,EAAEO,YACxBH,EAAIxB,EAAG4B,IAAIN,EAAGH,GAAQU,IAAI7B,EAAG8B,MAAMP,IACnC,IAAMS,EAAM,EAAKlB,kBAAkBU,EAAEO,UACrC,EAAKL,OAAO,IAAIN,EAAEO,YAAcK,EAChC,IAAK,IAAIvB,EAAE,EAAGA,EAAEuB,EAAIX,OAAQZ,KACP,OAAb,EAAKuB,KAGDA,EAAIvB,GAAG,GAAK,EAAKuB,OAFrB,EAAKA,IAAMvB,GAQnB,OAAO,EAAKuB,KAnEZC,KAAKP,OAAS,GACdO,KAAKpB,YAAcA,EACnBoB,KAAKnB,kBAAoBA,EACzBmB,KAAKlB,kBAAoBA,EACzBkB,KAAKC,OAAS,KACdD,KAAKD,IAAM,KAGX,IAAK,IAAIP,EAAE,EAAGA,EAAIQ,KAAKpB,YAAYQ,OAAQI,IAAK,CAC5C,GAAmB,WAAfT,EAgBA,MAAM,IAAImB,MAAM,+BAdhB,IADA,IAAIC,EAAO,GACF3B,EAAE,EAAGA,EAAIwB,KAAKpB,YAAYY,GAAIhB,IAAK,CAExC,IADA,IAAID,EAAM,GACD6B,EAAE,EAAGA,EAAIJ,KAAKpB,YAAYY,EAAE,GAAIY,IACrC7B,EAAIE,KAAKR,EAAOoC,SAAS,EAAE,EAAlBpC,IAEbkC,EAAK1B,KAAKF,GAEd,IAAI+B,EAAO,GACX,IAAS9B,EAAE,EAAGA,EAAIwB,KAAKpB,YAAYY,GAAIhB,IACnC8B,EAAK7B,KAAK,CAACR,EAAOoC,SAAS,EAAE,EAAlBpC,KAEf+B,KAAKP,OAAO,IAAMD,EAAEE,YAAcS,EAClCH,KAAKP,OAAO,IAAMD,EAAEE,YAAcY,EAKtCN,KAAKP,OAAO,IAAMD,EAAEE,YAAc,OA2CjCa,EAAyB,SAAAC,GAOlC,IANA,IAAMC,EAAc,CAAC,CAAC,OAAQnC,GACV,CAAC,UAAWJ,GACZ,CAAC,SAAUQ,GACX,CAAC,OAAQL,IAEzBqC,EAAO,GACFlC,EAAE,EAAGA,EAAEiC,EAAYrB,OAAQZ,IAC5BiC,EAAYjC,GAAG,KAAOgC,EAAKG,eAC3BD,EAAKjC,KAAKgC,EAAYjC,GAAG,IAGjC,OADAoC,QAAQC,OAAsB,GAAfH,EAAKtB,QACbsB,EAAK,ICCDI,E,kDAjGX,WAAYC,GAA6J,IAAD,IAAxJC,EAAwJ,uDAAhJ,EAAGC,EAA6I,uDAArI,IAAKC,EAAgI,uDAAzH,EAAGC,EAAsH,uCAA3GC,EAA2G,uDAAhG,KAAMC,EAA0F,uDAAhE,CAAC,GAAG,IAAKxC,EAAuD,uDAArC,OAAQC,EAA6B,uDAAX,UAAW,qBACpK,cAAMhB,MA0CVwD,QAAU,WACN,OAAO,EAAKA,SA5CwJ,EA+CxKC,kBAAoB,WAChB,EAAKD,QAA6C,KAAlC,WAAK,EAAKE,KAAiB,IAAX,EAAKA,KAAuF,KAAlE,EAAIC,KAAKC,IAAI,EAAKC,mBAAqB,EAAKC,eAAgB,IAA4D,IAA9C,EAAKC,WAAW,GAAK,EAAKC,kBAC9J,EAAKR,QAAUG,KAAKM,IAAI,EAAKT,QAAS,KAjD8H,EAoDxKU,MAAQ,WACJ,EAAKV,QAAU,EACf,EAAKE,IAAM,EACX,EAAKG,mBAAqB,EAC1B,EAAKG,iBAAmB,EACxB,EAAKG,SAAW,GAzDoJ,EA4DxKC,OAAS,WAA6B,IAA5BjC,EAA2B,uDAApB,KAAMkC,EAAc,uDAAT,KAaxB,OAZe,OAAXlC,EACA,EAAKmC,QAAQpD,aAAaiB,GACV,OAATkC,IACP,EAAKlB,QAAUkB,EAAKE,MAAQ,IAEP,IAArB,EAAKD,QAAQrC,IACb,EAAKmB,QAAU,GACa,IAArB,EAAKkB,QAAQrC,IACpB,EAAKmB,OAAS,GACc,IAArB,EAAKkB,QAAQrC,MACpB,EAAKmB,OAAS,IAEX,GAzE6J,EA4ExKoB,KAAO,WACH,EAAKrB,SAAW,EAAKC,OACrB,EAAKS,oBAAsBF,KAAKc,IAAI,EAAKrB,SA9E2H,EAiFxKsB,KAAO,SAACzB,GAAsC,IAAlC0B,EAAiC,wDAAnBC,EAAmB,wDACpC,EAAKT,WAECS,GAGAD,GAFP1B,EAAG4B,KAAK,WACR5B,EAAG6B,KAAK,EAAK5B,QAAS,EAAKC,QAAS,GAAI,MAKxCF,EAAG4B,KAAK,WACR5B,EAAG6B,KAAK,EAAK5B,QAAS,EAAKC,QAAS,GAAI,OA1F5C,EAAKD,QAAUA,EACf,EAAKC,QAAUA,EACf,EAAKC,OAASA,EACd,EAAKW,WAAaV,EAElB,EAAKG,QAAU,EACf,EAAKE,IAAM,EACX,EAAKG,mBAAqB,EAC1B,EAAKC,eAAiB,EACtB,EAAKE,iBAAmB,EACxB,EAAKG,UAAW,EAEhB,EAAKZ,0BAA4BA,EACjC,EAAKxC,kBAAoBA,EACzB,EAAKC,kBAAoBA,EAMzB,IAAM+D,EAAa,EAtBiJ,OAuBpK,EAAKC,qBAAuB,CAACD,IAC7B,IAAKC,sBAAqBrE,KAA1B,oBAAkC,EAAK4C,4BACvC,EAAKyB,qBAAqBrE,KAAK,GAC/B,EAAK2D,QAAU,IAAIzD,EAAmB,EAAKmE,qBACTvC,EAAuB,EAAK1B,mBAC5B0B,EAAuB,EAAKzB,oBAI1DsC,IAEA,EAAKgB,QAAQ3C,OAAS2B,GAlC0I,E,UADvJtD,GCmDNiF,EAvDX,WAAYC,EAAOX,EAAOY,EAAQ/B,GAAS,IAAD,gCAa1CgB,OAAS,SAACgB,EAAQ/B,GACd,EAAKQ,oBAAsBF,KAAKc,IAAI,EAAKrB,QAErC,EAAKmB,MAAQ,GACb,EAAKA,MAAQ,EACb,EAAKnB,SAAW,GAEX,EAAKmB,MAAQlB,EAAU,GAAG,IAC/B,EAAKkB,MAAQlB,EAAU,GAAG,GAC1B,EAAKD,SAAW,GAEX,EAAK8B,MAAQ7B,EAAU,GAAG,IAC/B,EAAK6B,MAAQ7B,EAAU,GAAG,GAC1B,EAAK8B,SAAW,GAEX,EAAKZ,MAAQa,EAAOjC,QAAQ,IAAM,EAAKoB,MAAQa,EAAOjC,QAAU,IAAM,EAAKkC,MAAQ,IAAM,EAAKH,OAAS,IAC5G,EAAKC,SAAW,EAChBC,EAAO1B,KAAO,EACd0B,EAAOpB,iBAAmB,GAErB,EAAKkB,MAAQ,IAClB,EAAKC,SAAW,EAChBC,EAAOtB,eAAiB,EAAKD,mBAC7BuB,EAAOjB,UAAW,EAClBiB,EAAOpB,iBAAmBL,KAAKc,IAAI,EAAKS,MAAQE,EAAOlC,WArCrB,KAyC1CsB,KAAO,WACH,EAAKa,MAAQ,EAAKH,MAClB,EAAKI,MAAQ,EAAKf,MAElB,EAAKW,OAAS,EAAKC,OACnB,EAAKZ,OAAS,EAAKnB,QA9CmB,KAiD1CsB,KAAO,SAACzB,GACJA,EAAG4B,KAAK,WACR5B,EAAGsC,QAAQ,EAAKL,MAAO,EAAKX,MAAO,GAAI,KAlDvCrC,KAAKgD,MAAQA,EACbhD,KAAKqC,MAAQA,EACbrC,KAAKiD,OAASA,EACdjD,KAAKkB,OAASA,EACdlB,KAAKmD,MAAQH,EAAQC,EACrBjD,KAAKoD,MAAQf,EAAQnB,EAErBlB,KAAKiC,UAAW,EAChBjC,KAAK2B,mBAAqB,GC6CnB2B,EAvDE,CAEb,wBAA+B,OAE/B,wBAA+B,UAE/B,4BAA+B,CAAC,GAAI,GAAI,IAOxC,cAA+B,IAG/B,mBAA+B,SAE/B,qBAA+B,EAE/B,2BAA+B,EAM/B,QAA+B,IAE/B,gBAA+B,EAG/B,UAA+B,IAE/B,iBAA+B,EAE/B,yBAA+B,iBAK/B,YAA+B,GAE/B,cAA+B,IAU/B,eAA+B,QCpD/BvF,EAAKC,EAAQ,KA6DFuF,EA1DX,WAAYC,GAAc,IAAD,gCAIzBC,gBAAkB,WACd,OAAO,EAAKD,YAAYpE,QALH,KAQzBsE,iBAAmB,WACf,MAAM,IAAIxD,MAAM,yFATK,KAYzByD,UAAY,WACR,OAAO,EAAKH,YAAY,GAAGpC,WAAWwC,MAAM,IAbvB,KAgBzBC,WAAa,WACT,MAAM,IAAI3D,MAAM,mFAjBK,KAoBzB4D,gBAAkB,WACd,IADoB,EAChBC,EAAM,EADU,cAEG,EAAKP,aAFR,IAEpB,4BACIO,GADJ,QACsBzC,SAHF,8BAIpB,OAAOyC,EAAM,EAAKP,YAAYpE,QAxBT,KA2BzB4E,iBAAmB,WACf,MAAM,IAAI9D,MAAM,8DA5BK,KA+BzB+D,mBAAqB,WACjB,IADuB,EACnBC,EAAO,EACPC,EAAO,KAFY,cAGA,EAAKX,aAHL,IAGvB,2BAAyC,CAAC,IAAjCY,EAAgC,QACjCA,EAAW9C,QAAU4C,IACrBA,EAAOE,EAAW9C,QAClB6C,EAAOC,IANQ,8BASvB,OAAOD,GAxCc,KA2CzBE,oBAAsB,WAClB,MAAM,IAAInE,MAAM,gEA5CK,KA+CzBqB,kBAAoB,WAAO,IAAD,gBACC,EAAKiC,aADN,IACtB,2BAAyC,SAC1BjC,qBAFO,gCA/CD,KAqDzB+C,gBAAkB,WACd,OAAOvG,EAAGwG,IAAIxG,EAAG8B,MAAM,EAAK2D,YAAYgB,KAAI,SAAAC,GAAC,OAAEA,EAAEnD,cArDjDtB,KAAKwD,YAAcA,GCHrBvF,GADGD,EAAQ,KACFA,EAAQ,MAOhB,SAAS0G,EAAyBC,EAAYlB,GACjD,IADkE,EAC9DmB,EAAY,GACZC,EAAQ,EAFsD,cAG3CF,EAAWnB,aAHgC,IAGlE,2BAA+C,CAC3CqB,IADKT,EAAsC,SACvB9C,SAJ0C,8BAMlE,IAAK,IAAI9C,EAAE,EAAGA,EAAEiF,EAAiBjF,IAAK,CAClC,IADkC,EAC5BsG,EAAO7G,EAAO8G,MAAM,EAAGF,GACzBG,EAAU,EAFoB,cAGXL,EAAWnB,aAHA,IAGlC,2BAA+C,CAAC,IAAvCY,EAEL,IADAY,IADKZ,EAAsC,SACrB9C,SACRwD,EAAM,CAChBF,EAAUnG,KAAK2F,GACf,QAP0B,+BAWtC,OAAOQ,ECzBF5G,EAAQ,KAAjB,IACIC,EAASD,EAAQ,KAEd,SAASiH,EAAkB7D,EAAY8D,GAS3C,IAT4F,IAAlCC,EAAiC,uDAA3B,KAAMC,EAAqB,uDAAlB,KAAMC,EAAY,uDAAN,KAQjFC,EAAiB,GACZ9G,EAAE,EAAGA,EAAE4C,EAAWwC,MAAM,GAAIpF,IAAK,CAErC,IADA,IAAID,EAAM,GACD6B,EAAE,EAAGA,EAAEgB,EAAWwC,MAAM,GAAIxD,IACjC7B,EAAIE,KAAKR,EAAO8G,QAAUG,EAAgB,EAAI,GAClDI,EAAe7G,KAAKF,GAGzB,IAAI0G,EAAoB,GACxB,GAAIG,GAAMC,EACNJ,EAAoBhH,EAAOsH,OAAOH,EAAIC,EAAlBpH,QAEnB,IAASO,EAAE,EAAGA,EAAE4C,EAAWwC,MAAM,GAAIpF,IAAK,CAEtC,IADID,EAAM,GACD6B,EAAE,EAAGA,EAAEgB,EAAWwC,MAAM,GAAIxD,IACjC7B,EAAIE,KAAKR,EAAOsH,QAAPtH,IACbgH,EAAkBxG,KAAKF,GAIhC,GAAI4G,EACA,IAAS3G,EAAI,EAAGA,EAAE4C,EAAWwC,MAAM,GAAIpF,IAClC,IAAS4B,EAAE,EAAGA,EAAEgB,EAAWwC,MAAM,GAAIxD,IAC7BkF,EAAe9G,GAAG4B,KAClB6E,EAAkBzG,GAAG4B,IAAM+E,GAK5C,IAAS3G,EAAI,EAAGA,EAAE4C,EAAWwC,MAAM,GAAIpF,IAClC,IAAS4B,EAAE,EAAGA,EAAEgB,EAAWwC,MAAM,GAAIxD,IACJ,IAAzBkF,EAAe9G,GAAG4B,IAClBgB,EAAWoE,IAAIhH,EAAG4B,EAAGgB,EAAWqE,IAAIjH,EAAE4B,GAAK6E,EAAkBzG,GAAG4B,IC3ChF,IAAIrC,EAAKC,EAAQ,KACFA,EAAQ,KAEhB,SAAS0H,EAA2BC,EAASC,EAASC,GAUzD,IAFA,IAAIC,EAAO/H,EAAGE,OAAOF,EAAG8B,MAAM8F,GAAS/B,OACnCmC,EAAQhI,EAAGiI,MAAMjI,EAAG8B,MAAM8F,GAAS/B,OAC9BpF,EAAE,EAAGA,EAAEuH,EAAMnC,MAAM,GAAIpF,IAC5B,IAAK,IAAI4B,EAAE,EAAGA,EAAE2F,EAAMnC,MAAM,GAAIxD,IACxB0F,EAAKL,IAAIjH,EAAE4B,IAAM,GACjB2F,EAAMP,IAAIhH,EAAG4B,EAAb,SAAkB,EAAI0F,EAAKL,IAAIjH,EAAE4B,GAAQ,GAAOyF,EAAM,KAGtDE,EAAMP,IAAIhH,EAAG4B,EAAb,SAAkB,GAAO,GAAO,EAAM0F,EAAKL,IAAIjH,EAAE4B,KAAU,GAAOyF,EAAM,KASpF,MAAO,CAJcE,EAAMnG,IAAI,GAAIqG,SAASN,GAAU/F,IAAI7B,EAAGmI,KAAKH,EAAMnC,OAAOuC,SAASJ,IAAQE,SAASL,GAAUK,SAAS,IAEvGlI,EAAGmI,KAAKH,EAAMnC,OAAOuC,SAASJ,GAAQE,SAASN,GAAU/F,IAAKmG,EAAMnG,IAAI,GAAIqG,SAASL,IAAUK,SAAS,KAkB1H,SAASG,EAA8BT,EAASC,GAAqB,IACpES,EAAatI,EAAGuI,KAAKX,GACrBY,EAAaxI,EAAGuI,KAAKV,GASzB,MAAO,CAACS,EAAYE,GC7CxB,IAAMtI,EAASD,EAAQ,KACdA,EAAQ,KA4TFwI,MA1Tf,SAAcC,GACV,IAAuB1C,EAAjB2C,GAAiB3C,EAA8B,EAAvB,SAAA4C,GAAK,OAAI5C,GAAO4C,IAC1CC,EAAiB,CAACtD,EAAQ,qBAA0BA,EAAQ,4BAAgCkB,IAAIkC,GAChGG,EAAkB,CAACvD,EAAQ,gBAAqBA,EAAQ,kBAAsBkB,IAAIkC,GAClFI,EAAaxD,EAAQ,UAAc3C,cACnCoG,EAAWzD,EAAQ,QACnB0D,EAAiB1D,EAAQ,cAGzB2D,EAAiB,KACrB,GAAgD,QAA5C3D,EAAQ,eAAmB3C,cAC3BsG,EAAiB3D,EAAQ,YAAkBA,EAAQ,kBAClD,IAA0C,SAAtCA,EAAQ,eAAmB4D,QAGhC,MAAM,IAAIhH,MAAM,iCAAiCiH,OAAO7D,EAAQ,iBAFhE2D,EAAiB3D,EAAQ,cAI7B,IAAIzB,EAAa4E,EAAMW,UACvBxG,QAAQyG,IAAIxF,GAEZ,IAAI2B,EAAc,GACd8D,EAAQ,GAER3C,EAAa,IAAIpB,EAAWC,GAC5B+D,EAAqB,EACrB9E,EAAS,KACT+E,GAAgB,EAChB9E,EAAW,KACX+E,GAAkB,EAClBC,EAAmBC,OAAOC,kBAE1BC,EAAU,EACVC,EAAW,EAEXC,EAAkB,KAClBC,GAAU,EAqFRC,EAAkB,SAAClH,GACrBwG,IACAS,GAAU,EACVH,EAAU,EAHkB,oBAMLlD,EAAWnB,aANN,IAM5B,oCACejC,qBAPa,8BAU5BkB,EAASkC,EAAWV,qBACpBuD,EAAe7C,EAAWnB,YAAY0E,QAAQzF,GAC1CA,EAAOnB,QAAUoG,IACjBA,EAAmBjF,EAAOnB,QAC1BoB,EAAWD,EACXgF,EAAiBD,GAErB/E,EAAOT,QACPU,EAASV,QAGTpB,QAAQyG,IAAI,qCAAsCE,EAAoB,2BACtE3G,QAAQyG,IAAI,mBAAoB1C,EAAWV,qBAAqB3C,SAEhEV,QAAQyG,IAAI,uBAAwB1C,EAAWb,mBAE/Ca,EAAWnB,YH5JZ,SAA2BmB,EAAYlB,GAE1C,OADkBkB,EAAWnB,YAAY2E,MAAK,SAAA1D,GAAC,OAAEA,EAAEnD,WAAS8G,UACzCC,MAAM,EAAG5E,GG0JC6E,CAAkB3D,EAAYrB,EAAQ,aAC/DqB,EAAWnB,YAAc+E,EAAQ5D,EAAWnB,aAC5C,IAAIgF,EAAW,GAQf,IALiD,SAA7ClF,EAAQ,eAAmB3C,gBAC3B6H,EAAS/J,KAAKgE,GACd+F,EAAS/J,KAAKiE,IAGX8F,EAASpJ,OAAS6H,GAAgB,CAQrC,IARsC,IAAD,EACtBvC,EAAyBC,EAAY,GADf,mBAChC8D,EADgC,KAC5BC,EAD4B,KAE/BvJ,EAAIsJ,EAAGrG,QAAQxD,YAAYQ,OAC7BuJ,EAAY,GACZC,EAAY,GAIPpJ,EAAI,EAAGA,EAAIL,EAAGK,IAAK,CACxB,IAKIqJ,EAAeC,EAAeC,EAAeC,EAL3CC,EAASR,EAAGrG,QAAQ3C,OAAO,IAAMD,EAAEE,YACnCwJ,EAASR,EAAGtG,QAAQ3C,OAAO,IAAMD,EAAEE,YACnCyJ,EAASV,EAAGrG,QAAQ3C,OAAO,IAAMD,EAAEE,YACnC0J,EAASV,EAAGtG,QAAQ3C,OAAO,IAAMD,EAAEE,YAJjB,EAUW2J,EAAWJ,EAAQC,EAAQC,EAAQC,GAV9C,mBAUvBP,EAVuB,KAUfC,EAVe,KAUPC,EAVO,KAUCC,EAVD,KAcxBM,EAAUT,EAAQC,EAAQC,EAAQC,GAGlCL,EAAU,IAAMnJ,EAAEE,YAAcmJ,EAChCD,EAAU,IAAMpJ,EAAEE,YAAcoJ,EAChCH,EAAU,IAAMnJ,EAAEE,YAAcqJ,EAChCH,EAAU,IAAMpJ,EAAEE,YAAcsJ,EAGhC,IAAK,IAAIxK,EAAE,EAAGA,EAAEmK,EAAU,IAAInJ,EAAEE,YAAYkE,MAAM,GAAIpF,IAClD,IAAK,IAAI4B,EAAE,EAAGA,EAAEuI,EAAU,IAAInJ,EAAEE,YAAYkE,MAAM,GAAIxD,IAClDuI,EAAU,IAAInJ,EAAEE,YAAY8F,IAAIhH,EAAG4B,EAAGuI,EAAU,IAAInJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IAAM,GAAK,EAAIuI,EAAU,IAAInJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IAC3HuI,EAAU,IAAInJ,EAAEE,YAAY8F,IAAIhH,EAAG4B,EAAGuI,EAAU,IAAInJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,GAAK,EAAI,EAAIuI,EAAU,IAAInJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IACzHwI,EAAU,IAAIpJ,EAAEE,YAAY8F,IAAIhH,EAAG4B,EAAGwI,EAAU,IAAIpJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IAAM,GAAK,EAAIwI,EAAU,IAAIpJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IAC3HwI,EAAU,IAAIpJ,EAAEE,YAAY8F,IAAIhH,EAAG4B,EAAGwI,EAAU,IAAIpJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,GAAK,EAAI,EAAIwI,EAAU,IAAIpJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IACzHuI,EAAU,IAAInJ,EAAEE,YAAY8F,IAAIhH,EAAG4B,EAAGuI,EAAU,IAAInJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IAAM,GAAK,EAAIuI,EAAU,IAAInJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IAC3HuI,EAAU,IAAInJ,EAAEE,YAAY8F,IAAIhH,EAAG4B,EAAGuI,EAAU,IAAInJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,GAAK,EAAI,EAAIuI,EAAU,IAAInJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IACzHwI,EAAU,IAAIpJ,EAAEE,YAAY8F,IAAIhH,EAAG4B,EAAGwI,EAAU,IAAIpJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IAAM,GAAK,EAAIwI,EAAU,IAAIpJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IAC3HwI,EAAU,IAAIpJ,EAAEE,YAAY8F,IAAIhH,EAAG4B,EAAGwI,EAAU,IAAIpJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,GAAK,EAAI,EAAIwI,EAAU,IAAIpJ,EAAEE,YAAY+F,IAAIjH,EAAG4B,IAMrI,IAAImJ,EAAK,IAAIzI,EAAOC,EAAI,EAAGc,EAAW,GAAG,EAAE,GAAI,EAAGA,EAAY8G,EAClDrF,EAAQ,4BACRA,EACAA,EAAQ,oBAChBkG,EAAK,IAAI1I,EAAOC,EAAI,EAAGc,EAAW,GAAG,EAAE,GAAI,EAAGA,EAAY+G,EAClDtF,EAAQ,4BACRA,EACAA,EAAQ,oBAGpBkF,EAAS/J,KAAT,MAAA+J,EAAiB,CAACe,EAAGC,IAEzBjB,EAAQC,GACR7D,EAAWnB,YAAcgF,GAIvBa,EAAa,SAACI,EAAiBC,EAAiBC,EAAcC,GAGhE,IAFA,IAAMC,EAAiB5L,EAAO8G,QAC1B+E,EAAmB,KACdtL,EAAI,EAAGA,EAAIqI,EAAgBzH,OAAQZ,IACpCqL,EAAiBhD,EAAgBrI,KACjCsL,EAAmBtL,EAAE,GAE7B,IAAIuL,EAAiB,KACjBC,EAAiB,KACjBC,EAAc,KACdC,EAAc,KAGlB,GAAyB,IAArBJ,EAAwB,CAAC,IAAD,EACYK,EAAIV,EAAiBC,EAAiB3C,GADlD,mBACvBgD,EADuB,KACPC,EADO,WAEKG,EAAIR,EAAcC,EAAc7C,GAFrC,mBAEvBkD,EAFuB,KAEVC,EAFU,SAMvB,IAAyB,IAArBJ,EAML,MAAM,IAAI5J,MAAM,+DANc,IAAD,EACMkG,EAA8BqD,EAAiBC,EAAiB5C,GADtE,mBAC5BiD,EAD4B,KACZC,EADY,WAEC5D,EAA8BuD,EAAcC,EAAc9C,GAF3D,mBAE5BmD,EAF4B,KAEfC,EAFe,KAQjC,MAAO,CAACH,EAAgBC,EAAgBC,EAAaC,IAGnDZ,EAAY,SAACS,EAAgBC,EAAgBC,EAAaC,GAI5D,IAHA,IAAM/E,EAAQ,GACRiF,EAAgBnM,EAAO8G,QACzBsF,EAAkB,KACb7L,EAAI,EAAGA,EAAIoI,EAAexH,OAAQZ,IACnC4L,EAAgBxD,EAAepI,KAC/B6L,EAAkB7L,EAAE,GAG5B,IAAI8L,EAAgBtD,EAIpB,GAHqD,aAAjD1D,EAAQ,mBAAuB3C,gBAC/B2J,GAAgC7I,KAAK8I,KAAKhD,EAAqB,IAE3C,IAApB8C,EAEApF,EAAkB8E,EAAgBO,EAAenF,GACjDF,EAAkB+E,EAAgBM,EAAenF,GAGjDF,EAAkBgF,EAAaK,EAAenF,GAC9CF,EAAkBiF,EAAaI,EAAenF,QAI7C,GAAwB,IAApBkF,EAWL,MAAM,IAAInK,MAAM,gEAGlBqI,EAAU,SAAA1I,GAIZ,IAHA,IAAiC2K,EAAgBC,EAA7CC,EAAe7K,EAAMT,OAGlB,IAAMsL,GAGXD,EAAchJ,KAAKkJ,MAAMlJ,KAAKxD,SAAWyM,GAIzCF,EAAiB3K,EAHjB6K,GAAgB,GAIhB7K,EAAM6K,GAAgB7K,EAAM4K,GAC5B5K,EAAM4K,GAAeD,EAGvB,OAAO3K,GAIX,OACI,8BACI,cAAC,IAAD,CAAQ+K,MAhRF,SAAC7J,EAAI8J,GAGf9J,EAAG+J,aAAajJ,EAAW,GAAIA,EAAW,IAAIkJ,OAAOF,GACrD9C,EAAkB,IAAIjH,EAAOC,EAAIc,EAAW,GAAG,GAAIA,EAAW,GAAG,EAAE,GAAI,EAAGA,GAC1E,IAAK,IAAIrD,EAAE,EAAGA,EAAI8E,EAAQ,YAAiB9E,IAAK,CAC5C,IAAM4F,EAAa,IAAItD,EAAOC,EAAI,EAAGc,EAAW,GAAG,EAAE,GAAI,EAAGA,EAAY,KAChDyB,EAAQ,4BACRA,EACAA,EAAQ,oBAChCE,EAAY/E,KAAK2F,KAsQK5B,KAlQjB,SAACzB,GAOV,GANAA,EAAGiK,WAAW,GACdjK,EAAGkK,SAAS,IACZlK,EAAGmK,KAAK,eAAe3D,EAAoB1F,EAAW,GAAG,IAAK,IAC9Dd,EAAGmK,KAAK,QAAQrD,EAAShG,EAAW,GAAG,IAAK,IAC5Cd,EAAGmK,KAAK,SAASpD,EAAUjG,EAAW,GAAG,IAAK,IAE1CmG,EAAS,CACTV,EAAQ,GAGR,IAFA,IAAM6D,EAAQlN,EAAOmN,IAAI,EAAGvJ,EAAW,IACjCwJ,EAA0B,IAAjBpN,EAAOmN,MAAc,IAAM,GACjC5M,EAAE,EAAGA,EAAIyI,EAAe,EAAGzI,IAChC8I,EAAM7I,KAAK,IAAIsE,EAAKlB,EAAW,GAAK,EAAGsJ,EAAO,GAAIE,IAEtDrD,GAAU,EAIdD,EAAgB7F,OAAO,KAAMoF,EAAMA,EAAMlI,OAAO,IAChDkI,EAAMA,EAAMlI,OAAO,GAAG8C,OAAO6F,EAAiBlG,GAC9CyF,EAAMA,EAAMlI,OAAO,GAAGkD,OACtByF,EAAgB9F,UAAW,EAC3B8F,EAAgBvF,KAAKzB,GAErB,IAAIuK,EAAc,EAElB,IAAS9M,EAAE,EAAGA,EAAImG,EAAWnB,YAAYpE,OAAQZ,IAAK,CAClD,IAAI0E,EAASyB,EAAWnB,YAAYhF,GAEpC,GAAI0E,EAAOjB,SAAU,CACjBqJ,IAKA,IAAMrL,EAAS,CAAC,CAACiD,EAAOjC,SAAU,CAACqG,EAAM9I,GAAG0C,QAAS,CAACgC,EAAOhC,QAAS,CAACoG,EAAM9I,GAAG6D,OAAQ,CAACiF,EAAM9I,GAAGyE,SAGlGC,EAAOhB,OAAOjC,GACdqH,EAAM9I,GAAG0D,OAAOgB,EAAQrB,GACxBgG,EAAUpG,KAAKM,IAAI8F,EAAS3E,EAAO1B,KACnCsG,EAAWrG,KAAKM,IAAI8F,EAASC,GAC7BR,EAAM9I,GAAG8D,OACTY,EAAOZ,OAIPY,EAAOjB,UAAYiB,IAAWT,GAAUS,IAAWR,IAGnD4E,EAAM9I,GAAGgE,KAAKzB,GACdmC,EAAOV,KAAKzB,IAIA,IAAhBuK,GACArD,EAAgBlH,GAGL,OAAX0B,GAAmBA,EAAOR,WAC1BqF,EAAME,GAAchF,KAAKzB,GACzB0B,EAAOD,KAAKzB,GAAI,GAAM,IAET,OAAb2B,GAAqBA,EAAST,WAC9BqF,EAAMG,GAAgBjF,KAAKzB,GAC3B2B,EAASF,KAAKzB,GAAI,GAAO,U,iBC/GxBwK,EAAb,WACE,WAAYpN,EAAGqN,EAAGC,EAAGC,GAAG,oBACpB1L,KAAK7B,EAAIA,EACT6B,KAAKwL,EAAIA,EACTxL,KAAKyL,EAAIA,EACTzL,KAAK0L,EAAIA,EALf,iDAQOC,EAASC,GACVA,EAAOpJ,KAAKmJ,EAAS3L,KAAK7B,EAAG6B,KAAKwL,EAAGxL,KAAKyL,EAAGzL,KAAK0L,KATxD,+BAYWG,GAGL,IAAI1N,EAAI0N,EAAM,GACVL,EAAIK,EAAM,GACd,OACE1N,GAAK6B,KAAK7B,GACVA,EAAI6B,KAAK7B,EAAI6B,KAAKyL,GAClBD,GAAKxL,KAAKwL,GACVA,EAAIxL,KAAKwL,EAAIxL,KAAK0L,IArB1B,kCA6Bc9I,GAAoB,IAAdkJ,IAAa,yDAC3B,OAAMA,KAUE9L,KAAK+L,SAAS,CAACnJ,EAAKzE,EAAGyE,EAAK4I,MAC7B5I,EAAKmJ,SAAS,CAAC/L,KAAK7B,EAAG6B,KAAKwL,KAR3BxL,KAAK7B,GAAKyE,EAAKzE,GAAK6B,KAAKwL,GAAK5I,EAAK4I,MAjCjD,KAwFeQ,EAtCK,SAASC,GAGTxK,KAAKyK,GAGrBlM,KAAKmM,MAAQ,UACAC,GAATH,GAA+B,IAATA,GAAwB,MAATA,GACrCjM,KAAKmM,MAAQ,IAAIE,MACjBrM,KAAKmM,MAAMG,IAAML,GAGnBrL,QAAQyG,IAAI,oBAMdrH,KAAKwC,KAAO,SAAS+J,EAAKpO,EAAGqN,EAAGC,EAAGC,QAExBU,GAALX,QAAuBW,GAALV,EACpBa,EAAIC,UAAUxM,KAAKmM,MAAOhO,EAAGqN,GAE7Be,EAAIC,UAAUxM,KAAKmM,MAAOhO,EAAGqN,EAAGC,EAAGC,IAKvC1L,KAAKyM,OAAS,SAASF,EAAKpO,EAAGqN,EAAGkB,GAChCH,EAAII,OACJJ,EAAIpH,MAAMoH,EAAIK,IAAKL,EAAIK,KACvBL,EAAIM,UAAU1O,EAAGqN,GACjBe,EAAIE,OAAOC,EAAQ1M,KAAK8M,WACxBP,EAAIC,UAAUxM,KAAKmM,OAAQnM,KAAKmM,MAAMY,MAAM,GAAI/M,KAAKmM,MAAMa,OAAO,GAClET,EAAIU,YCpGH,SAASC,IAAT,IAAoBxL,EAApB,uDAAwB,EAAGK,EAA3B,uCAAgCoL,EAAhC,uDAAqC,EAArC,qBAGCzL,EAAMD,KAAK2L,KAAK1L,GAChBK,EAAMN,KAAKkJ,MAAM5I,GAErB,OADWL,EAAMyL,EAAK1L,KAAKkJ,MAAMlJ,KAAKxD,UAAU8D,EAAIL,GAAKyL,GALtD,MASA,SAASE,EAAW5I,EAAGnF,GAAyB,IAAtBgO,EAAqB,uDAAb,SAACnP,EAAEqN,GAAH,OAAOrN,GAAGqN,GAM/C,GAAI/G,IAAMnF,EAAG,OAAO,EACpB,GAAS,MAALmF,GAAkB,MAALnF,EAAW,OAAO,EACnC,GAAImF,EAAErF,QAAUE,EAAEF,OAAQ,OAAO,EAEjC,IAAK,IAAIZ,EAAI,EAAGA,EAAIiG,EAAErF,OAAQZ,IAC1B,IAAM8O,EAAQ7I,EAAEjG,GAAIc,EAAEd,IAAM,OAAO,EAEvC,OAAO,EAGJ,SAAS+O,EAAchP,EAAKiP,EAAKF,GAEpC,GAAW,MAAP/O,EAAa,OAAO,EACxB,IAAIkP,GAAM,EAIV,OAHAlP,EAAImP,SAAQ,SAACC,EAAMnP,GACX8O,EAAQK,EAAMH,KAAMC,GAAM,MAE3BA,EAyCJ,SAASG,GAAUnF,EAAIC,GAAK,IAAD,cACbD,EADa,GACvBoF,EADuB,KACnBC,EADmB,mBAEbpF,EAFa,GAEvBqF,EAFuB,KAEnBC,EAFmB,KAG9B,OAAOvM,KAAK8I,KAAK,SAACsD,EAAGE,EAAK,GAAT,SAAcD,EAAGE,EAAK,IAQpC,SAASC,GAAcpO,EAAOqO,GACjC,GAAIrO,EAAMT,OAAS8O,EAAY,OAAOrO,EAItC,IAFA,IAAIsO,EAAatO,EAAM2E,KAAI,SAACmJ,EAAMnP,GAAP,OAAamP,KACpCS,EAAS,GACJ5P,EAAI,EAAGA,EAAI0P,EAAY1P,IAAK,CACjC,IAAI6P,EAAWnB,EAAW,EAAGiB,EAAW/O,QACxCgP,EAAO3P,KACH0P,EAAWG,OAAOD,EAAU,GAAG,IAGvC,OAAOD,EA5DXG,OAAOC,UAAUrH,OAAS,WAEtB,IAAI3I,EAAI,EAAGiQ,EAAOC,UAClB,OAAO1O,KAAK2O,QAAQ,OAAO,WACvB,MAAyB,oBAAXF,EAAKjQ,GAAoBiQ,EAAKjQ,KAAO,OC/BpD,IAAMoQ,GAAb,WAYI,WAAYzQ,EAAGqN,EAAGpM,EAAQyP,EAAWC,EAASC,EAASC,GAAU,yBAFjEH,UAAY,IAEoD,KADhEzP,OAAS,EAELY,KAAK7B,EAAIA,EACT6B,KAAKwL,EAAIA,EACTxL,KAAKZ,OAASA,EACdY,KAAK6O,UAAYA,EAEjB7O,KAAK8O,QAAUA,EACf9O,KAAK+O,QAAUA,EACf/O,KAAKgP,QAAUA,EAEfhP,KAAKiP,KAAO,GACZjP,KAAKkP,aACLlP,KAAKmP,KAAOnP,KAAKiP,KAAK,GAxB9B,yDA4BQ,IAAIG,EAAK,EAAOC,EAAK,EACC,KAAlBrP,KAAK6O,YAAkBO,GAAM,GACX,KAAlBpP,KAAK6O,YAAkBO,EAAK,GACV,KAAlBpP,KAAK6O,YAAkBQ,EAAK,GACV,KAAlBrP,KAAK6O,YAAkBQ,GAAM,GAEjC,IAAK,IAAI7Q,EAAI,EAAGA,EAAIwB,KAAKZ,OAAQZ,IAAI,CACjC,IAAI8Q,EAAW,IAAI/D,EACfvL,KAAK7B,EAAIiR,EAAG5Q,EAAIwB,KAAK8O,QACrB9O,KAAKwL,EAAI6D,EAAG7Q,EAAIwB,KAAK8O,QACrB9O,KAAK8O,QAAS9O,KAAK8O,SAEvB9O,KAAKiP,KAAKxQ,KAAK6Q,MAxC3B,sCA6CoBT,GAEZ,IAAMU,EAAY,CAAC,IAAK,IAAK,IAAK,KAE5BvK,EAAUuK,EAAUrH,QAAQlI,KAAK6O,WAGnCA,IAFc7J,EAAU,GAAK,GAEJ6J,GAAa7J,IACtChF,KAAK6O,UAAYU,EAAUV,MArDvC,gCA0D+B,IAAnBW,IAAkB,yDAClBJ,EAAK,EAAOC,EAAK,EACC,KAAlBrP,KAAK6O,YAAkBO,EAAK,GACV,KAAlBpP,KAAK6O,YAAkBO,GAAM,GACX,KAAlBpP,KAAK6O,YAAkBQ,GAAM,GACX,KAAlBrP,KAAK6O,YAAkBQ,EAAK,GAE1BG,GAIFxP,KAAK7B,EAAK6B,KAAK7B,EAAIiR,EAAGpP,KAAK8O,QAC3B9O,KAAKwL,EAAKxL,KAAKwL,EAAI6D,EAAGrP,KAAK8O,UAJ3B9O,KAAK7B,GAAK6B,KAAK7B,EAAIiR,EAAGpP,KAAK8O,SAAW9O,KAAK+O,QAC3C/O,KAAKwL,GAAKxL,KAAKwL,EAAI6D,EAAGrP,KAAK8O,SAAW9O,KAAKgP,SAM/C,IAAIS,EAAU,IAAIlE,EACdvL,KAAK7B,EAAG6B,KAAKwL,EACbxL,KAAK8O,QAAS9O,KAAK8O,SAEvB9O,KAAKiP,KAAKS,QAAQD,GAClBzP,KAAKmP,KAAOnP,KAAKiP,KAAK,KA9E9B,mCAkFQ,OAAOjP,KAAKiP,KAAKU,QAlFzB,8BAqFYC,GACJ5P,KAAKiP,KAAKxQ,KAAKmR,KAtFvB,wCA0FQ,IAAK,IAAIpR,EAAI,EAAGA,EAAIwB,KAAKiP,KAAK7P,OAAQZ,IAAK,CACvC,IAAIqR,EAAO7P,KAAKiP,KAAKzQ,GACrB,GAAIwB,KAAKmP,KAAKW,YAAYD,GACtB,OAAO,EAGf,OAAO,IAhGf,wCAmGsC,IAAD,OAAjBE,EAAiB,uDAAN,KAEnBC,EAAW,IAAIzE,EAAK,EAAG,EAAGvL,KAAK+O,QAAS/O,KAAKgP,SACjD,IAAOgB,EAASjE,SAAS,CAAC/L,KAAK7B,EAAG6B,KAAKwL,IACnC,OAAO,EAGX,GAAkB,MAAduE,EAAoB,OAAO,EAE/B,IAAIE,GAAO,EAMX,OALAF,EAAWrC,SAAQ,SAAAmC,GACX,EAAKV,KAAKW,YAAYD,KACtBI,GAAO,MAGRA,IAlHf,uCAqHqBC,EAAWC,GACxB,OAAO,OAtHf,2BAyHSpP,GACDA,EAAG4B,KAAK,WACR,IAAK,IAAInE,EAAE,EAAGA,EAAIwB,KAAKiP,KAAK7P,OAAQZ,IAAK,CACrC,IAAIoE,EAAO5C,KAAKiP,KAAKzQ,GACrBuC,EAAG6B,KAAKA,EAAKzE,EAAGyE,EAAK4I,EAAGxL,KAAK8O,QAAS9O,KAAK8O,cA7HvD,KAmIasB,GAAb,WAQI,WAAYC,EAAWlS,EAAGqN,EAAGuD,EAASC,GAAU,oBAC5ChP,KAAKqQ,UAAYA,EACjBrQ,KAAK7B,EAAIA,EACT6B,KAAKwL,EAAIA,EACTxL,KAAK+O,QAAUA,EACf/O,KAAKgP,QAAUA,EACfhP,KAAK4C,KAAO,IAAI2I,EAAKvL,KAAK7B,EAAG6B,KAAKwL,EAAGxL,KAAKqQ,UAAWrQ,KAAKqQ,WAdlE,mDAoBM,IAFgB,IAAbC,EAAY,uDAAN,KACHC,EAAe,SAAC9L,EAAGnF,GAAJ,OAAUkR,EAAgB/L,EAAGnF,MACrC,CACT,IAAImR,EAASD,EAAgB,EAAGxQ,KAAK+O,QAAS/O,KAAKqQ,WAC/CK,EAASF,EAAgB,EAAGxQ,KAAKgP,QAAShP,KAAKqQ,WAC/CM,EAAUH,EAAmBF,EAAO,CAACG,EAAOC,GAASH,GACzD,GAAa,MAATD,IAAmBK,EACnB,MAIR3Q,KAAK4C,KAAO,IAAI2I,EAAKkF,EAAQC,EAAQ1Q,KAAKqQ,UAAWrQ,KAAKqQ,WAC1DrQ,KAAK7B,EAAIsS,EACTzQ,KAAKwL,EAAIkF,IA/Bf,2BAkCS3P,GACDA,EAAG4B,KAAK,WACR5B,EAAG6B,KAAK5C,KAAK7B,EAAG6B,KAAKwL,EAAGxL,KAAKqQ,UAAWrQ,KAAKqQ,eApCrD,KC/HaO,GAAb,WACI,WAAYnR,GAiBR,IAAK,IAAIoR,KAjBQ,oBAEjB7Q,KAAK8Q,IAAM,GACX9Q,KAAK+Q,YAAc,EAEnB/Q,KAAKwP,aAAc,EACnBxP,KAAKgR,aAAc,EACnBhR,KAAK+P,WAAa,KAElB/P,KAAKiR,QAAS,EAEdjR,KAAKkR,UAAY,SACjBlR,KAAKmR,WAAa,qBAClBnR,KAAKoR,aAAe,CAChBC,IAAK,GAAIC,KAAM,IAAKC,OAAQ,EAAGC,MAAO,GAG1B/R,EAED,eAAPoR,IAAsB7Q,KAAKwP,YAAc/P,EAAOoR,IACzC,eAAPA,IAAsB7Q,KAAKgR,YAAcvR,EAAOoR,IACzC,cAAPA,IAAqB7Q,KAAK+P,WAAatQ,EAAOoR,IAEvC,OAAPA,IAAc7Q,KAAK8Q,IAAMrR,EAAOoR,IAGzB,aAAPA,IAAoB7Q,KAAKkR,UAAYzR,EAAOoR,IACrC,cAAPA,IAAqB7Q,KAAKmR,WAAa1R,EAAOoR,IACvC,gBAAPA,IAAuB7Q,KAAKoR,aAAe3R,EAAOoR,IAG3C,eAAPA,IAAsB7Q,KAAK+Q,YAActR,EAAOoR,IACzC,UAAPA,IAAiB7Q,KAAKiR,OAASxR,EAAOoR,IAI9C7Q,KAAK4M,IAAM,EACX5M,KAAKyR,SAAWhS,EAAM,SAAeO,KAAK4M,IAC1C5M,KAAK+M,MAAQtN,EAAM,MAAYO,KAAKyR,SACpCzR,KAAKgN,OAASvN,EAAM,OAAaO,KAAKyR,SAEtCzR,KAAK+P,WFMN,SAA4B2B,EAASC,EAAMC,GAC9C,GAAe,MAAXF,EAAiB,OAAO,KAC5B,IAAIG,EAAQ,GAQZ,OAPAH,EAAQhE,SAAQ,WAAQlP,GAAO,IAAD,mBAAZL,EAAY,KAAVqN,EAAU,KACtBoG,IACAzT,GAAKwT,EACLnG,GAAKmG,GAETE,EAAMpT,KAAK,IAAI8M,EAAKpN,EAAGqN,EAAGmG,EAAMA,OAE7BE,EEhBeC,CAAmB9R,KAAK+P,WAAY/P,KAAKyR,UAAU,GAGrEzR,KAAK+R,MAAQ,KAEb/R,KAAKgS,MAAQ,KACbhS,KAAKiS,MAAQ,KAEbjS,KAAKkS,KAAO,EACZlS,KAAKmS,MAAQ,EACbnS,KAAKoS,WAAa,EAClBpS,KAAKqS,YAAc,EAEnBrS,KAAKgC,QAGDhC,KAAKiR,QAELjR,KAAKsS,kBAKTtS,KAAKuS,WAAa,KAClBvS,KAAKwS,WAAa,KAClBxS,KAAKyS,eAAiB,CAClBpB,IAAK,EAAGE,OAAQ,EAAGC,KAAM,GApErC,uDAyEekB,GAET,MADsB,CAAC,IAAI,IAAI,IAAI,KACdA,KA3E3B,8BA8EY7D,GAEN,MADsB,CAAC,IAAI,IAAI,IAAI,KACd3G,QAAQ2G,KAhFnC,qCAqFQ,GAAsB,UAAlB7O,KAAKkR,UACL,OAAOlR,KAAK2S,wBAtFxB,4CA8FQ,IAAIC,EAAYC,MAAM,IAAIlQ,KAAK,GAGH,KAAxB3C,KAAKgS,MAAMnD,UACX+D,EAAU,GAAK,EACgB,KAAxB5S,KAAKgS,MAAMnD,UAClB+D,EAAU,GAAK,EACgB,KAAxB5S,KAAKgS,MAAMnD,UAClB+D,EAAU,GAAK,EACgB,KAAxB5S,KAAKgS,MAAMnD,YAClB+D,EAAU,GAAK,GAKf5S,KAAKiS,MAAMzG,EAAIxL,KAAKgS,MAAMxG,IAE1BoH,EAAU,GAAK,GAEf5S,KAAKiS,MAAM9T,EAAI6B,KAAKgS,MAAM7T,IAE1ByU,EAAU,GAAK,GAEf5S,KAAKiS,MAAMzG,EAAIxL,KAAKgS,MAAMxG,IAE1BoH,EAAU,GAAK,GAEf5S,KAAKiS,MAAM9T,EAAI6B,KAAKgS,MAAM7T,IAE1ByU,EAAU,GAAK,GAKnB,IAAME,EAAY,CACd,EAAK,CAACC,KAAM,IAAK5U,EAAG,EAAGqN,GAAIxL,KAAKyR,SAAUuB,MAAO,GACjD,EAAK,CAACD,KAAM,IAAK5U,EAAG6B,KAAKyR,SAAUjG,EAAG,EAAGwH,MAAO,GAChD,EAAK,CAACD,KAAM,IAAK5U,EAAG,EAAGqN,EAAGxL,KAAKyR,SAAUuB,MAAO,IAChD,EAAK,CAACD,KAAM,IAAK5U,GAAI6B,KAAKyR,SAAUjG,EAAG,EAAGwH,MAAO,KAErD,IAAK,IAAInC,KAAOiC,EAAW,CACvB,IAAIG,EAAOH,EAAUjC,GACjB7Q,KAAKgS,MAAMnD,WAAaoE,EAAI,MACf,IAAIrE,GACb5O,KAAKgS,MAAM7T,EAAI8U,EAAI,EAAOjT,KAAKgS,MAAMxG,EAAIyH,EAAI,EAC7C,EAAG,IAAKjT,KAAKyR,SAAUzR,KAAK+M,MAAO/M,KAAKgN,QAE7BkG,gBAAgBlT,KAAK+P,cAChC6C,EAAUK,EAAI,OAAa,GAIvC,OAAOE,IAAYP,EAAW,CAAC,EAAE,OAlJzC,+BAuJQ,GAAuB,sBAAnB5S,KAAKmR,WACL,OAAOnR,KAAKoT,iBAxJxB,qCA6JQ,IAAMzM,EAAQ3G,KAAKoR,aACbiC,EAAQrT,KAAKyS,eAEnB,OAAIzS,KAAKkS,KAAavL,EAAK,IACvB0M,EAAK,IAAgB1M,EAAK,IAC1B0M,EAAK,OAAmB1M,EAAK,OAC7B0M,EAAK,KAAiB1M,EAAK,KACxB,IApKf,qCAyKQ,IAAK,IAAIkK,KAAO7Q,KAAKyS,eACjBzS,KAAKyS,eAAe5B,GAAO,IA1KvC,8BAqLQ,IAAIJ,EAAQC,EAAQJ,EAAOK,EAJ3B3Q,KAAKkS,KAAO,EACZlS,KAAKmS,MAAQ,EAIb,IAAM5B,EAAe,SAAC9L,EAAGnF,GAAJ,OAAU+N,EAAW5I,EAAGnF,IAM7C,IAJIgR,EADmB,MAAnBtQ,KAAK+P,WACG,KAEA/P,KAAK+P,WAAWvL,KAAI,SAAA5B,GAAI,MAAI,CAACA,EAAKzE,EAAGyE,EAAK4I,MAKlDmF,EAAUpD,EAAc+C,EAAO,CAF/BG,EAASvD,EAAW,EAAElN,KAAKyR,SAAUzR,KAAK+M,MAAM,EAAE/M,KAAKyR,SAAUzR,KAAKyR,UACtEf,EAASxD,EAAW,EAAElN,KAAKyR,SAAUzR,KAAK+M,MAAM,EAAE/M,KAAKyR,SAAUzR,KAAKyR,WACtBlB,GAChD3P,QAAQyG,IAAIsJ,GACC,MAATL,GAAmBK,IAuB3B,OAlBA3Q,KAAKgS,MAAQ,IAAIpD,GACb6B,EAAQC,EACR1Q,KAAK+Q,YAAa/Q,KAAKsT,WAAWpG,EAAW,EAAE,IAAKlN,KAAKyR,SACzDzR,KAAK+M,MAAO/M,KAAKgN,QAGrBhN,KAAKiS,MAAQ,IAAI7B,GAAMpQ,KAAKyR,SAAU,EAAG,EAAGzR,KAAK+M,MAAO/M,KAAKgN,QAC7DhN,KAAKuT,aAKDvT,KAAKiR,SACLuC,cAAcxT,KAAK+R,OACnB/R,KAAKyT,eAIFzT,KAAK0T,iBAxNpB,mCA4NQ,IAAIpD,EAAQtQ,KAAKgS,MAAM/C,KAAKzK,KAAI,SAAAqL,GAAI,MAAI,CAACA,EAAK1R,EAAG0R,EAAKrE,MACtD,GAAuB,MAAnBxL,KAAK+P,WAAmB,CACxB,IAAI4D,EAAa3T,KAAK+P,WAAWvL,KAAI,SAAAqL,GAAI,MAAI,CAACA,EAAK1R,EAAG0R,EAAKrE,MAC3D8E,EAAQA,EAAMsD,OAAOD,GAEzB3T,KAAKiS,MAAM3P,KAAKgO,KAjOxB,qCAsOQ,OADAtQ,KAAKmS,MAAQnS,KAAKgS,MAAM/C,KAAK7P,SAAWY,KAAK+Q,YACtC/Q,KAAKmS,QAtOpB,+BAyOc,IAAD,OACDxG,EAAU3L,KAAK6T,OAAOlI,QAC1BA,EAAQmI,UAAU,EAAE,EAAE9T,KAAK+M,MAAM/M,KAAKgN,QAEtChN,KAAKgS,MAAM/C,KAAKvB,SAAQ,SAACmC,EAAMrR,GAC3BqR,EAAKrN,KAAKmJ,EAAS,EAAKoI,gBAGL,MAAnB/T,KAAK+P,YACL/P,KAAK+P,WAAWrC,SAAQ,SAACmC,EAAMrR,GAC3BqR,EAAKrN,KAAKmJ,EAAS,EAAKqI,eAIhChU,KAAKiS,MAAMrP,KAAKJ,KAAKmJ,EAAS3L,KAAKiU,eAvP3C,oCA4PQ,IAAIC,EAAOlU,KACXA,KAAK+R,MAAQoC,aAAY,WACrBD,EAAK/G,OACL+G,EAAK7B,YAAc,IACpB,IAAKrS,KAAK8Q,OAhQrB,iCAoQQ9Q,KAAKkS,KAAO,EACRlS,KAAKiR,SACLuC,cAAcxT,KAAK+R,OACnBnR,QAAQyG,IAAI,gBAvQxB,6BA6QuB,IAeX+M,EAfH1B,EAAa,uDAAN,KACR,IAAI1S,KAAKkS,KA4CT,OAzCMlS,KAAKiR,QAAqB,MAAVyB,IAElB1S,KAAKgS,MAAMqC,gBAAgB3B,GAC3B1S,KAAKuS,WAAavS,KAAKgS,MAAM7C,KAC7BnP,KAAKwS,WAAaxS,KAAKiS,MAAMrP,MAIjC5C,KAAKgS,MAAMsC,QAAQtU,KAAKwP,aAIpBxP,KAAKgS,MAAMkB,gBAAgBlT,KAAK+P,YAChC/P,KAAKuU,WAELH,EAAWpU,KAAKgS,MAAMwC,aAGtBxU,KAAKgS,MAAMyC,mBACXzU,KAAKuU,WAGLvU,KAAKgS,MAAM7C,KAAKW,YAAY9P,KAAKiS,MAAMrP,QAEvC5C,KAAKgS,MAAM0C,QAAQN,GAEnBpU,KAAKuT,aAELvT,KAAKmS,OAAS,EACVnS,KAAKmS,MAAQnS,KAAKoS,aAClBpS,KAAKoS,WAAapS,KAAKmS,QAW3BnS,KAAKiR,OACE,KAEAjR,KAAK2U,kBA7TxB,sCAmUQ3U,KAAKyS,eAAL,KAA+BpF,EAC3B,CAACrN,KAAKwS,WAAWrU,EAAG6B,KAAKwS,WAAWhH,GACpC,CAACxL,KAAKiS,MAAMrP,KAAKzE,EAAG6B,KAAKiS,MAAMrP,KAAK4I,IAGxC,IAAMoJ,EAAgBhH,GAClB,CAAC5N,KAAKuS,WAAWpU,EAAG6B,KAAKuS,WAAW/G,GACpC,CAACxL,KAAKwS,WAAWrU,EAAG6B,KAAKwS,WAAWhH,IAElCqJ,EAAWjH,GACb,CAAC5N,KAAKgS,MAAM7C,KAAKhR,EAAG6B,KAAKgS,MAAM7C,KAAK3D,GACpC,CAACxL,KAAKiS,MAAMrP,KAAKzE,EAAG6B,KAAKiS,MAAMrP,KAAK4I,IAExCxL,KAAKyS,eAAL,OAAgCoC,EAAWD,EAC3C5U,KAAKyS,eAAL,KAA8BoC,EAAWD,EAIzC,IAAME,EAAa9U,KAAK0T,eAClBqB,EAAS/U,KAAK+U,SAIpB,OAFA/U,KAAKgV,eAEE,CAACF,EAAYC,EAAQ/U,KAAKkS,KAAMlS,KAAKmS,SA1VpD,wCA6VuB,IAAD,OAEd8C,SAAShG,KAAKiG,iBAAiB,WAAW,SAACC,GACvC,GAAI,EAAKjD,KAEL,OADAtR,QAAQyG,IAAI,cACL,KAEX,GAAI,EAAKgL,YAEL,OADAzR,QAAQyG,IAAI,6BACL,KAEP,EAAKgL,YAAc,EAEvB,IACMxB,EADe,CAAC,UAAW,aAAc,YAAa,aACnC3I,QAAQiN,EAAMtE,KAEvC,EAAKmB,MAAMqC,gBAAgBxD,UA7WvC,K,sCCXMuE,G,kDACF,WAAYC,GAAS,IAAD,8BAChB,gBACKA,OAASA,EAFE,E,sDAKV1H,GACF3N,KAAKZ,QAAUY,KAAKqV,QAAQrV,KAAKsV,QACrCtV,KAAKvB,KAAKkP,O,gBAREkF,QAYP0C,GAAb,WACI,WAAY9V,GAYR,IAAK,IAAIoR,KAZQ,oBAEjB7Q,KAAKwV,WAAa/V,EAAM,WACxBO,KAAKyV,YAAchW,EAAM,YAEzBO,KAAK+F,MAAQ,IACb/F,KAAK0V,QAAU,EACf1V,KAAK2V,cAAgB,KACrB3V,KAAK4V,YAAc,IACnB5V,KAAK6V,cAAgB,MAGLpW,EACD,SAAPoR,IAAgB7Q,KAAK+F,MAAQtG,EAAOoR,IAC7B,WAAPA,IAAkB7Q,KAAK0V,QAAUjW,EAAOoR,IACjC,iBAAPA,IAAwB7Q,KAAK2V,cAAgBlW,EAAOoR,IAC7C,eAAPA,IAAsB7Q,KAAK4V,YAAcnW,EAAOoR,IACzC,iBAAPA,IAAwB7Q,KAAK6V,cAAgBpW,EAAOoR,IAI5D7Q,KAAK8V,MAAQ9V,KAAK+V,cAGlB/V,KAAKgW,OAAS,IAAIZ,GADH,KAxBvB,0DAqCQ,IAAMU,EAAQ3C,MAiBd,OAhBA2C,EAAMlW,IAAIuT,IAAU8C,MAAM,CACtBC,MAAO,IAAKC,WAAY,CAACnW,KAAKwV,YAAaY,WAAY,UAE3DN,EAAMlW,IAAIuT,IAAU8C,MAAM,CACtBC,MAAO,IAAKE,WAAY,UAE5BN,EAAMlW,IAAIuT,IAAU8C,MAAM,CACtBC,MAAO,IAAKE,WAAY,UAE5BN,EAAMlW,IAAIuT,IAAU8C,MAAM,CACtBC,MAAOlW,KAAKyV,YAAa/C,OAAQ,YAErCoD,EAAMO,QAAQ,CACVC,UAAWnD,IAASoD,KAAK,CAACC,aAAcxW,KAAK6V,gBAC7CY,KAAM,qBAEHX,IAtDf,+BAyDa9C,EAAON,EAAQqC,EAAQD,EAAY5C,GACxClS,KAAKgW,OAAOU,UAAU,CAAC1D,EAAON,EAAQqC,EAAQD,EAAY5C,MA1DlE,qEA6Dcc,GA7Dd,6EA+DYvR,KAAKxD,UAAY+B,KAAK0V,SA/DlC,gBAgEgBhD,EAASlC,EAAgB,EAAGxQ,KAAKyV,aAhEjD,sCAkE+BzV,KAAK2W,QAAQ3D,GAlE5C,OAkEgBN,EAlEhB,uCAoEe,IAAIkE,SAAQ,SAACC,EAASC,GACzBD,EAAQnE,OArEpB,gLAyEkBM,GAzElB,0FA0E2BhT,KAAK8V,MAAMiB,QAAQ/D,GAAOgE,QAAQ,CAAChX,KAAKyV,cA1EnE,cA0EcwB,EA1Ed,gBA2E6BA,EAAKC,SAASC,OA3E3C,cA2EczE,EA3Ed,yBA6Ee,IAAIkE,SAAQ,SAACC,EAASC,GAEzBD,EAAQnE,EAAO,QA/E3B,8RAmFiBxE,EAnFjB,+BAmF4B,KAChBlO,KAAKgW,OAAO5W,OAAS8O,GApFjC,yCAqFmB0I,QAAQC,WArF3B,OAyFcO,EAAa5G,GAAmBxQ,KAAKgW,OAAQ9H,GAE1C1P,EAAI,EA3FrB,YA2FwBA,EAAI4Y,EAAWhY,QA3FvC,oBA6FgBZ,EAAI,KAAO,GAAGoC,QAAQyG,IAAI7I,GA7F1C,cA+F4D4Y,EAAW5Y,GA/FvE,GA+FiBwU,EA/FjB,KA+FwBN,EA/FxB,KA+FgCqC,EA/FhC,KA+FwCD,EA/FxC,KA+FoD5C,EA/FpD,KAiGgBmF,EAAStC,EACP7C,EAlGlB,kCAmG2ClS,KAAK8V,MAAMiB,QAAQjC,GAAYkC,QAAQ,CAAChX,KAAKyV,cAnGxF,QAmGsB6B,EAnGtB,OAoGgBD,EAAStC,EAAS/U,KAAK+F,MAAQuR,EAAavV,MAAMwV,WAAW,GApG7E,yBAsGqCvX,KAAK8V,MAAMiB,QAAQ/D,GAAOgE,QAAQ,CAAChX,KAAKyV,cAtG7E,eAsGgB+B,EAtGhB,iBAuGkBA,EAAaL,OAAOM,MAAK,SAAAN,GAAI,OAAIA,EAAKzE,GAAU2E,KAvGlE,yBAyGkBrX,KAAK8V,MAAM4B,IAAI1E,EAAOwE,EAAaR,QAAQ,CAAC,EAAEhX,KAAKyV,cAAe,CAAC,OAAU,IAzG/F,QA2F+CjX,IA3F/C,8BA4GYwB,KAAK0V,QAAU1V,KAAK4V,cACpB5V,KAAK0V,SAAW1V,KAAK2V,eA7GjC,kBA+Ge,IAAIiB,SAAQ,SAACC,EAASC,GACzBD,QAhHZ,mLAoHqB5K,GApHrB,kFAqHcjM,KAAK8V,MAAMnJ,KAAK,eAAiBV,GArH/C,mLAwHqBA,GAxHrB,kFAyH2BkH,IAAmB,kBAAoBlH,GAzHlE,OAyHQjM,KAAK8V,MAzHb,qHCZI6B,GAAmB,CAAC,CAAC,UAAW,QAAS,QAAS,sBAE/C,SAAeC,GAAtB,qC,gDAAO,WACHC,EAAKC,GADF,8DAAArT,EAAA,sDACShF,EADT,+BACkB,CACrByO,WAAY,GAAI6J,WAAY,GAAIC,UAAW,IAAKC,aAAc,EAC9DC,YAAY,GAGNhK,EAAazO,EAAM,WACnBsY,EAAatY,EAAM,WACnBuY,EAAYvY,EAAM,UAClBwY,EAAexY,EAAM,aACrByY,EAAazY,EAAM,WAGrByS,EAAO,EACFiG,EAAI,EAdV,YAcaA,GAAKJ,GAdlB,iBAgBK/E,EAAQ6E,EAAI7V,QACZoW,EAAa,EAER9V,EAAO,EAnBjB,aAmBoBA,GAAQ0V,GAnB5B,kCAqB0BF,EAAMO,IAAIrF,GArBpC,WAqBWN,EArBX,SAsB6CmF,EAAI1K,KAAKuF,GAtBtD,mBAsBUoC,EAtBV,KAsBsBC,EAtBtB,KAsB8B7C,EAtB9B,KAsBoCC,EAtBpC,KAuBK2F,EAAMQ,SAAStF,EAAON,EAAQqC,EAAQD,EAAY5C,GAElDc,EAAQ8B,EACRsD,GAAcrD,GAEVmD,EA5BT,kCA6BeJ,EAAMS,OAAOrK,GA7B5B,YA+BSgE,EA/BT,oBAgCegG,EAhCf,kCAgCkCJ,EAAMS,OAAOrK,GAhC/C,4CAmBuC5L,IAnBvC,wBAsCOkW,EAAa,kDACnB5X,QAAQyG,IAAImR,EAAWrR,OACnBgR,EAAGJ,EAAY5F,EAAO2F,EAAMpC,QAASpT,EAAM0V,IAG/CL,GAAiBlZ,KAAK,CAClB0Z,EAAIF,EAAc9F,EAAO7P,EAAM8V,IA5CpC,QAc8BD,IAd9B,8BAqDHvX,QAAQyG,IAAI,mBArDT,kBAsDI,IAAIuP,SAAQ,SAACC,EAASC,GACzBD,EAAQc,QAvDT,6C,6BCWP,IDwFeC,IC3FFa,GAAa,GAGjBC,GAAM,GAAIA,IAAO,GAAIA,KAC1B,IAAK,IAAIC,GAAM,EAAGA,IAAO,GAAIA,KACzBF,GAAWha,KAAK,CAACka,GAAKD,KAUH,IAAI1M,EAAO,oBACX,IAAIA,EAAO,kBACZ,IAAIA,EAAO,kBC2FtB4M,OA1Gf,SAAkBnS,GAId,IAAIoS,EAAepS,EAAMW,UAAU,GAC/B0R,EAAgBrS,EAAMW,UAAU,GAChC2R,EAAqBtX,KAAKC,IAC1BD,KAAKkJ,MAAMkO,EDpBS,ICoBmBpX,KAAKkJ,MAAMmO,EDnB7B,KCqBrBE,EAAcvX,KAAKC,IAAImX,EAAcC,GAErCG,EAAYxX,KAAKyX,MAAM,IAAKF,GAE5BG,EAAgB1X,KAAKyX,MAAM,IAAKL,GAChCO,EAAW3X,KAAKyX,MAAM,GAAIF,GAC1BK,EAAW5X,KAAKyX,MAAM,GAAIF,GAIxBM,EAAa,CACfvM,MDjCoB,GCiCCC,ODhCA,GCiCrByE,SAAUsH,EACVjI,ID/BkB,ECgClBC,YD7BoB,EC8BpBhB,WAAY0I,GACZvH,UDfkB,SCeKC,WDdJ,QCenBF,OAAQxK,EAAM8S,UAOdC,EAAO,IAAI5I,GAAU0I,GACrBxB,EAAQ,IAAIvC,GALM,CAClBC,WAAY,GAAIC,YAAa,IAiEjC,OAAIhP,EAAMgT,OACC,KAIP,qBAAKC,GAAG,YAAR,SACI,cAAC,IAAD,CAAQ9O,MA/DF,SAAC7J,EAAI8J,GASf,GANU9J,EAAG+J,aAAakO,EAAaA,GAAajO,OAAOF,GACvD8O,UACCd,EAAeG,GAAa,GAAIF,EAAgBE,GAAa,GAI9DvS,EAAMmT,QAAS,CAOfhC,GAAM4B,EAAM1B,EALS,CACjB5J,WAAY,IAAK6J,WAAY,IAC7BC,UAAW,IAAMC,aAAc,EAC/BC,YAAY,MAiDM1V,KA3CjB,SAACzB,GACVA,EAAGiK,WAAW,KAIdjK,EAAG8Y,OAAO,EAAG,EAAG,GAChBL,EAAKxH,MAAMxP,KAAKzB,GAChByY,EAAKvH,MAAMzP,KAAKzB,GAGhBA,EAAG8Y,OAAO,EAAG,EAAG,GAChB9Y,EAAG4B,KAAK,WACR,IAAK,IAAInE,EAAE,EAAGA,EAAIgb,EAAKzJ,WAAW3Q,OAAQZ,IAAK,CAC3C,IAAIoE,EAAO4W,EAAKzJ,WAAWvR,GAC3BuC,EAAG6B,KAAKA,EAAKzE,EAAGyE,EAAK4I,EAAGgO,EAAK/H,SAAU+H,EAAK/H,UAIhD1Q,EAAG8Y,OAAO,IAAI,EAAE,GAChB9Y,EAAG4B,KAAK,IAAK,EAAG,EAAG,KACnB5B,EAAGsC,QAAQ+V,EAAUC,EAAUF,EAAeA,GAE9CpY,EAAG+Y,aAAe,WACVtJ,GAAe,CAACzP,EAAGgZ,OAAQhZ,EAAGiZ,QAAS,CAACZ,EAAUC,KAAc,GAAIF,GACpEK,EAAKxX,SAKbjB,EAAG8Y,OAAO,EAAE,EAAE,EAAE,GAChB9Y,EAAG4B,KAAK,WACR5B,EAAGkK,SAASgO,GACZlY,EAAGmK,KAAK,UAAYsO,EAAKrH,MAAO,GAAI8G,EAAWA,GAC/ClY,EAAGmK,KAAK,eAAiBsO,EAAKpH,WAAY,GAAI6G,EAAW,EAAEA,SCxBpDgB,OArEf,SAAiBxT,GACb,IAAMyT,EAAgBC,iBAAO,MACvBC,EAAgBD,iBAAO,MAFT,EAGkCE,mBAAS,CAACtN,MAAO,EAAGC,OAAQ,IAH9D,mBAGbsN,EAHa,KAGQC,EAHR,OAIkCF,mBAAS,CAACtN,MAAO,EAAGC,OAAQ,IAJ9D,mBAIQwN,GAJR,WAqBpB,OAfAC,qBAAY,WACJP,EAAclV,SACduV,EAAuB,CACnBxN,MAAOmN,EAAclV,QAAQ0V,YAC7B1N,OAAQkN,EAAclV,QAAQ2V,eAGlCP,EAAcpV,SACdwV,EAAuB,CACnBzN,MAAOqN,EAAcpV,QAAQ0V,YAC7B1N,OAAQoN,EAAcpV,QAAQ2V,iBAGvC,CAACT,EAAeE,IAGf,eAAC,IAAD,CAAQQ,SAAUC,aAAlB,UACI,sBAAKC,UAAWC,IAAIC,UAApB,UACI,oBAAIF,UAAWC,IAAIva,KAAMya,QAAS,WAAKxU,EAAMyU,QAAQzc,KAAKoc,gBAA1D,SACI,cAAC,IAAD,CAAMM,GAAG,IAAIL,UAAWC,IAAI7P,KAA5B,yBAIJ,sBAAK4P,UAAWC,IAAI/P,WAApB,UACI,qBAAK8P,UAAWC,IAAIK,WAAYC,IAAKnB,EAArC,SACI,eAAC,IAAD,WACI,cAAC,IAAD,CAAOoB,KAAK,SAAZ,mBAGA,cAAC,IAAD,CAAOA,KAAK,QAAZ,SAEsC,IAA9BhB,EAAoBvN,MACpB,wBAAc,cAAC,EAAD,CAAM3F,UAAW,CAACkT,EAAoBvN,MAAOuN,EAAoBtN,YAGvF,cAAC,IAAD,CAAOsO,KAAK,cAAZ,6BAKR,qBAAKR,UAAWC,IAAIQ,WAAYF,IAAKjB,EAArC,SACI,eAAC,IAAD,WACI,cAAC,IAAD,CAAOkB,KAAK,SAAZ,mBAGA,cAAC,IAAD,CAAOA,KAAK,QAAZ,kBAGA,cAAC,IAAD,CAAOA,KAAK,cAAZ,mCAOhB,yBAAQR,UAAWC,IAAIS,OAAvB,4CAEI,mBAAGC,KAAK,2CAA2CpE,OAAO,SAASqE,MAAO,CAACC,eAAgB,OAAQC,MAAM,SAAzG,4B,4DC5ED,I,mCAAA,IAA0B,mCCA1B,okMCAA,OAA0B,uCCA1B,OAA0B,sCCA1B,OAA0B,sCCA1B,OAA0B,qCCA1B,OAA0B,2CC8I1BC,OAtHf,SAAcpV,GAAQ,IAAD,EACmB4T,mBAASyB,IAD5B,mBACV9Q,EADU,KACE+Q,EADF,OAEmB1B,mBAAS,GAF5B,mBAEV2B,EAFU,KAEEC,EAFF,KAMjB,SAASC,IAEL,OADAH,EAAcD,IAEV,eAAC,KAAD,CAAQhB,UAAWC,IAAIoB,gBACfC,OAAO,YACPC,aAAc,GACdC,cAAe,EACfC,gBAAgB,EAChBC,YAAY,EACZC,WAAY,CAAEC,WAAW,GACzBC,gBAAgB,EAChBC,MAAM,EACNC,aAAcb,EATtB,UAWI,cAAC,KAAD,UACI,cAAC,IAAD,CAAMb,GAAG,SAAT,SACI,qBAAKL,UAAWC,IAAI+B,OAAQpB,MAAO,CAACqB,gBAAgB,OAAD,OAAQC,GAAR,YAG3D,cAAC,KAAD,UACI,cAAC,IAAD,CAAM7B,GAAG,QAAT,SACI,qBAAKL,UAAWC,IAAI+B,OAAQpB,MAAO,CAACqB,gBAAgB,OAAD,OAAQE,GAAR,YAG3D,cAAC,KAAD,UACI,cAAC,IAAD,CAAM9B,GAAG,cAAT,SACI,qBAAKL,UAAWC,IAAI+B,OAAQpB,MAAO,CAACqB,gBAAgB,OAAD,OAAQG,GAAR,eAOvE,SAASC,EAAUC,GACf,IAAIjR,EAAQ,KAgBZ,MAfkB,UAAdiR,EAAK5c,MACLub,EAAcsB,IACdpB,EAAc,GACd9P,EAAQ6Q,IAEW,SAAdI,EAAK5c,MACVub,EAAcuB,IACdrB,EAAc,GACd9P,EAAQ8Q,IAEW,eAAdG,EAAK5c,OACVub,EAAcwB,IACdtB,EAAc,GACd9P,EAAQ+Q,IAGR,sBAAKpC,UAAWC,IAAIyC,KAApB,UACI,qBAAK1C,UAAWC,IAAI0C,SAAU/B,MAAO,CAACqB,gBAAgB,OAAD,OAAQ5Q,EAAR,QACrD,qBAAK2O,UAAWC,IAAI2C,YAAazC,QAAS,WAAKra,QAAQyG,IAAIwT,cAAwBpU,EAAMyU,QAAQzc,KAAKoc,cAA+BuC,EAAK5c,KAAO,aAAjJ,SACI,oBAAIsa,UAAWC,IAAI4C,KAAnB,iCAKJ,qBAAK7C,UAAWC,IAAI2C,YAAazC,QAAS,WAAKxU,EAAMyU,QAAQzc,KAAKoc,cAA+BuC,EAAK5c,KAAO,mBAA7G,SACI,oBAAIsa,UAAWC,IAAI4C,KAAnB,wCAMJ,qBAAK7C,UAAWC,IAAI2C,YAAazC,QAAS,WAAKxU,EAAMyU,QAAQzc,KAAKoc,cAA+BuC,EAAK5c,KAAO,YAA7G,SACI,oBAAIsa,UAAWC,IAAI4C,KAAnB,+BAUhB,OA/EAC,KAAWC,IAAI,CAACC,KAAiBC,KAAYC,OAgFzC,eAAC,IAAD,CAAQpD,SAAUC,aAAlB,UACI,sBAAKC,UAAWC,IAAIC,UAApB,UACI,oBAAIF,UAAWC,IAAIva,KAAnB,SACI,cAAC,IAAD,CAAM2a,GAAG,IAAIL,UAAWC,IAAI7P,KAA5B,yBAIJ,qBAAK4P,UAAWC,IAAI/P,WAApB,SACI,qBAAK8P,UAAWC,IAAIkD,OAAQvC,MAAO,CAACqB,gBAAgB,OAAD,OAAQ/R,EAAR,MAAnD,SACI,eAAC,IAAD,WACI,cAAC,IAAD,CAAOsQ,KAAK,SAAZ,SACI,cAAC6B,EAAD,CAAW3c,KAAM,YAErB,cAAC,IAAD,CAAO8a,KAAK,QAAZ,SACI,cAAC6B,EAAD,CAAW3c,KAAM,WAErB,cAAC,IAAD,CAAO8a,KAAK,cAAZ,SACI,cAAC6B,EAAD,CAAW3c,KAAM,iBAErB,cAAC,IAAD,CAAO8a,KAAK,IAAZ,SACI,cAACY,EAAD,CAAYpB,UAAWC,IAAImD,qBAM/C,yBAAQpD,UAAWC,IAAIS,OAAvB,4CAEI,mBAAGC,KAAK,2CAA2CpE,OAAO,SAASqE,MAAO,CAACC,eAAgB,OAAQC,MAAM,SAAzG,4B,qBClDDuC,OA3Ef,SAAuB1X,GAEnB,IAAMyT,EAAgBC,iBAAO,MACvBC,EAAgBD,iBAAO,MAHH,EAI4BE,mBAAS,CAACtN,MAAO,EAAGC,OAAQ,IAJxD,mBAInBsN,EAJmB,KAIEC,EAJF,OAK4BF,mBAAS,CAACtN,MAAO,EAAGC,OAAQ,IALxD,mBAKEwN,GALF,WAqB1B,OAdAC,qBAAY,WACJP,EAAclV,SACduV,EAAuB,CACnBxN,MAAOmN,EAAclV,QAAQ0V,YAC7B1N,OAAQkN,EAAclV,QAAQ2V,eAGlCP,EAAcpV,SACdwV,EAAuB,CACnBzN,MAAOqN,EAAcpV,QAAQ0V,YAC7B1N,OAAQoN,EAAcpV,QAAQ2V,iBAGvC,CAACT,EAAeE,IAEf,eAAC,IAAD,CAAQQ,SAAUC,aAAlB,UACI,sBAAKC,UAAWC,KAAIC,UAApB,UACI,oBAAIF,UAAWC,KAAIva,KAAMya,QAAS,WAAKxU,EAAMyU,QAAQzc,KAAKoc,gBAA1D,SACI,cAAC,IAAD,CAAMM,GAAG,IAAIL,UAAWC,KAAI7P,KAA5B,yBAIJ,sBAAK4P,UAAWC,KAAI/P,WAApB,UACI,qBAAK8P,UAAWC,KAAIK,WAAYC,IAAKnB,EAArC,SACI,eAAC,IAAD,WACI,cAAC,IAAD,CAAOoB,KAAK,SAAZ,SAGsC,IAA9BhB,EAAoBvN,MACpB,wBAAc,cAAC,GAAD,CACVwM,UAAU,EACVK,SAAS,EACTH,QAAQ,EACRrS,UAAW,CAACkT,EAAoBvN,MAAOuN,EAAoBtN,YAIvE,cAAC,IAAD,CAAOsO,KAAK,QAAZ,kBAGA,cAAC,IAAD,CAAOA,KAAK,cAAZ,6BAKR,qBAAKR,UAAWC,KAAIQ,WAAYF,IAAKjB,EAArC,SACI,eAAC,IAAD,WACI,cAAC,IAAD,CAAOkB,KAAK,SAAZ,mBAGA,cAAC,IAAD,CAAOA,KAAK,QAAZ,kBAGA,cAAC,IAAD,CAAOA,KAAK,cAAZ,mCAOhB,yBAAQR,UAAWC,KAAIS,OAAvB,4CAEI,mBAAGC,KAAK,2CAA2CpE,OAAO,SAASqE,MAAO,CAACC,eAAgB,OAAQC,MAAM,SAAzG,4B,qBCtBDwC,OAlDf,SAAgB3X,GACd,OACE,eAAC,IAAD,CAAQmU,SAAUC,aAAlB,UACI,sBAAKC,UAAWC,KAAIC,UAApB,UACI,oBAAIF,UAAWC,KAAIva,KAAMya,QAAS,WAAKxU,EAAMyU,QAAQzc,KAAKoc,gBAA1D,SACI,cAAC,IAAD,CAAMM,GAAG,IAAIL,UAAWC,KAAI7P,KAA5B,yBAIJ,sBAAK4P,UAAWC,KAAI/P,WAApB,UACI,qBAAK8P,UAAWC,KAAIK,WAApB,SACI,eAAC,IAAD,WACI,cAAC,IAAD,CAAOE,KAAK,SAAZ,mBAGA,cAAC,IAAD,CAAOA,KAAK,QAAZ,kBAGA,cAAC,IAAD,CAAOA,KAAK,cAAZ,6BAKR,qBAAKR,UAAWC,KAAIQ,WAApB,SACI,eAAC,IAAD,WACI,cAAC,IAAD,CAAOD,KAAK,WAOZ,cAAC,IAAD,CAAOA,KAAK,QAAZ,kBAGA,cAAC,IAAD,CAAOA,KAAK,cAAZ,mCAOhB,yBAAQR,UAAWC,KAAIS,OAAvB,4CAEI,mBAAGC,KAAK,2CAA2CpE,OAAO,SAASqE,MAAO,CAACC,eAAgB,OAAQC,MAAM,SAAzG,4B,SCvCNV,GAAUmD,eAyBDC,OAvBf,WACE,OACE,qBAAKxD,UAAWC,IAAI/P,WAApB,SACE,cAAC,IAAD,CAAQkQ,QAASA,GAASN,SAAUC,aAApC,SACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOS,KAAK,aAAZ,SACE,cAAC,GAAD,CAASJ,QAASA,OAEpB,cAAC,IAAD,CAAOI,KAAK,mBAAZ,SACE,cAAC,GAAD,CAAeJ,QAASA,OAE1B,cAAC,IAAD,CAAOI,KAAK,WAAZ,SACE,cAAC,GAAD,CAAQJ,QAASA,OAEnB,cAAC,IAAD,CAAOI,KAAK,IAAZ,SACE,cAAC,GAAD,CAAMJ,QAASA,eClBZqD,GAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqBhH,MAAK,YAAkD,IAA/CiH,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCDdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,GAAD,MAEFhK,SAASiK,eAAe,SAM1BX,M,mBCfA3gB,EAAOC,QAAU,CAAC,WAAa,yBAAyB,UAAY,wBAAwB,OAAS,qBAAqB,KAAO,mBAAmB,KAAO,mBAAmB,KAAO,mBAAmB,SAAW,uBAAuB,YAAc,0BAA0B,OAAS,qBAAqB,OAAS,qBAAqB,OAAS,qBAAqB,gBAAkB,8BAA8B,KAAO,sB","file":"static/js/main.13d1679f.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"Genetic_background__zkABP\",\"container\":\"Genetic_container__3BPBj\",\"footer\":\"Genetic_footer__19fsM\",\"gameScreen\":\"Genetic_gameScreen__3qtyt\",\"name\":\"Genetic_name__vF0vp\",\"text\":\"Genetic_text__1bC0W\",\"plotScreen\":\"Genetic_plotScreen__3dRxY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"Reinforcement_background__1Bv23\",\"container\":\"Reinforcement_container__3LXxV\",\"footer\":\"Reinforcement_footer__103Hd\",\"gameScreen\":\"Reinforcement_gameScreen__1ndi4\",\"name\":\"Reinforcement_name__TAEiF\",\"text\":\"Reinforcement_text__9Aprn\",\"plotScreen\":\"Reinforcement_plotScreen__3DOwi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"Battle_background__2bwgt\",\"container\":\"Battle_container__3Hpn_\",\"footer\":\"Battle_footer__D9PXy\",\"gameScreen\":\"Battle_gameScreen__1hthJ\",\"name\":\"Battle_name__EcAiI\",\"text\":\"Battle_text__34_Jy\",\"plotScreen\":\"Battle_plotScreen__6ZSH0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"App_background__3GJc-\"};","function Individual() {\n    const calculate = () => {\n        throw new Error('calculate_fitness function must be defined');\n    }\n\n    const fitness = () => {\n        throw new Error('fitness property must be defined');\n    }\n\n    const fitness_ = () => {\n        throw new Error('fitness property cannot be set. Use calculate_fitness instead');\n    }\n\n    const encode_chromosome = () => {\n        throw new Error('encode_chromosome function must be defined');\n    }\n\n    const decode_chromosome = () => {\n        throw new Error('decode_chromosome function must be defined');\n    }\n\n    const chromosome = () => {\n        throw new Error('chromosome property must be defined');\n    }\n\n    const chromosome_ = (val) => {\n        throw new Error('chromosome property cannot be set.');\n    }\n}\n\nexport default Individual;","var nj = require('@aas395/numjs');\nconst random = require('random');\n\nexport const sigmoid = x => {return 1.0 / (1.0 + nj.exp(-x))};\nexport const tanh = x => {return nj.tanh(x)};\nexport const relu = x => {\n    var arr = [];\n    for (var i of x) {\n        if (i >= 0)\n            arr.push(i);\n        else\n            arr.push([0]);\n    }\n    return arr;\n};\nexport const linear = x => x;\n\nexport class FeedForwardNetwork {\n    constructor(layer_nodes, hidden_activation, output_activation, init_method='uniform', seed=null) {\n        this.params = {};\n        this.layer_nodes = layer_nodes;\n        this.hidden_activation = hidden_activation;\n        this.output_activation = output_activation;\n        this.inputs = null;\n        this.out = null;\n\n        // Initialize weights and bias\n        for (var l=1; l < this.layer_nodes.length; l++) {\n            if (init_method == 'uniform') {\n                var arrW = []\n                for (var i=0; i < this.layer_nodes[l]; i++) {\n                    var arr = []\n                    for (var j=0; j < this.layer_nodes[l-1]; j++) {\n                        arr.push(random.uniform(-1,1)());\n                    }\n                    arrW.push(arr);\n                }\n                var arrb = [];\n                for (var i=0; i < this.layer_nodes[l]; i++) {\n                    arrb.push([random.uniform(-1,1)()]);\n                }\n                this.params['W' + l.toString()] = arrW;\n                this.params['b' + l.toString()] = arrb;\n            } else {\n                throw new Error('Implement more options, bro');\n            }\n            \n            this.params['A' + l.toString()] = null;\n        }\n    }\n\n    feed_forward = (X) => {\n        var A_prev = X;\n        const L = this.layer_nodes.length - 1;\n        var W = null;\n        var b = null;\n        var Z = null;\n        // Feed hidden layers\n        for (var l=1; l<L; l++) {\n            W = this.params['W' + l.toString()];\n            b = this.params['b' + l.toString()];\n            // console.log(W, A_prev);\n            // console.log('dot', typeof nj.dot(W,A_prev), nj.dot(W, A_prev))\n            // console.log('b', typeof nj.array(b), nj.array(b))\n            Z = nj.dot(W, A_prev).add(nj.array(b));\n            // console.log('Z', typeof Z, Z)\n            A_prev = this.hidden_activation(Z.tolist());\n            // console.log('A_prev', A_prev)\n            this.params['A' + l.toString()] = A_prev;\n        }\n\n        W = this.params['W' + L.toString()];\n        b = this.params['b' + L.toString()];\n        Z = nj.dot(W, A_prev).add(nj.array(b));\n        const out = this.hidden_activation(Z.tolist());\n        this.params['A'+L.toString()] = out;\n        for (var i=0; i<out.length; i++) {\n            if (this.out === null)\n                this.out = i;\n            else {\n                if (out[i][0] > this.out)\n                    this.out = i\n            }\n        }\n        // console.log('a', out)\n        // console.log('out', this.out)\n        return this.out;\n    }\n}\n\nexport const get_activation_by_name = name => {\n    const activations = [['relu', relu],\n                        ['sigmoid', sigmoid],\n                        ['linear', linear],\n                        ['tanh', tanh]\n                        ]\n    var func = [];\n    for (var i=0; i<activations.length; i++) {\n        if (activations[i][0] === name.toLowerCase())\n            func.push(activations[i][1]);\n    }\n    console.assert(func.length == 1);\n    return func[0];\n}","import Individual from '../genetic_algorithm/individual';\nimport {FeedForwardNetwork, linear, sigmoid, tanh, relu, get_activation_by_name} from './neural_network';\n\n// var nj = require('numjs');\n\nclass Paddle extends Individual{\n    constructor(p5, xPaddle=0, yPaddle=200, ySpeed=0, boardSize, chromosome=null, hidden_layer_architecture=[20,12], hidden_activation='relu', output_activation='sigmoid') {\n        super(Individual());\n        this.xPaddle = xPaddle;\n        this.yPaddle = yPaddle;\n        this.ySpeed = ySpeed;\n        this.board_size = boardSize;\n\n        this.fitness = 0;\n        this.hit = 0;\n        this.distance_travelled = 0;\n        this.ball_travelled = 0;\n        this.distance_to_ball = 0;\n        this.is_alive = true;\n\n        this.hidden_layer_architecture = hidden_layer_architecture;\n        this.hidden_activation = hidden_activation;\n        this.output_activation = output_activation;\n\n        // Setting up network architecture\n        // Each \"Vision\" has 3 distances it tracks: wall, apple and self\n        // there are also one-hot encoded direction and one-hot encoded tail direction,\n        // each of which have 4 possibilities.\n        const num_inputs = 5  \n        this.network_architecture = [num_inputs]                          // Inputs\n        this.network_architecture.push(...this.hidden_layer_architecture)  // Hidden layers\n        this.network_architecture.push(3)                               // 3 outputs, ['left', 'still', 'right']\n        this.network = new FeedForwardNetwork(this.network_architecture,\n                                          get_activation_by_name(this.hidden_activation),\n                                          get_activation_by_name(this.output_activation)\n        )\n\n        // If chromosome is set, take it\n        if (chromosome) {\n            // this._chromosome = chromosome\n            this.network.params = chromosome\n            // this.decode_chromosome()\n        } else {\n            // this._chromosome = {}\n            // this.encode_chromosome()\n        }\n        \n    }\n\n    fitness = () => {\n        return this.fitness;\n    }\n\n    calculate_fitness = () => {\n        this.fitness = (2 ** this.hit + this.hit * 2.1) * 200 + ((1 - Math.min(this.distance_travelled / this.ball_travelled, 1)) * 400) + (this.board_size[0] - this.distance_to_ball) * 0.5;\n        this.fitness = Math.max(this.fitness, .1);\n    }\n\n    reset = () => {\n        this.fitness = 0;\n        this.hit = 0;\n        this.distance_travelled = 0;\n        this.distance_to_ball = 0;\n        this.is_alive = 0;\n    }\n\n    update = (inputs=null, ball=null) => {\n        if (inputs !== null) {\n            this.network.feed_forward(inputs);\n        } else if (ball !== null) {\n            this.yPaddle = ball.yBall - 45;\n        }\n        if (this.network.out === 0) {\n            this.ySpeed = -15;\n        } else if (this.network.out === 1) {\n            this.ySpeed = 15;\n        } else if (this.network.out === 2) {\n            this.ySpeed = 0;\n        }\n        return true;\n    }\n\n    move = () => {\n        this.yPaddle += this.ySpeed;\n        this.distance_travelled += Math.abs(this.ySpeed);\n    }\n\n    draw = (p5, winner=false, champion=false) => {\n        if (!this.is_alive) {\n            return;\n        } else if (champion) {\n            p5.fill('#00ff00');\n            p5.rect(this.xPaddle, this.yPaddle, 15, 90);\n        } else if (winner) {\n            p5.fill('#00ff00');\n            p5.rect(this.xPaddle, this.yPaddle, 15, 90);\n        } else {\n            p5.fill('#00ffff');\n            p5.rect(this.xPaddle, this.yPaddle, 15, 90);\n        }\n    }\n}\n\nexport default Paddle;","class Ball {\n    constructor(xBall, yBall, xSpeed, ySpeed) {\n        this.xBall = xBall;\n        this.yBall = yBall;\n        this.xSpeed = xSpeed;\n        this.ySpeed = ySpeed;\n        this.xLast = xBall - xSpeed;\n        this.yLast = yBall - ySpeed;\n\n        this.is_alive = true;\n        this.distance_travelled = 0;\n    }\n    \n\n    update = (paddle, boardSize) => {\n        this.distance_travelled += Math.abs(this.ySpeed);\n\n        if (this.yBall < 0) {\n            this.yBall = 0;\n            this.ySpeed *= -1;\n        }\n        else if (this.yBall > boardSize[1]-20) {\n            this.yBall = boardSize[1]-20;\n            this.ySpeed *= -1;\n        }\n        else if (this.xBall > boardSize[0]-35) {\n            this.xBall = boardSize[0]-35;\n            this.xSpeed *= -1;\n        }\n        else if (this.yBall > paddle.yPaddle-10 && this.yBall < paddle.yPaddle + 80 && this.xLast > 15 && this.xBall <= 15) {\n            this.xSpeed *= -1;\n            paddle.hit += 1;\n            paddle.distance_to_ball = 0;\n        }\n        else if (this.xBall < 0) {\n            this.xSpeed *= -1;\n            paddle.ball_travelled = this.distance_travelled;\n            paddle.is_alive = false;\n            paddle.distance_to_ball = Math.abs(this.xBall - paddle.xPaddle);\n        }\n    }\n\n    move = () => {\n        this.xLast = this.xBall;\n        this.yLast = this.yBall;\n\n        this.xBall += this.xSpeed;\n        this.yBall += this.ySpeed;\n    }\n\n    draw = (p5) => {\n        p5.fill('#d9c3f7');\n        p5.ellipse(this.xBall, this.yBall, 20, 20);\n    }\n}\n\nexport default Ball;","const settings = {\n    // Hidden layer activation is specific to hidden layers, i.e. all layers except the input and output\n    'hidden_layer_activation':     'relu',     // Options are [relu, sigmoid, tanh, linear, leaky_relu]\n    // Output layer activation is specific to the output layer \n    'output_layer_activation':     'sigmoid',  // Options are [relu, sigmoid, tanh, linear, leaky_relu]\n    // Hidden network architecture describes the number of nodes in each hidden layer\n    'hidden_network_architecture': [12, 20, 12],   // A list containing number of nodes in each hidden layer\n\n    //### GA stuff ####\n\n    //# Mutation ##\n\n    // Mutation rate is the probability that a given gene in a chromosome will randomly mutate\n    'mutation_rate':               0.05,       // Value must be between [0.00, 1.00)\n    // If the mutation rate type is static, then the mutation rate will always be `mutation_rate`,\n    // otherwise if it is decaying it will decrease as the number of generations increase\n    'mutation_rate_type':          'static',   // Options are [static, decaying]\n    // The probability that if a mutation occurs, it is gaussian\n    'probability_gaussian':        1.0,        // Values must be between [0.00, 1.00]\n    // The probability that if a mutation occurs, it is random uniform\n    'probability_random_uniform':  0.0,        // Values must be between [0.00, 1.00]\n\n    //# Crossover ##\n    \n    // eta related to SBX. Larger values create a distribution closer around the parents while smaller values venture further from them.\n    // Only used if probability_SBX > 0.00\n    'SBX_eta':                     100,\n    // Probability that when crossover occurs, it is simulated binary crossover\n    'probability_SBX':             1,\n    // The type of SPBX to consider. If it is 'r' then it flattens a 2D array in row major ordering.\n    // If SPBX_type is 'c' then it flattens a 2D array in column major ordering.\n    'SPBX_type':                   'r',        // Options are 'r' for row or 'c' for column\n    // Probability that when crossover occurs, it is single point binary crossover\n    'probability_SPBX':            0,\n    // Crossover selection type determines the way in which we select individuals for crossover\n    'crossover_selection_type':    'roulette_wheel',\n\n    //# Selection ##\n\n    // Number of parents that will be used for reproducing\n    'num_parents':                 50,\n    // Number of offspring that will be created. Keep num_offspring >= num_parents\n    'num_offspring':               100,\n    // The selection type to use for the next generation.\n    // If selection_type == 'plus':\n    //     Then the top num_parents will be chosen from (num_offspring + num_parents)\n    // If selection_type == 'comma':\n    //     Then the top num_parents will be chosen from (num_offspring)\n    // @NOTE: if the lifespan of the individual is 1, then it cannot be selected for the next generation\n    // If enough indivduals are unable to be selected for the next generation, new random ones will take their place.\n    // @NOTE: If selection_type == 'comma' then lifespan is ignored.\n    //   This is equivalent to lifespan = 1 in this case since the parents never make it to the new generation.\n    'selection_type':              'plus',     // Options are ['plus', 'comma']\n}\n\nexport default settings;","var nj = require('@aas395/numjs');\n\nclass Population {\n    constructor(individuals) {\n        this.individuals = individuals;\n    }\n\n    num_individuals = () => {\n        return this.individuals.length;\n    }\n\n    num_individuals_ = () => {\n        throw new Error('Cannot set the number of individuals. You must change Population.individuals instead');\n    }\n\n    num_genes = () => {\n        return this.individuals[0].chromosome.shape[1];\n    }\n\n    num_genes_ = () => {\n        throw new Error('Cannot set the number of genes. You must change Population.individuals instead');\n    }\n\n    average_fitness = () => {\n        var sum = 0;\n        for (var individual of this.individuals)\n            sum += individual.fitness;\n        return sum / this.individuals.length;\n    }\n\n    average_fitness_ = () => {\n        throw new Error('Cannot set average fitness. This is a read-only property.');\n    }\n\n    fittest_individual = () => {\n        var best = 0;\n        var indi = null;\n        for (var individual of this.individuals) {\n            if (individual.fitness > best) {\n                best = individual.fitness;\n                indi = individual;\n            }\n        }\n        return indi;\n    }\n\n    fittest_individual_ = () => {\n        throw new Error('Cannot set fittest individual. This is a read-only property');\n    }\n\n    calculate_fitness = () => {\n        for (var individual of this.individuals) {\n            individual.calculate_fitness();\n        }\n    }\n\n    get_fitness_std = () => {\n        return nj.std(nj.array(this.individuals.map(a=>a.fitness)));\n    }\n}\n\nexport default Population;","var nj = require('@aas395/numjs');\nconst random = require('random');\n\nexport function elitism_selection(population, num_individuals) {\n    var individuals = population.individuals.sort(a=>a.fitness).reverse();\n    return individuals.slice(0, num_individuals);\n}\n\nexport function roulette_wheel_selection(population, num_individuals) {\n    var selection = [];\n    var wheel = 0;\n    for (var individual of population.individuals) {\n        wheel += individual.fitness;\n    }\n    for (var i=0; i<num_individuals; i++) {\n        const pick = random.float(0, wheel);\n        var current = 0;\n        for (var individual of population.individuals) {\n            current += individual.fitness;\n            if (current > pick) {\n                selection.push(individual);\n                break;\n            }\n        }\n    }\n    return selection;\n}","var nj = require('@aas395/numjs');\nvar random = require('random');\n\nexport function gaussian_mutation(chromosome, prob_mutation, scale=null, mu=null, sigma=null) {\n    /*\n    Perform a gaussian mutation for each gene in an individual with probability, prob_mutation.\n\n    If mu and sigma are defined then the gaussian distribution will be drawn from that,\n    otherwise it will be drawn from N(0, 1) for the shape of the individual.\n    */\n   // Determine which genes will be mutated\n   var mutation_array = [];\n   for (var i=0; i<chromosome.shape[0]; i++) {\n        var arr = [];\n        for (var j=0; j<chromosome.shape[1]; j++) \n            arr.push(random.float() < prob_mutation ? 1 : 0);\n        mutation_array.push(arr);\n   }\n   // If mu and sigma are defined, create gaussian distribution around each one\n   var gaussian_mutation = [];\n   if (mu && sigma) {\n       gaussian_mutation = random.normal(mu, sigma)();\n   } else {\n        for (var i=0; i<chromosome.shape[0]; i++) {\n            var arr = [];\n            for (var j=0; j<chromosome.shape[1]; j++) \n                arr.push(random.normal()());\n            gaussian_mutation.push(arr);\n        }\n   }\n\n   if (scale) {\n       for (var i = 0; i<chromosome.shape[0]; i++) {\n            for (var j=0; j<chromosome.shape[1]; j++) {\n                if (mutation_array[i][j])\n                    gaussian_mutation[i][j] *= scale;\n            }\n       }\n   }\n   // Update\n   for (var i = 0; i<chromosome.shape[0]; i++) {\n        for (var j=0; j<chromosome.shape[1]; j++) {\n            if (mutation_array[i][j] === 1)\n                chromosome.set(i, j, chromosome.get(i,j) + gaussian_mutation[i][j]);\n        }\n    } \n}\n\nexport function random_uniform_mutation(chromosome, prob_mutation, low, high) {\n    // var mutation_array = nj.random.random(chromosome.shape) < prob_mutation;\n    // if (low isinstanceof Array) {\n\n    // }\n}","var nj = require('@aas395/numjs');\nconst random = require('random');\n\nexport function simulated_binary_crossover(parent1, parent2, eta) {\n    /*\n    This crossover is specific to floating-point representation.\n    Simulate behavior of one-point crossover for binary representations.\n\n    For large values of eta there is a higher probability that offspring will be created near the parents.\n    For small values of eta, offspring will be more distant from parents\n    */\n    var rand = nj.random(nj.array(parent1).shape);\n    var gamma = nj.zeros(nj.array(parent1).shape);\n    for (var i=0; i<gamma.shape[0]; i++) {\n        for (var j=0; j<gamma.shape[1]; j++) {\n            if (rand.get(i,j) <= 0.5) {\n                gamma.set(i, j, ((2 * rand.get(i,j)) ** (1.0 / (eta + 1))));\n            }\n            else {\n                gamma.set(i, j, ((1.0 / (2.0 * (1.0 - rand.get(i,j)))) ** (1.0 / (eta + 1))));\n            }\n        }\n    }\n    // Calculate Child 1 chromosome (Eq. 9.9)\n    var chromosome1 = (((gamma.add(1)).multiply(parent1)).add(nj.ones(gamma.shape).subtract(gamma)).multiply(parent2)).multiply(0.5);\n    // Calculate Child 2 chromosome (Eq. 9.10)\n    var chromosome2 = (((nj.ones(gamma.shape).subtract(gamma)).multiply(parent1)).add((gamma.add(1)).multiply(parent2)).multiply(0.5));\n\n    return [chromosome1, chromosome2];\n}\n\nexport function uniform_binary_crossover(parent1, parent2) {\n    var offspring1 = nj.copy(parent1);\n    var offspring2 = nj.copy(parent2);\n\n    var mask = [];\n    for (var i=0; i<offspring1.shape; i++)\n        mask.push(random.uniform(0, 1));\n    offspring1[mask > 0.5] = parent2[mask > 0.5];\n    offspring2[mask > 0.5] = parent1[mask > 0.5];\n\n    return [offspring1, offspring2];\n}\n\nexport function single_point_binary_crossover(parent1, parent2, major='r') {\n    var offspring1 = nj.copy(parent1);\n    var offspring2 = nj.copy(parent2);\n\n    // var rows, cols = parent2.shape;\n    // const row = random.int(0, rows);\n    // const col = random.int(0, cols);\n\n    // if (major.toLowerCase() === 'r') {\n    //     off\n    // }\n    return [offspring1, offspring2];\n}","import Sketch from 'react-p5';\nimport Paddle from './Paddle';\nimport Ball from './Ball';\nimport settings from './settings';\nimport Population from '../genetic_algorithm/population';\nimport {FeedForwardNetwork, sigmoid, linear, relu} from './neural_network'\nimport {elitism_selection, roulette_wheel_selection} from '../genetic_algorithm/selection';\nimport {gaussian_mutation, random_uniform_mutation} from '../genetic_algorithm/mutation';\nimport {simulated_binary_crossover as SBX} from '../genetic_algorithm/crossover';\nimport {uniform_binary_crossover, single_point_binary_crossover} from '../genetic_algorithm/crossover';\nconst random = require('random');\nvar nj = require('@aas395/numjs');\n\nfunction Pong(props) {\n    const cumulativeSum = (sum => value => sum += value)(0);\n    var _mutation_bins = [settings['probability_gaussian'], settings['probability_random_uniform']].map(cumulativeSum);\n    var _crossover_bins = [settings['probability_SBX'], settings['probability_SPBX']].map(cumulativeSum);\n    var _SPBX_type = settings['SPBX_type'].toLowerCase();\n    var _SBX_eta = settings['SBX_eta'];\n    var _mutation_rate = settings['mutation_rate'];\n\n    // Determine size of next gen based off selection type\n    var _next_gen_size = null;\n    if (settings['selection_type'].toLowerCase() == 'plus')\n        _next_gen_size = settings['num_parents'] + settings['num_offspring'];\n    else if (settings['selection_type'].lower() == 'comma')\n        _next_gen_size = settings['num_offspring'];\n    else\n        throw new Error('Selection type \"{}\" is invalid'.format(settings['selection_type']));\n\n    var board_size = props.dimension;\n    console.log(board_size)\n\n    var individuals = [];\n    var balls = [];\n\n    var population = new Population(individuals);\n    var current_generation = 0;\n    var winner = null;\n    var winner_index = -1;\n    var champion = null;\n    var champion_index = -1;\n    var champion_fitness = Number.NEGATIVE_INFINITY;\n\n    var num_hit = 0;\n    var best_hit = 0;\n\n    var training_paddle = null;\n    var newball = true;\n\n    const setup = (p5, canvasParentRef) => {\n        // use parent to render the canvas in this ref\n        // (without that p5 will render the canvas outside of your component)\n        p5.createCanvas(board_size[0], board_size[1]).parent(canvasParentRef);\n        training_paddle = new Paddle(p5, board_size[0]-15, board_size[1]/2-45, 0, board_size);\n        for (var i=0; i < settings['num_parents']; i++) {\n            const individual = new Paddle(p5, 0, board_size[1]/2-45, 0, board_size, null,\n                                    settings['hidden_network_architecture'], \n                                    settings['hidden_layer_activation', \n                                    settings['output_activation']]);\n            individuals.push(individual);\n        }\n    };\n \n    const draw = (p5) => {\n        p5.background(0);\n        p5.textSize(20);\n        p5.text('Generation: '+current_generation, board_size[0]-180, 30);\n        p5.text('Hit: '+num_hit, board_size[0]-180, 60);\n        p5.text('Best: '+best_hit, board_size[0]-180, 90);\n        // New set of balls\n        if (newball) {\n            balls = [];\n            const bally = random.int(0, board_size[1]);\n            const speedy = random.int() === 1 ? 15 : -15;\n            for (var i=0; i < _next_gen_size+1; i++) {\n                balls.push(new Ball(board_size[0] / 2, bally, 15, speedy));\n            }\n            newball = false;\n        }\n\n        // Update training paddle\n        training_paddle.update(null, balls[balls.length-1]);\n        balls[balls.length-1].update(training_paddle, board_size);\n        balls[balls.length-1].move();\n        training_paddle.is_alive = true;\n        training_paddle.draw(p5);\n\n        var still_alive = 0;\n        // Loop through the paddles in the generation\n        for (var i=0; i < population.individuals.length; i++) {\n            var paddle = population.individuals[i];\n\n            if (paddle.is_alive) {\n                still_alive++;\n                //----------------------------------------inputs for neural network--------------------------------------------\n                // const distance = ((balls[i].y - paddle.y_pos) ** 2 + (balls[i].x - paddle.x_pos) ** 2) ** 0.5;\n                // const ball_distance_left_wall = balls[i].yBall - 0;\n                // const ball_distance_right_wall = board_size[1] - balls[i].yBall;\n                const inputs = [[paddle.yPaddle], [balls[i].ySpeed], [paddle.ySpeed], [balls[i].yBall], [balls[i].xSpeed]];\n                // inputs = np.array([[paddle.x_pos], [balls[i].xspeed], [paddle.xspeed], [balls[i].x]])\n                //----------------------------------------inputs for neural network--------------------------------------------\n                paddle.update(inputs);\n                balls[i].update(paddle, board_size);\n                num_hit = Math.max(num_hit, paddle.hit);\n                best_hit = Math.max(num_hit, best_hit);\n                balls[i].move();\n                paddle.move();\n            }\n\n            // Draw every paddle except the best ones\n            if (paddle.is_alive && paddle !== winner && paddle !== champion) {\n                // paddle.winner = False\n                // paddle.champion = False\n                balls[i].draw(p5);\n                paddle.draw(p5);\n            }\n        }\n        // Generate new generation when all have died out\n        if (still_alive === 0)\n            next_generation(p5);\n\n        // Draw the winning and champion paddle last\n        if (winner !== null && winner.is_alive) {\n            balls[winner_index].draw(p5);\n            winner.draw(p5, true, false);\n        }\n        if (champion !== null && champion.is_alive) {\n            balls[champion_index].draw(p5);\n            champion.draw(p5, false, true);\n        }\n    };\n\n    const next_generation = (p5) => {\n        current_generation++;\n        newball = true;\n        num_hit = 0;\n        \n        // Calculate fitness of individuals\n        for (var individual of population.individuals)\n            individual.calculate_fitness();\n        \n        // Find winner from each generation and champion\n        winner = population.fittest_individual();\n        winner_index = population.individuals.indexOf(winner);\n        if (winner.fitness > champion_fitness) {\n            champion_fitness = winner.fitness;\n            champion = winner;\n            champion_index = winner_index;\n        }\n        winner.reset();\n        champion.reset();\n\n        // Print results from each generation\n        console.log('======================= Generation', current_generation, '=======================');\n        console.log('----Max fitness:', population.fittest_individual().fitness);\n        // print('----Best Score:', self.population.fittest_individual.score);\n        console.log('----Average fitness:', population.average_fitness());\n        \n        population.individuals = elitism_selection(population, settings['num_parents']);\n        population.individuals = shuffle(population.individuals);\n        var next_pop = [];\n\n        // parents + offspring selection type ('plus')\n        if (settings['selection_type'].toLowerCase() === 'plus') {\n            next_pop.push(winner);\n            next_pop.push(champion);\n        }\n\n        while (next_pop.length < _next_gen_size) {\n            var [p1, p2] = roulette_wheel_selection(population, 2);\n            const L = p1.network.layer_nodes.length;\n            var c1_params = {};\n            var c2_params = {};\n\n            // Each W_l and b_l are treated as their own chromosome.\n            // Because of this I need to perform crossover/mutation on each chromosome between parents\n            for (var l = 1; l < L; l++) {\n                const p1_W_l = p1.network.params['W' + l.toString()]\n                const p2_W_l = p2.network.params['W' + l.toString()]  \n                const p1_b_l = p1.network.params['b' + l.toString()]\n                const p2_b_l = p2.network.params['b' + l.toString()]\n\n                var c1_W_l = null, c2_W_l = null, c1_b_l = null, c2_b_l = null;\n\n                // Crossover\n                // @NOTE: I am choosing to perform the same type of crossover on the weights and the bias.\n                [c1_W_l, c2_W_l, c1_b_l, c2_b_l] = _crossover(p1_W_l, p2_W_l, p1_b_l, p2_b_l);\n\n                // Mutation\n                // @NOTE: I am choosing to perform the same type of mutation on the weights and the bias.\n                _mutation(c1_W_l, c2_W_l, c1_b_l, c2_b_l);\n\n                // Assign children from crossover/mutation\n                c1_params['W' + l.toString()] = c1_W_l;\n                c2_params['W' + l.toString()] = c2_W_l;\n                c1_params['b' + l.toString()] = c1_b_l;\n                c2_params['b' + l.toString()] = c2_b_l;\n\n                // Clip to [-1, 1]\n                for (var i=0; i<c1_params['W'+l.toString()].shape[0]; i++) {\n                    for (var j=0; j<c1_params['W'+l.toString()].shape[1]; j++) {\n                        c1_params['W'+l.toString()].set(i, j, c1_params['W'+l.toString()].get(i, j) < -1 ? -1 : c1_params['W'+l.toString()].get(i, j));\n                        c1_params['W'+l.toString()].set(i, j, c1_params['W'+l.toString()].get(i, j) > 1 ? 1 : c1_params['W'+l.toString()].get(i, j));\n                        c2_params['W'+l.toString()].set(i, j, c2_params['W'+l.toString()].get(i, j) < -1 ? -1 : c2_params['W'+l.toString()].get(i, j));\n                        c2_params['W'+l.toString()].set(i, j, c2_params['W'+l.toString()].get(i, j) > 1 ? 1 : c2_params['W'+l.toString()].get(i, j));\n                        c1_params['b'+l.toString()].set(i, j, c1_params['b'+l.toString()].get(i, j) < -1 ? -1 : c1_params['b'+l.toString()].get(i, j));\n                        c1_params['b'+l.toString()].set(i, j, c1_params['b'+l.toString()].get(i, j) > 1 ? 1 : c1_params['b'+l.toString()].get(i, j));\n                        c2_params['b'+l.toString()].set(i, j, c2_params['b'+l.toString()].get(i, j) < -1 ? -1 : c2_params['b'+l.toString()].get(i, j));\n                        c2_params['b'+l.toString()].set(i, j, c2_params['b'+l.toString()].get(i, j) > 1 ? 1 : c2_params['b'+l.toString()].get(i, j));\n                    }\n                }\n            }\n\n            // Create children from chromosomes generated above\n            var c1 = new Paddle(p5, 0, board_size[1]/2-45, 0, board_size, c1_params,\n                        settings['hidden_network_architecture'], \n                        settings['hidden_layer_activation', \n                        settings['output_activation']]);\n            var c2 = new Paddle(p5, 0, board_size[1]/2-45, 0, board_size, c2_params,\n                        settings['hidden_network_architecture'], \n                        settings['hidden_layer_activation', \n                        settings['output_activation']]);\n\n            // Add children to the next generation\n            next_pop.push(...[c1,c2]);\n        }\n        shuffle(next_pop);\n        population.individuals = next_pop;\n        \n    }\n\n    const _crossover = (parent1_weights, parent2_weights, parent1_bias, parent2_bias) => {\n        const rand_crossover = random.float();\n        var crossover_bucket = null;\n        for (var i = 1; i < _crossover_bins.length; i++) {\n            if (rand_crossover < _crossover_bins[i])\n                crossover_bucket = i-1;\n        }\n        var child1_weights = null;\n        var child2_weights = null;\n        var child1_bias = null;\n        var child2_bias = null;\n\n        // SBX\n        if (crossover_bucket === 0) {\n            [child1_weights, child2_weights] =  SBX(parent1_weights, parent2_weights, _SBX_eta);\n            [child1_bias, child2_bias] = SBX(parent1_bias, parent2_bias, _SBX_eta);\n        }\n\n        // Single point binary crossover (SPBX)\n        else if (crossover_bucket === 1) {\n            [child1_weights, child2_weights] = single_point_binary_crossover(parent1_weights, parent2_weights, _SPBX_type);\n            [child1_bias, child2_bias] =  single_point_binary_crossover(parent1_bias, parent2_bias, _SPBX_type);\n        }\n\n        else\n            throw new Error('Unable to determine valid crossover based off probabilities');\n        \n        return [child1_weights, child2_weights, child1_bias, child2_bias];\n    }\n\n    const _mutation = (child1_weights, child2_weights, child1_bias, child2_bias) => {\n        const scale = 0.2;\n        const rand_mutation = random.float();\n        var mutation_bucket = null;\n        for (var i = 1; i < _mutation_bins.length; i++) {\n            if (rand_mutation < _mutation_bins[i])\n                mutation_bucket = i-1;\n        }\n\n        var mutation_rate = _mutation_rate;\n        if (settings['mutation_rate_type'].toLowerCase() === 'decaying')\n            mutation_rate = mutation_rate / Math.sqrt(current_generation + 1);\n        \n        if (mutation_bucket === 0) {\n            // Mutate weights\n            gaussian_mutation(child1_weights, mutation_rate, scale);\n            gaussian_mutation(child2_weights, mutation_rate, scale);\n\n            // Mutate bias\n            gaussian_mutation(child1_bias, mutation_rate, scale);\n            gaussian_mutation(child2_bias, mutation_rate, scale);\n        }\n        \n        // Uniform random\n        else if (mutation_bucket === 1) {\n            // Mutate weights\n            random_uniform_mutation(child1_weights, mutation_rate, -1, 1);\n            random_uniform_mutation(child2_weights, mutation_rate, -1, 1);\n\n            // Mutate bias\n            random_uniform_mutation(child1_bias, mutation_rate, -1, 1);\n            random_uniform_mutation(child2_bias, mutation_rate, -1, 1);\n        }\n\n        else\n            throw new Error('Unable to determine valid mutation based off probabilities.');\n    }\n\n    const shuffle = array => {\n        var currentIndex = array.length, temporaryValue, randomIndex;\n      \n        // While there remain elements to shuffle...\n        while (0 !== currentIndex) {\n      \n          // Pick a remaining element...\n          randomIndex = Math.floor(Math.random() * currentIndex);\n          currentIndex -= 1;\n      \n          // And swap it with the current element.\n          temporaryValue = array[currentIndex];\n          array[currentIndex] = array[randomIndex];\n          array[randomIndex] = temporaryValue;\n        }\n      \n        return array;\n    }\n\n\n    return (\n        <div>\n            <Sketch setup={setup} draw={draw} />\n        </div>\n    );\n}\n\nexport default Pong;","export class colorGrid {\n  constructor(color) {\n      const colorList = {\n          red: \"#B22222\", purple: \"#4B0082\", green: \"#9ACD32\",\n          blue: \"#6495ED\", yellow: \"#DAA520\", black: \"#333333\",\n      };\n      if (color in colorList) {\n          this.color = colorList[color];\n      } else {\n          this.color = color;\n      }\n  }\n  draw(ctx, x, y, w, h) {\n      ctx.fillStyle = this.color;\n      ctx.fillRect(x, y, w, h);\n  }\n}\n\nexport class Rect {\n  constructor(x, y, w, h){\n      this.x = x;\n      this.y = y;\n      this.w = w;\n      this.h = h;\n  }\n\n  draw(context, sprite) {\n      sprite.draw(context, this.x, this.y, this.w, this.h);\n  }\n\n  contains(point) {\n      // check whether p is in [x,x+w) x [y,y+h)\n      // inclusive in x and y; exclusive in x+w, y+h\n      var x = point[0];\n      var y = point[1];\n      if (\n        x >= this.x &&\n        x < this.x + this.w  &&\n        y >= this.y &&\n        y < this.y + this.h\n      ) {\n          return true;\n      } else {\n          return false;\n      }\n  }\n\n  collideRect(rect, overlap=true){\n      if (!(overlap)) {\n          // weak collision detection:\n          // point collision; does not consider area overlap\n          if (this.x == rect.x || this.y == rect.y){\n              return true;\n          } else {\n              return false;\n          }\n      } else {\n          // strong collision; detects area collision\n          if (this.contains([rect.x, rect.y])\n          || rect.contains([this.x, this.y])){\n              return true;\n          } else {\n              return false;\n          }\n      }\n  }\n}\n\nexport var Sprite = function(fname) {\n\n    // Static Variables\n    var TO_RADIAN = Math.PI/180;\n\n    // Instance Variables\n    this.image = null;\n    if (fname != undefined && fname != '' && fname != null) {\n        this.image = new Image();\n        this.image.src = fname;\n        //console.log([this.image.width, this.image.height]);\n    } else {\n      console.log('cannot load file');\n    }\n\n    // Instance Methods\n\n    // draw: start from top-left point\n    this.draw = function(ctx, x, y, w, h) {\n      // ctx.context.scale(ctx.dpr, ctx.dpr);\n      if (w == undefined || h == undefined) {\n        ctx.drawImage(this.image, x, y);\n      } else {\n        ctx.drawImage(this.image, x, y, w, h);\n      }\n    };\n\n    // rotate image: from center of the image\n    this.rotate = function(ctx, x, y, angle) {\n      ctx.save();\n      ctx.scale(ctx.dpr, ctx.dpr);\n      ctx.translate(x, y);\n      ctx.rotate(angle * this.TO_RADIAN);\n      ctx.drawImage(this.image, -this.image.width/2, -this.image.height/2);\n      ctx.restore();\n    };\n};\n\nexport default Sprite;","import {Rect} from \"./sprite\"\n\nexport function getRandInt(min=0, max, step=1) {\n    // return an random integer from min to max\n    // range is [min, max), inclusive in min but not max\n    var min = Math.ceil(min);\n    var max = Math.floor(max);\n    var rand = min + step*Math.floor(Math.random()*(max-min)/step);\n    return rand;\n}\n\nexport function arrayEqual(a, b, compare=(x,y)=>x==y) {\n    /*\n    checks whether two array of \"==\"-comparable elements are equal\n    NOT intended for comparing elements that are NOT \"==\" comparable\n    extension: now you can use \"compare\" function; default is \"==\"\n    */\n    if (a === b) return true;\n    if (a == null || b == null) return false;\n    if (a.length != b.length) return false;\n\n    for (var i = 0; i < a.length; i++) {\n        if (!(compare(a[i], b[i]))) return false;\n    }\n    return true;\n}\n\nexport function arrayContains(arr, obj, compare) {\n    /* check if obj equals to an element of arr with \"compare\"*/\n    if (arr == null) return false;\n    var boo = false;\n    arr.forEach((item, i) => {\n        if (compare(item, obj)) boo = true;\n    });\n    return boo;\n}\n\nString.prototype.format = function () {\n    // string formatter\n    var i = 0, args = arguments;\n    return this.replace(/{}/g, function () {\n        return typeof args[i] != 'undefined' ? args[i++] : '';\n    });\n};\n\nexport function to_csv(array2d) {\n    // convert 2d array to csv\n    var csvContent = \"data:text/csv;charset=utf-8,\" \n    + array2d.map(e => e.join(\",\")).join(\"\\n\");\n    return csvContent;\n}\n\nexport function download(content, fileName) {\n    var encodedUri = encodeURI(content);\n    var link = document.createElement(\"a\");\n\n    link.setAttribute(\"href\", encodedUri);\n    link.setAttribute(\"download\", fileName);\n    document.body.appendChild(link);\n    link.click();\n}\n\nexport function generateExtraWalls(array2d, size, pix) {\n    if (array2d == null) return null;\n    var walls = [];\n    array2d.forEach(([x,y], i) => {\n        if (pix) {\n            x *= size; \n            y *= size;\n        }\n        walls.push(new Rect(x, y, size, size));\n    });\n    return walls;\n}\n\nexport function euclidean(p1, p2) {\n    const [x1, y1] = p1;\n    const [x2, y2] = p2;\n    return Math.sqrt((x1-x2)**2 + (y1-y2)**2);\n}\n\nexport function random_choice(array) {\n    const rand_idx = getRandInt(0, array.length);\n    return array[rand_idx];\n}\n\nexport function random_sample(array, batch_size) {\n    if (array.length < batch_size) return array;\n\n    var array_copy = array.map((item, i) => item);\n    var sample = [];\n    for (var i = 0; i < batch_size; i++) {\n        var rand_idx = getRandInt(0, array_copy.length);\n        sample.push(\n            array_copy.splice(rand_idx, 1)[0]\n        );\n    }\n    return sample;\n}\n\n// https://stackoverflow.com/questions/11488014/asynchronous-process-inside-a-javascript-for-loop\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise","/*\n1. All coordinates are in actual coordinats\n2. (0,0) is at the TOP-LEFT corner\n*/\n\nimport * as util from \"./util\";\nimport {colorGrid, Rect} from \"./sprite\";\nimport \"react-p5\";\n\n\nexport class Snake {\n    // Snake object for snake game.\n    // Attributes:\n    // - length\n    // - x\n    // - y\n    // - color\n    // - direction\n    // - boxSize\n    // - body\n    direction = \"U\";\n    length = 1;\n    constructor(x, y, length, direction, boxSize, board_x, board_y) {\n        this.x = x;\n        this.y = y;\n        this.length = length;\n        this.direction = direction;\n\n        this.boxSize = boxSize;\n        this.board_x = board_x;\n        this.board_y = board_y;\n\n        this.body = [];\n        this.initialize();\n        this.head = this.body[0];\n    }\n\n    initialize() {\n        var k1 = 0; var k2 = 0;\n        if (this.direction == \"R\") k1 = -1;\n        if (this.direction == \"L\") k1 = 1;\n        if (this.direction == \"U\") k2 = 1;\n        if (this.direction == \"D\") k2 = -1;\n\n        for (var i = 0; i < this.length; i++){\n            var tempRect = new Rect(\n                this.x + k1*i * this.boxSize,\n                this.y + k2*i * this.boxSize,\n                this.boxSize, this.boxSize\n            );\n            this.body.push(tempRect);\n        }\n    }\n\n    // change direction\n    changeDirection(direction) {\n        // input: direction in [0, 1, 2, 3]\n        const DIRECTION = [\"U\", \"R\", \"D\", \"L\"];\n\n        const current = DIRECTION.indexOf(this.direction);\n        const opposite = (current + 2) % 4;\n\n        if (direction != opposite && direction != current) {\n            this.direction = DIRECTION[direction];\n        }\n    }\n\n    // move a step forward\n    addHead(collideWall=true) {\n        var k1 = 0; var k2 = 0;\n        if (this.direction == \"R\") k1 = 1;\n        if (this.direction == \"L\") k1 = -1;\n        if (this.direction == \"U\") k2 = -1;\n        if (this.direction == \"D\") k2 = 1;\n\n        if (!(collideWall)) {\n            this.x = (this.x + k1*this.boxSize) % this.board_x;\n            this.y = (this.y + k2*this.boxSize) % this.board_y;\n        } else {\n            this.x = (this.x + k1*this.boxSize);\n            this.y = (this.y + k2*this.boxSize);\n        }\n\n        var newHead = new Rect(\n            this.x, this.y,\n            this.boxSize, this.boxSize\n        );\n        this.body.unshift(newHead);\n        this.head = this.body[0];\n    }\n\n    deleteTail() {\n        return this.body.pop();\n    }\n\n    addTail(tail) {\n        this.body.push(tail);\n    }\n\n    collideWithBody() {\n        for (var i = 1; i < this.body.length; i++) {\n            var part = this.body[i];\n            if (this.head.collideRect(part)) {\n                return true\n            }\n        }\n        return false;\n    }\n\n    collideWithWall(extraWalls=null) {\n        // normal wall check\n        var wallRect = new Rect(0, 0, this.board_x, this.board_y);\n        if ( !(wallRect.contains([this.x, this.y])) ) {\n            return true;\n        }\n        // extra wall check\n        if (extraWalls == null) return false;\n\n        var bool = false;\n        extraWalls.forEach(part => {\n            if (this.head.collideRect(part)) {\n                bool = true;\n            }\n        });\n        return bool;\n    }\n\n    addHead_snakeTwo(max_width, max_height) {\n        return null;\n    }\n\n    draw(p5) {\n        p5.fill(\"#7ffc03\");\n        for (var i=0; i < this.body.length; i++) {\n            var rect = this.body[i];\n            p5.rect(rect.x, rect.y, this.boxSize, this.boxSize);\n        }\n    }\n}\n\n\nexport class Apple {\n    /*\n    Apple Object for the snake game.\n    Attributes:\n    - boxLength\n    - x\n    - y\n    */\n    constructor(boxLength, x, y, board_x, board_y) {\n        this.boxLength = boxLength;\n        this.x = x;\n        this.y = y;\n        this.board_x = board_x;\n        this.board_y = board_y;\n        this.rect = new Rect(this.x, this.y, this.boxLength, this.boxLength);\n    }\n\n    // avoid: list of (x,y) arrays\n    move(avoid=null) {\n      const avoidCompare = (a, b) => util.arrayEqual(a, b);\n      while (true) {\n          var rand_x = util.getRandInt(0, this.board_x, this.boxLength);\n          var rand_y = util.getRandInt(0, this.board_y, this.boxLength);\n          var inAvoid = util.arrayContains(avoid, [rand_x,rand_y], avoidCompare);\n          if (avoid == null || !(inAvoid)){\n              break;\n          }\n      }\n      // to do construct a more efficient random for large avoid.\n      this.rect = new Rect(rand_x, rand_y, this.boxLength, this.boxLength);\n      this.x = rand_x;\n      this.y = rand_y;\n    }\n\n    draw(p5) {\n        p5.fill('#ff0000');\n        p5.rect(this.x, this.y, this.boxLength, this.boxLength);\n        // p5.rect(0,0,50,50);\n    }\n}\n\n\n// export default {Dummy, Snake, Apple};","/*\n1. stateType:\n  - 0: boolean vector of size 12\n  - 1:\n2.\n*/\n\nimport * as tf from '@tensorflow/tfjs';\n// var tf = require(\"tensorflowjs\");\nimport {Snake, Apple} from \"./snakeClass\";\nimport {colorGrid, Rect} from \"./sprite\"\nimport {generateExtraWalls, getRandInt, arrayEqual, arrayContains, euclidean} from \"./util\";\n\n\nexport class snakeGame {\n    constructor(params) {\n        // defaults\n        this.FPS = 10;\n        this.snakeLength = 3;\n\n        this.collideWall = true;\n        this.collideBody = true;\n        this.extraWalls = null;\n\n        this.manual = true;\n\n        this.stateType = \"12bool\";\n        this.rewardType = \"eat-die-close-away\";\n        this.rewardValues = {\n            eat: 10, die: -100, closer: 1, away: -1\n        };\n\n        for (var key in params) {\n            // Game-side Attributes\n            if (key == \"collideWall\") this.collideWall = params[key];\n            if (key == \"collideBody\") this.collideBody = params[key];\n            if (key == \"extraWalls\") this.extraWalls = params[key];\n\n            if (key == \"FPS\") this.FPS = params[key];\n\n            // Train-side Attributes\n            if (key == \"stateType\") this.stateType = params[key];\n            if (key == \"rewardType\") this.rewardType = params[key];\n            if (key == \"rewardValues\") this.rewardValues = params[key];\n\n            // Game Elements\n            if (key == \"snakeLength\") this.snakeLength = params[key];\n            if (key == \"manual\") this.manual = params[key];\n        }\n\n        // Mandatory\n        this.dpr = 1;\n        this.gridSize = params[\"gridSize\"] * this.dpr;\n        this.width = params[\"width\"] * this.gridSize;\n        this.height = params[\"height\"] * this.gridSize;\n\n        this.extraWalls = generateExtraWalls(this.extraWalls, this.gridSize, true);\n\n        // initialize\n        this.timer = null;\n\n        this.snake = null;\n        this.apple = null;\n\n        this.done = 0;\n        this.score = 0;\n        this.best_score = 0;\n        this.key_pressed = 0;\n\n        this.reset();\n        // this.render(); // now move render() inside reset()\n\n        if (this.manual) {\n            // player mode\n            this.keyboard_events();\n            // this.manual_play();\n        }\n\n        // attributes to compute reward\n        this.last_snake = null;\n        this.last_apple = null;\n        this.rewardMeasures = {\n            eat: 0, closer: 0, away: 0\n        };\n    }\n\n    // STATICS\n    _direction(action){\n      const DIRECTION_ARR = [\"U\",\"R\",\"D\",\"L\"];\n      return DIRECTION_ARR[action];\n    }\n\n    _action(direction){\n      const DIRECTION_ARR = [\"U\",\"R\",\"D\",\"L\"];\n      return DIRECTION_ARR.indexOf(direction);\n    }\n\n    // state space\n    update_state() {\n        if (this.stateType == \"12bool\") {\n            return this.update_state_12bool();\n        }\n    }\n    \n    update_state_12bool() {\n        // return a js array\n        // update state from this.snake and this.apple\n        // called after this.snake and this.apple are updated\n        var new_state = Array(12).fill(0);\n\n        // Direction of Snake\n        if (this.snake.direction == \"U\") {\n            new_state[0] = 1;\n        } else if (this.snake.direction == \"R\") {\n            new_state[1] = 1;\n        } else if (this.snake.direction == \"D\") {\n            new_state[2] = 1;\n        } else if (this.snake.direction == \"L\") {\n            new_state[3] = 1;\n        }\n\n        // Apple position (wrt snake head)\n        // (0,0) at Top-Left Corner: U: -y; R: +x\n        if (this.apple.y < this.snake.y) {\n            // apple north snake\n            new_state[4] = 1\n        }\n        if (this.apple.x > this.snake.x) {\n            // apple east snake\n            new_state[5] = 1\n        }\n        if (this.apple.y > this.snake.y) {\n            // apple south snake\n            new_state[6] = 1\n        }\n        if (this.apple.x < this.snake.x) {\n            // apple west snake\n            new_state[7] = 1\n        }\n\n        // Obstacle (Walls, body) position (wrt snake head)\n        var test_snake;\n        const test_case = {\n            \"U\": {oppo: \"D\", x: 0, y: -this.gridSize, state: 8},\n            \"R\": {oppo: \"L\", x: this.gridSize, y: 0, state: 9},\n            \"D\": {oppo: \"U\", x: 0, y: this.gridSize, state: 10},\n            \"L\": {oppo: \"R\", x: -this.gridSize, y: 0, state: 11}\n        };\n        for (var key in test_case) {\n            var test = test_case[key];\n            if (this.snake.direction != test[\"oppo\"]) {\n                test_snake = new Snake(\n                    this.snake.x + test[\"x\"], this.snake.y + test[\"y\"], \n                    1, \"U\", this.gridSize, this.width, this.height\n                )\n                if (test_snake.collideWithWall(this.extraWalls)) {\n                    new_state[test[\"state\"]] = 1;\n                }\n            }\n        }\n        return tf.tensor2d(new_state, [1,12]);\n    }\n\n    // reward function\n    reward() {\n        if (this.rewardType == \"eat-die-close-away\") {\n            return this.reward_basic();\n        }\n    }\n\n    reward_basic() {\n        const value = this.rewardValues;\n        const check = this.rewardMeasures;\n\n        if (this.done) return value[\"die\"];\n        if (check[\"eat\"]) return value[\"eat\"];\n        if (check[\"closer\"]) return value[\"closer\"];\n        if (check[\"away\"]) return value[\"away\"];\n        return 0;\n    }\n\n    clear_reward() {\n        // reset reward_measures\n        for (var key in this.rewardMeasures) {\n            this.rewardMeasures[key] = 0;\n        }\n    }\n\n    // functions\n    reset() {\n        // return a js array\n        this.done = 0;\n        this.score = 0;\n\n        // initialize snake head\n        var rand_x, rand_y, avoid, inAvoid;\n        const avoidCompare = (a, b) => arrayEqual(a, b);\n        if (this.extraWalls == null) {\n            avoid = null;\n        } else {\n            avoid = this.extraWalls.map(rect => [rect.x, rect.y]);\n        }\n        while (true) {\n            rand_x = getRandInt(5*this.gridSize, this.width-5*this.gridSize, this.gridSize);\n            rand_y = getRandInt(5*this.gridSize, this.width-5*this.gridSize, this.gridSize);\n            inAvoid = arrayContains(avoid, [rand_x,rand_y], avoidCompare);\n            console.log(inAvoid);\n            if (avoid == null || !(inAvoid)){\n                break;\n            }\n        }\n\n        this.snake = new Snake(\n            rand_x, rand_y,\n            this.snakeLength, this._direction(getRandInt(0,4)), this.gridSize,\n            this.width, this.height\n        );\n\n        this.apple = new Apple(this.gridSize, 0, 0, this.width, this.height);\n        this.move_apple();\n\n        // this.render()\n\n        // restart moving\n        if (this.manual) {\n            clearInterval(this.timer);\n            this.manual_play();\n        }\n        \n        // add update_state if used for training\n        return this.update_state();\n    }\n\n    move_apple() {\n        var avoid = this.snake.body.map(part => [part.x, part.y]);\n        if (this.extraWalls != null){\n            var avoid_wall = this.extraWalls.map(part => [part.x, part.y]);\n            avoid = avoid.concat(avoid_wall);\n        }\n        this.apple.move(avoid);\n    }\n\n    update_score() {\n        this.score = this.snake.body.length() - this.snakeLength;\n        return this.score;\n    }\n\n    render() {\n        var context = this.canvas.context;\n        context.clearRect(0,0,this.width,this.height);\n        // snake\n        this.snake.body.forEach((part, i) => {\n            part.draw(context, this.snakeSprite);\n        });\n        // extra wall\n        if (this.extraWalls != null){\n            this.extraWalls.forEach((part, i) => {\n                part.draw(context, this.wallSprite);\n            });\n        }\n        // apple\n        this.apple.rect.draw(context, this.appleSprite);\n    }\n\n    manual_play() {\n        // store value of this\n        var self = this;\n        this.timer = setInterval(function(){\n            self.step();\n            self.key_pressed = 0;\n        }, 1000/this.FPS);\n    }\n\n    end_game() {\n        this.done = 1;\n        if (this.manual) {\n            clearInterval(this.timer);\n            console.log(\"You DIED!\");\n        } else {\n\n        }\n    }\n\n    step(action=null) {\n        if (this.done) return;\n\n        // training purpose: change direction\n        if (!(this.manual) && action != null) {\n            // action: integer in [0, 1, 2, 3]\n            this.snake.changeDirection(action);\n            this.last_snake = this.snake.head;\n            this.last_apple = this.apple.rect;\n        }\n\n        // move\n        this.snake.addHead(this.collideWall);\n\n        // wall collision\n        var tempTail;\n        if (this.snake.collideWithWall(this.extraWalls)) {\n            this.end_game();\n        } else {\n            tempTail = this.snake.deleteTail();\n        }\n        // body collision\n        if (this.snake.collideWithBody()) {\n            this.end_game();\n        }\n        // eat apple\n        if (this.snake.head.collideRect(this.apple.rect)) {\n            // add tail back\n            this.snake.addTail(tempTail);\n            // move apple\n            this.move_apple();\n            // update game values (score)\n            this.score += 1;\n            if (this.score > this.best_score) {\n                this.best_score = this.score;\n            }\n        } else {\n            // no longer needs to deleteTail() because we use another time logic\n            // this.snake.deleteTail();\n        }\n\n        // render\n        // this.render();\n\n        // conclude round\n        if (this.manual) {\n            return null;\n        } else {\n            return this.conclude_step();\n        }\n    }\n\n    conclude_step() {\n        // update eat-apple: 1 if apple moves\n        this.rewardMeasures[\"eat\"] = !(arrayEqual(\n            [this.last_apple.x, this.last_apple.y],\n            [this.apple.rect.x, this.apple.rect.y]\n        ));\n        // update closer or not\n        const last_distance = euclidean(\n            [this.last_snake.x, this.last_snake.y],\n            [this.last_apple.x, this.last_apple.y]\n        );\n        const distance = euclidean(\n            [this.snake.head.x, this.snake.head.y],\n            [this.apple.rect.x, this.apple.rect.y]\n        );\n        this.rewardMeasures[\"closer\"] = distance < last_distance;\n        this.rewardMeasures[\"away\"] = distance > last_distance;\n\n        // leave for future uss (if adding new rewards)\n\n        const next_state = this.update_state();\n        const reward = this.reward();\n        // clear reward measures\n        this.clear_reward();\n\n        return [next_state, reward, this.done, this.score];\n    }\n\n    keyboard_events() {\n        // key control of snake\n        document.body.addEventListener(\"keydown\", (event) => {\n            if (this.done) {\n                console.log(\"Game ended\");\n                return null;\n            }\n            if (this.key_pressed) {\n                console.log(\"key pressed in this round\");\n                return null;\n            } else {\n                this.key_pressed = 1;\n            }\n            const ARROW_ACTION = [\"ArrowUp\", \"ArrowRight\", \"ArrowDown\", \"ArrowLeft\"];\n            const key = ARROW_ACTION.indexOf(event.key);\n\n            this.snake.changeDirection(key);\n        });\n    }\n\n}\n","import * as tf from '@tensorflow/tfjs';\nimport * as util from \"./util\";\n\nclass Deque extends Array {\n    constructor(maxlen) {\n        super();\n        this.maxlen = maxlen;\n    }\n\n    pushDeque(item) {\n        if (this.length >= this.maxlen) this.shift();\n        this.push(item);\n    }\n}\n\nexport class Agent {\n    constructor(params) {\n        // mandatory\n        this.state_size = params[\"state_size\"];\n        this.action_size = params[\"action_size\"];\n        // default\n        this.gamma = 0.95;\n        this.epsilon = 1.0;\n        this.epsilon_decay = 0.995;\n        this.epsilon_min = 0.01;\n        this.learning_rate = 0.00025;\n\n        // load from params\n        for (var key in params) {\n            if (key == \"gamma\") this.gamma = params[key];\n            if (key == \"epsilon\") this.epsilon = params[key];\n            if (key == \"epsilon_decay\") this.epsilon_decay = params[key];\n            if (key == \"epsilon_min\") this.epsilon_min = params[key];\n            if (key == \"learning_rate\") this.learning_rate = params[key];\n        }\n\n        // initialize\n        this.model = this.build_model();\n\n        const maxlen = 2000;\n        this.memory = new Deque(maxlen);\n    }\n\n    /*\n    Note:\n    - the format of inputs is an (inputShape, N) matrix\n      N: number of batches/data\n    - for a 1D input, specify it as a tenser2d and its shape\n      e.g. var input = tf.tensor2d([1,2,3,4],[1,4])\n      shape [1,4]: 1 is the number of instances; 4 is the shape of input\n    */\n    build_model() {\n        const model = tf.sequential();\n        model.add(tf.layers.dense({\n            units: 128, inputShape: [this.state_size], activation: \"relu\"\n        }));\n        model.add(tf.layers.dense({\n            units: 128, activation: \"relu\"\n        }));\n        model.add(tf.layers.dense({\n            units: 128, activation: \"relu\"\n        }));\n        model.add(tf.layers.dense({\n            units: this.action_size, action: \"linear\"\n        }));\n        model.compile({\n            optimizer: tf.train.adam({learningRate: this.learning_rate}),\n            loss: 'meanSquaredError'\n        });\n        return model;\n    }\n\n    remember(state, action, reward, next_state, done){\n        this.memory.pushDeque([state, action, reward, next_state, done]);\n    }\n\n    async act(state) {\n        // state: tenser2d of size [1,state_size]\n        if (Math.random() <= this.epsilon) {\n            var action = util.getRandInt(0, this.action_size);\n        } else {\n            var action = await this.exploit(state);\n        }\n        return new Promise((resolve, reject) => {\n            resolve(action);\n        });\n    }\n\n    async exploit(state) {\n        const pred = await this.model.predict(state).reshape([this.action_size]);\n        const action = await pred.argMax().data();\n\n        return new Promise((resolve, reject) => {\n            // action is an array of size 1 -- [act]\n            resolve(action[0]);\n        });\n    }\n\n    async replay(batch_size=32) {\n        if (this.memory.length < batch_size) {\n            return Promise.resolve();\n        }\n\n        // sample mini-batch\n        const mini_batch = util.random_sample(this.memory, batch_size);\n\n        for (var i = 0; i < mini_batch.length; i++) {\n            // test purpose\n            if (i % 100 == 0) console.log(i);\n\n            var [state, action, reward, next_state, done] = mini_batch[i];\n            // compute target\n            var target = reward;\n            if (!(done)) {\n                const future_value = await this.model.predict(next_state).reshape([this.action_size]);\n                target = reward + this.gamma * future_value.max().dataSync()[0];\n            }\n            var target_state = await this.model.predict(state).reshape([this.action_size]);\n            await target_state.data().then(data => data[action] = target);\n            // train\n            await this.model.fit(state, target_state.reshape([1,this.action_size]), {\"epochs\": 1});\n        }\n        // decrease epsilon\n        if (this.epsilon > this.epsilon_min) {\n            this.epsilon *= this.epsilon_decay;\n        }\n        return new Promise((resolve, reject) => {\n            resolve();\n        });\n    }\n\n    async save_model(fname) {\n        await this.model.save(\"downloads://\" + fname);\n    }\n\n    async load_model(fname) {\n        this.model = await tf.loadLayersModel(\"localstorage://\" + fname);\n    }\n}\n","// import * as tf from '@tensorflow/tfjs-node';\n\n// global variable: array of performance\nvar performanceArray = [[\"episode\", \"score\", \"moves\", \"cumulative reward\"]];\n\nexport async function train(\n    env, agent, params = {\n    batch_size: 32, n_episodes: 50, max_moves: 500, last_episode: 0,\n    exp_replay: true\n    }) {\n    // load parameters\n    const batch_size = params[\"batch_size\"];\n    const n_episodes = params[\"n_episodes\"];\n    const max_moves = params[\"max_moves\"];\n    const last_episode = params[\"last_episode\"];\n    const exp_replay = params[\"exp_replay\"];\n\n    // main\n    var done = 0;\n    for (var e = 1; e <= n_episodes; e++) {\n        // start a new episode\n        var state = env.reset();\n        var cum_reward = 0;\n\n        for (var move = 1; move <= max_moves; move++) {\n            // step forward\n            const action = await agent.act(state);\n            var [next_state, reward, done, score] = env.step(action);\n            agent.remember(state, action, reward, next_state, done);\n            // update state \n            state = next_state;\n            cum_reward += reward;\n            // conclude round\n            if (exp_replay) {\n                await agent.replay(batch_size);\n            }\n            if (done) {\n                if (!(exp_replay)) await agent.replay(batch_size);\n                break;\n            }\n        }\n\n        // training process\n        const processLog = \"progress: {}/{}, score: {}, e: {}, moves: {}/{}\";\n        console.log(processLog.format(\n            e, n_episodes, score, agent.epsilon, move, max_moves\n        ));\n        // save performance\n        performanceArray.push([\n            e + last_episode, score, move, cum_reward\n        ]);\n        // console.log(performanceArray);\n        // save model\n        if (e >= 20 && e % 1 == 0) {\n            // uncomment to download trained models\n            // agent.save_model(\"model_{}\".format(e));\n        }\n    }\n    console.log(\"Training Ended.\")\n    return new Promise((resolve, reject) => {\n        resolve(performanceArray);\n    })\n}\n\n// export async function test_DQN(env, agent, params=None) {\n\n//     // fetch parameters\n//     n_tests = load_params(params, \"n_tests\", 10)\n//     max_moves = load_params(params, \"max_games\", 1000)\n//     FPS = load_params(params, \"FPS\", 10)\n//     verbose = load_params(params, \"verbose\", True)\n\n//     // start testing\n//     done = 0\n\n//     // Save data for performance analysis\n//     // each row is one instance: [reward, score, move]\n//     performance = np.zeros((n_tests, 3))\n\n//     for e in range(n_tests):\n\n//         // Step 1: Initialization\n//         state = env.reset()\n//         cum_reward = 0\n\n//         // Step 2: Simulate one trial of the game\n//         for move in range(max_moves):\n//             // action\n//             action = agent.exploit(state)\n//             // step forward\n//             next_state, reward, done, score = env.step(action)\n//             // conclude round\n//             state = next_state\n//             cum_reward += reward    // (this will always -100pt upon dead)\n//             if (done) {\n//                 break\n//             }\n\n//         // Step 3: Update performance\n//         performance[e,:] = [cum_reward, score, move]\n\n//     return performance\n// }\n\nexport default train;","import Sprite from \"./sprite\"\n\nexport const CANVAS_WIDTH = 20;\nexport const CANVAS_HEIGHT = 20;\nexport const GRID_SIZE = 20;\n\nexport const MANUAL_FPS = 3;\nexport const TEST_FPS = 10;\n\nexport const SNAKE_LENGTH = 1;\n\nexport const COLLIDE_WALL = true;\nexport const COLLIDE_BODY = true;\nexport const EXTRA_WALL = [\n    // [6,7], [7,7], [8,7], [7,6], [7,8],\n];\nfor (var row = 10; row <= 11; row++) {\n    for (var col = 6; col <= 15; col++) {\n        EXTRA_WALL.push([col, row]);\n    }\n}\n// export const WALL_PIX_POS = true; // assume to be always true\n\nexport const MANUAL = true;\n\nexport const STATE_TYPE = \"12bool\";\nexport const REWARD_TYPE = \"basic\";\n\nexport const snakeSprite = new Sprite(\"image/skin_1.png\");\nexport const appleSprite = new Sprite(\"image/star.png\");\nexport const wallSprite = new Sprite(\"image/tile.png\");\n","import {snakeGame} from \"./snakeGameClass\";\nimport {Agent} from \"./agentClass\";\nimport {train} from \"./train.js\";\nimport React from \"react\";\nimport Sketch from 'react-p5';\nimport \"p5\";\nimport {\n    CANVAS_WIDTH, CANVAS_HEIGHT, GRID_SIZE, \n    MANUAL_FPS, TEST_FPS, SNAKE_LENGTH,\n    COLLIDE_WALL, COLLIDE_BODY, EXTRA_WALL,\n    MANUAL,\n    STATE_TYPE, REWARD_TYPE\n} from \"./config\";\nimport * as util from \"./util\";\n\nfunction SnakeEnv(props) {\n    // resize parameters\n\n    // screen\n    var screen_width = props.dimension[0];\n    var screen_height = props.dimension[1];\n    var adaptive_grid_size = Math.min(\n        Math.floor(screen_width/CANVAS_WIDTH), Math.floor(screen_height/CANVAS_HEIGHT)\n    );\n    var screen_size = Math.min(screen_width, screen_height);\n    // score text\n    var text_size = Math.round(0.06*screen_size);\n    // restart button\n    var button_radius = Math.round(0.05*screen_width);\n    var button_x = Math.round(0.9*screen_size);\n    var button_y = Math.round(0.1*screen_size);\n\n    // variables\n\n    const env_params = {\n        width: CANVAS_WIDTH, height: CANVAS_HEIGHT, \n        gridSize: adaptive_grid_size, \n        FPS: MANUAL_FPS,\n        snakeLength: SNAKE_LENGTH, \n        extraWalls: EXTRA_WALL,\n        stateType: STATE_TYPE, rewardType: REWARD_TYPE,\n        manual: props.doManual\n    };\n\n    const agent_params  = {\n        state_size: 12, action_size: 4 \n    };\n\n    let game = new snakeGame(env_params);\n    let agent = new Agent(agent_params);\n\n    let img_restart;\n\n    const setup = (p5, canvasParentRef) => {\n        // use parent to render the canvas in this ref\n        // (without that p5 will render the canvas outside of your component)\n        var cnv = p5.createCanvas(screen_size, screen_size).parent(canvasParentRef);\n        cnv.position(\n            (screen_width - screen_size)/2, (screen_height - screen_size)/2\n        );\n\n        // train / test the model\n        if (props.doTrain) {\n            // alert(\"starting training\");\n            const train_params = {\n                batch_size: 512, n_episodes: 100,\n                max_moves: 1000, last_episode: 0,\n                exp_replay: true\n            };\n            train(game, agent, train_params);\n        }\n    };\n \n    const draw = (p5) => {\n        p5.background(220);\n        // p5.ellipse(50,50,80,80);\n\n        // plot snake and apple\n        p5.stroke(0, 0, 0);\n        game.snake.draw(p5);\n        game.apple.draw(p5);\n\n        // plot extra walls\n        p5.stroke(0, 0, 0);\n        p5.fill(\"#999999\");\n        for (var i=0; i < game.extraWalls.length; i++) {\n            var rect = game.extraWalls[i];\n            p5.rect(rect.x, rect.y, game.gridSize, game.gridSize);\n        }\n\n        // draw a restart button\n        p5.stroke(255,0,0);\n        p5.fill(255, 0, 0, 200);\n        p5.ellipse(button_x, button_y, button_radius, button_radius);\n\n        p5.mouseClicked = () => {\n            if (util.euclidean([p5.mouseX, p5.mouseY], [button_x, button_y]) <= 0.8*button_radius){\n                game.reset();\n            }\n        };\n\n        // draw score\n        p5.stroke(0,0,0,0);\n        p5.fill(\"#000000\");\n        p5.textSize(text_size);\n        p5.text(\"Score: \" + game.score, 0.5*text_size, text_size);\n        p5.text(\"Best Score: \" + game.best_score, 0.5*text_size, 2*text_size);\n\n    };\n\n    if (props.doTest) {\n        return null;\n    }\n\n    return (\n        <div id=\"snake_div\">\n            <Sketch setup={setup} draw={draw} />\n        </div>\n    );\n}\n\nexport default SnakeEnv;","import React, { useRef, useEffect, useState, useLayoutEffect } from 'react';\nimport css from './Genetic.module.css';\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Link\n} from \"react-router-dom\";\n\nimport Pong from '../games/pong/Pong';\nimport SnakeEnv from '../games/snake/SnakeEnv';\n// import Game from './Game'\n\nfunction Genetic(props) {\n    const gameParentRef = useRef(null);\n    const plotParentRef = useRef(null);\n    const [gameScreenDimension, setGameScreenDimension] = useState({width: 0, height: 0});\n    const [plotScreenDimension, setPlotScreenDimension] = useState({width: 0, height: 0});\n\n    useEffect ( () => {\n        if (gameParentRef.current) {\n            setGameScreenDimension({\n                width: gameParentRef.current.offsetWidth,\n                height: gameParentRef.current.offsetHeight\n            });\n        }\n        if (plotParentRef.current) {\n            setPlotScreenDimension({\n                width: plotParentRef.current.offsetWidth,\n                height: plotParentRef.current.offsetHeight\n            });\n        }\n    }, [gameParentRef, plotParentRef]);\n\n    return (\n        <Router basename={process.env.PUBLIC_URL}>\n            <div className={css.container}>\n                <h1 className={css.name} onClick={()=>{props.history.push(process.env.PUBLIC_URL+'/')}}>\n                    <Link to='/' className={css.text}>\n                        AlphaGame\n                    </Link>\n                </h1>\n                <div className={css.background}>\n                    <div className={css.gameScreen} ref={gameParentRef}>\n                        <Switch>\n                            <Route path='/snake'>\n                                Snake\n                            </Route>\n                            <Route path='/pong'>\n                                {\n                                    gameScreenDimension.width === 0 ?\n                                    <div></div> : <Pong dimension={[gameScreenDimension.width, gameScreenDimension.height]}/>\n                                }\n                            </Route>\n                            <Route path='/flappybird'>\n                                flappybird\n                            </Route>\n                        </Switch>\n                    </div>\n                    <div className={css.plotScreen} ref={plotParentRef}>\n                        <Switch>\n                            <Route path='/snake'>\n                                snake\n                            </Route>\n                            <Route path='/pong'>\n                                pong\n                            </Route>\n                            <Route path='/flappybird'>\n                                flappybird\n                            </Route>\n                        </Switch>\n                    </div>\n                </div>\n            </div>\n            <footer className={css.footer}>\n                Copyright  2020 AlphaGame | \n                <a href='https://github.com/Alexduanran/AlphaGame' target='_blank' style={{textDecoration: 'none', color:'white'}}> Github</a>\n            </footer>\n        </Router>\n    );\n}\n\nexport default Genetic;\n","export default __webpack_public_path__ + \"static/media/snake.c6bcedf4.png\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/flappybird.31b09d32.png\";","export default __webpack_public_path__ + \"static/media/home2_gif.f51dd1b0.gif\";","export default __webpack_public_path__ + \"static/media/snake_gif.61188676.gif\";","export default __webpack_public_path__ + \"static/media/pong_gif.34e92973.gif\";","export default __webpack_public_path__ + \"static/media/flappybird_gif.87071256.gif\";","import React, {useState} from 'react';\nimport css from './Home.module.css';\nimport Genetic from './Genetic'\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Link\n} from \"react-router-dom\";\nimport { Swiper, SwiperSlide } from 'swiper/react';\nimport SwiperCore, { Pagination, Mousewheel, EffectCoverflow } from 'swiper';\nimport 'swiper/swiper.scss';\nimport 'swiper/components/navigation/navigation.scss';\nimport 'swiper/components/pagination/pagination.scss';\nimport 'swiper/components/scrollbar/scrollbar.scss';\nimport 'swiper/components/effect-coverflow/effect-coverflow.scss';\nimport snake_png from '../media/snake.png';\nimport pong_png from '../media/pong.png';\nimport flappybird_png from '../media/flappybird.png';\nimport home2_gif from '../media/home2_gif.gif';\nimport snake_gif from '../media/snake_gif.gif';\nimport pong_gif from '../media/pong_gif.gif';\nimport flappybird_gif from '../media/flappybird_gif.gif';\n\nfunction Home(props) {\n    const [background, setBackground] = useState(home2_gif);\n    const [swipeIndex, setSwipeIndex] = useState(0);\n\n    SwiperCore.use([EffectCoverflow, Pagination, Mousewheel]);\n\n    function GameSwiper() {\n        setBackground(home2_gif);\n        return (\n            <Swiper className={css.swiperContainer}\n                    effect='coverflow'\n                    spaceBetween={30}\n                    slidesPerView={3}\n                    dynamicBullets={true}\n                    mousewheel={true}\n                    pagination={{ clickable: true }}\n                    centeredSlides={true}\n                    loop={true}\n                    initialSlide={swipeIndex}\n                    >\n                <SwiperSlide>\n                    <Link to='/snake'>\n                        <div className={css.square} style={{backgroundImage:`url(${snake_png})`}} />    \n                    </Link>\n                </SwiperSlide>\n                <SwiperSlide>\n                    <Link to='/pong'> \n                        <div className={css.square} style={{backgroundImage:`url(${pong_png})`}} />\n                    </Link>\n                </SwiperSlide>\n                <SwiperSlide>\n                    <Link to='/flappybird'>\n                        <div className={css.square} style={{backgroundImage:`url(${flappybird_png})`}} />\n                    </Link>\n                </SwiperSlide>\n            </Swiper>\n        )\n    }\n\n    function GameModes(prop) {\n        var image = null;\n        if (prop.name === 'snake') {\n            setBackground(snake_gif);\n            setSwipeIndex(0);\n            image = snake_png;\n        }\n        else if (prop.name === 'pong') {\n            setBackground(pong_gif);\n            setSwipeIndex(1);\n            image = pong_png;\n        }\n        else if (prop.name === 'flappybird') {\n            setBackground(flappybird_gif);\n            setSwipeIndex(2);\n            image = flappybird_png;\n        }\n        return (\n            <div className={css.grid}>\n                <div className={css.smallpic} style={{backgroundImage:`url(${image})`}} />\n                <div className={css.smallsquare} onClick={()=>{console.log(process.env.PUBLIC_URL);props.history.push(process.env.PUBLIC_URL + '/' + prop.name + '/genetic')}} >\n                    <h1 className={css.mode}>\n                        Genetic\n                        Algorithm\n                    </h1>\n                </div>\n                <div className={css.smallsquare} onClick={()=>{props.history.push(process.env.PUBLIC_URL + '/' + prop.name + '/reinforcement')}} >\n                    <h1 className={css.mode}>\n                        Reinforce-\n                        ment\n                        Learning\n                    </h1>\n                </div>\n                <div className={css.smallsquare} onClick={()=>{props.history.push(process.env.PUBLIC_URL + '/' + prop.name + '/battle')}} >\n                    <h1 className={css.mode}>\n                        Human\n                        vs.\n                        AI\n                    </h1>\n                </div>\n            </div>\n        )\n    }\n\n    return (\n        <Router basename={process.env.PUBLIC_URL}>\n            <div className={css.container}>\n                <h1 className={css.name}>\n                    <Link to='/' className={css.text}>\n                        AlphaGame\n                    </Link>\n                </h1>\n                <div className={css.background}>\n                    <div className={css.screen} style={{backgroundImage:`url(${background})`}}>\n                        <Switch>\n                            <Route path='/snake' >\n                                <GameModes name={'snake'} />\n                            </Route>\n                            <Route path='/pong'>\n                                <GameModes name={'pong'} />\n                            </Route>\n                            <Route path='/flappybird'>\n                                <GameModes name={'flappybird'} />\n                            </Route>\n                            <Route path='/'>\n                                <GameSwiper className={css.swiper}/>\n                            </Route>\n                        </Switch>\n                    </div>\n                </div>\n            </div>\n            <footer className={css.footer}>\n                Copyright  2020 AlphaGame | \n                <a href='https://github.com/Alexduanran/AlphaGame' target='_blank' style={{textDecoration: 'none', color:'white'}}> Github</a>\n            </footer>\n        </Router>\n    );\n    }\n\nexport default Home;\n","import React, { useRef, useEffect, useState, useLayoutEffect } from 'react';\nimport css from './Reinforcement.module.css';\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Link\n} from \"react-router-dom\";\n\nimport SnakeEnv from \"../games/snake/SnakeEnv\"\n\nfunction Reinforcement(props) {\n\n    const gameParentRef = useRef(null);\n    const plotParentRef = useRef(null);\n    const [gameScreenDimension, setGameScreenDimension] = useState({width: 0, height: 0});\n    const [plotScreenDimension, setPlotScreenDimension] = useState({width: 0, height: 0});\n\n    useEffect ( () => {\n        if (gameParentRef.current) {\n            setGameScreenDimension({\n                width: gameParentRef.current.offsetWidth,\n                height: gameParentRef.current.offsetHeight\n            });\n        }\n        if (plotParentRef.current) {\n            setPlotScreenDimension({\n                width: plotParentRef.current.offsetWidth,\n                height: plotParentRef.current.offsetHeight\n            });\n        }\n    }, [gameParentRef, plotParentRef]);\n    return (\n        <Router basename={process.env.PUBLIC_URL}>\n            <div className={css.container}>\n                <h1 className={css.name} onClick={()=>{props.history.push(process.env.PUBLIC_URL+'/')}}>\n                    <Link to='/' className={css.text}>\n                        AlphaGame\n                    </Link>\n                </h1>\n                <div className={css.background}>\n                    <div className={css.gameScreen} ref={gameParentRef}>\n                        <Switch>\n                            <Route path='/snake'>\n                                {/* define env_params as a props.attribute if necessary */}\n                                {\n                                    gameScreenDimension.width === 0 ?\n                                    <div></div> : <SnakeEnv \n                                        doManual={false} \n                                        doTrain={true} \n                                        doTest={false} \n                                        dimension={[gameScreenDimension.width, gameScreenDimension.height]}\n                                    />\n                                }\n                            </Route>\n                            <Route path='/pong'>\n                                pong\n                            </Route>\n                            <Route path='/flappybird'>\n                                flappybird\n                            </Route>\n                        </Switch>\n                    </div>\n                    <div className={css.plotScreen} ref={plotParentRef}>\n                        <Switch>\n                            <Route path='/snake'>\n                                snake\n                            </Route>\n                            <Route path='/pong'>\n                                pong\n                            </Route>\n                            <Route path='/flappybird'>\n                                flappybird\n                            </Route>\n                        </Switch>\n                    </div>\n                </div>\n            </div>\n            <footer className={css.footer}>\n                Copyright  2020 AlphaGame | \n                <a href='https://github.com/Alexduanran/AlphaGame' target='_blank' style={{textDecoration: 'none', color:'white'}}> Github</a>\n            </footer>\n        </Router>\n    );\n}\n\nexport default Reinforcement;\n","import css from './Battle.module.css';\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Link\n} from \"react-router-dom\";\n\nfunction Battle(props) {\n  return (\n    <Router basename={process.env.PUBLIC_URL}>\n        <div className={css.container}>\n            <h1 className={css.name} onClick={()=>{props.history.push(process.env.PUBLIC_URL+'/')}}>\n                <Link to='/' className={css.text}>\n                    AlphaGame\n                </Link>\n            </h1>\n            <div className={css.background}>\n                <div className={css.gameScreen}>\n                    <Switch>\n                        <Route path='/snake'>\n                            snake\n                        </Route>\n                        <Route path='/pong'>\n                            pong\n                        </Route>\n                        <Route path='/flappybird'>\n                            flappybird\n                        </Route>\n                    </Switch>\n                </div>\n                <div className={css.plotScreen}>\n                    <Switch>\n                        <Route path='/snake'>\n                            {/* {\n                                gameScreenDimension.width === 0 ?\n                                <div></div> : \n                                <SnakeEnv dimension={[gameScreenDimension.width, gameScreenDimension.height]}/>\n                            } */}\n                        </Route>\n                        <Route path='/pong'>\n                            pong\n                        </Route>\n                        <Route path='/flappybird'>\n                            flappybird\n                        </Route>\n                    </Switch>\n                </div>\n            </div>\n        </div>\n        <footer className={css.footer}>\n            Copyright  2020 AlphaGame | \n            <a href='https://github.com/Alexduanran/AlphaGame' target='_blank' style={{textDecoration: 'none', color:'white'}}> Github</a>\n        </footer>\n    </Router>\n  );\n}\n\nexport default Battle;\n","import css from './App.module.css';\nimport Home from './Home';\nimport Genetic from './Genetic';\nimport Reinforcement from './Reinforcement';\nimport Battle from './Battle';\nimport {\n  Router,\n  Switch,\n  Route,\n  Link\n} from \"react-router-dom\";\nimport { createBrowserHistory } from 'history';\n\nconst history = createBrowserHistory();\n\nfunction App() {\n  return (\n    <div className={css.background}>\n      <Router history={history} basename={process.env.PUBLIC_URL}>\n        <Switch>\n          <Route path='/*/genetic'>\n            <Genetic history={history}/>\n          </Route>\n          <Route path='/*/reinforcement'>\n            <Reinforcement history={history}/>\n          </Route>\n          <Route path='*/battle'>\n            <Battle history={history}/>\n          </Route>\n          <Route path='/'>\n            <Home history={history}/>\n          </Route>\n        </Switch>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './pages/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"Home_background__3HbSX\",\"container\":\"Home_container__-DMjm\",\"footer\":\"Home_footer__1mMr8\",\"grid\":\"Home_grid__33I0i\",\"mode\":\"Home_mode__2BOJe\",\"name\":\"Home_name__10Kwj\",\"smallpic\":\"Home_smallpic__3N7EV\",\"smallsquare\":\"Home_smallsquare__1oBA_\",\"screen\":\"Home_screen__3rdgN\",\"square\":\"Home_square__l604N\",\"swiper\":\"Home_swiper__33oto\",\"swiperContainer\":\"Home_swiperContainer__1LfR4\",\"text\":\"Home_text__3zRIA\"};"],"sourceRoot":""}