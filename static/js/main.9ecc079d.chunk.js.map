{"version":3,"sources":["pages/Genetic.module.css","pages/Reinforcement.module.css","pages/Battle.module.css","pages/App.module.css","pages/GeneticParams.js","games/genetic_algorithm/individual.js","games/pong/neural_network.js","games/pong/Paddle.js","games/pong/Ball.js","games/pong/settings.js","games/genetic_algorithm/population.js","games/genetic_algorithm/selection.js","games/genetic_algorithm/mutation.js","games/genetic_algorithm/crossover.js","games/pong/Pong.js","games/snake/sprite.js","games/snake/util.js","games/snake/snakeClass.js","games/snake/snakeGameClass.js","games/snake/agentClass.js","games/snake/train.js","games/snake/config.js","games/snake/SnakeEnv.js","pages/Genetic.js","media/snake.png","media/pong.png","media/flappybird.png","media/home2_gif.gif","media/snake_gif.gif","media/pong_gif.gif","media/flappybird_gif.gif","pages/Home.js","pages/Reinforcement.js","pages/Battle.js","pages/App.js","reportWebVitals.js","index.js","pages/Home.module.css"],"names":["module","exports","GeneticParams","props","useState","numLayer","setNumLayer","hiddenLayerArchitecture","setHiddenLayerArchitecture","mutationRate","setMutationRate","mutationRateType","setMutationRateType","numParents","setNumParents","numOffsprings","setNumOffsprings","style","position","top","width","Form","Group","as","Row","Label","column","sm","color","left","Col","right","InputGroup","Prepend","Button","backgroundColor","borderColor","onClick","Array","map","value","index","FormControl","placeholder","toString","defaultValue","onChange","e","layers","Number","target","Append","OverlayTrigger","overlay","Tooltip","cursor","ButtonGroup","class","size","updateStart","updateSettings","Individual","nj","require","random","sigmoid","x","exp","tanh","relu","arr","i","push","linear","FeedForwardNetwork","layer_nodes","hidden_activation","output_activation","init_method","feed_forward","X","A_prev","L","length","W","b","Z","l","params","dot","add","array","tolist","out","this","inputs","Error","arrW","j","uniform","arrb","get_activation_by_name","name","activations","func","toLowerCase","console","assert","Paddle","p5","xPaddle","yPaddle","ySpeed","boardSize","chromosome","hidden_layer_architecture","fitness","calculate_fitness","hit","Math","min","distance_travelled","ball_travelled","board_size","distance_to_ball","max","reset","is_alive","update","ball","network","yBall","move","abs","draw","winner","champion","fill","rect","num_inputs","network_architecture","Ball","xBall","xSpeed","paddle","xLast","yLast","ellipse","settings","Population","individuals","num_individuals","num_individuals_","num_genes","shape","num_genes_","average_fitness","sum","average_fitness_","fittest_individual","best","indi","individual","fittest_individual_","get_fitness_std","std","a","roulette_wheel_selection","population","selection","wheel","pick","float","current","gaussian_mutation","prob_mutation","scale","mu","sigma","mutation_array","normal","set","get","simulated_binary_crossover","parent1","parent2","eta","rand","gamma","zeros","multiply","ones","subtract","single_point_binary_crossover","offspring1","copy","offspring2","Pong","cumulativeSum","_mutation_bins","_crossover_bins","_SPBX_type","_SBX_eta","_mutation_rate","_next_gen_size","lower","format","dimension","balls","current_generation","winner_index","champion_index","champion_fitness","NEGATIVE_INFINITY","num_hit","best_hit","training_paddle","newball","next_generation","indexOf","log","sort","reverse","slice","elitism_selection","shuffle","next_pop","p1","p2","c1_params","c2_params","c1_W_l","c2_W_l","c1_b_l","c2_b_l","p1_W_l","p2_W_l","p1_b_l","p2_b_l","_crossover","_mutation","c1","c2","parent1_weights","parent2_weights","parent1_bias","parent2_bias","rand_crossover","crossover_bucket","child1_weights","child2_weights","child1_bias","child2_bias","SBX","rand_mutation","mutation_bucket","mutation_rate","sqrt","temporaryValue","randomIndex","currentIndex","floor","setup","canvasParentRef","createCanvas","parent","button","createButton","mousePressed","background","textSize","text","bally","int","speedy","still_alive","Rect","y","w","h","context","sprite","point","overlap","contains","Sprite","fname","PI","image","undefined","Image","src","ctx","drawImage","rotate","angle","save","dpr","translate","TO_RADIAN","height","restore","getRandInt","step","ceil","arrayEqual","compare","arrayContains","obj","boo","forEach","item","euclidean","x1","y1","x2","y2","random_sample","batch_size","array_copy","sample","rand_idx","splice","String","prototype","args","arguments","replace","Snake","direction","boxSize","board_x","board_y","body","initialize","head","k1","k2","tempRect","DIRECTION","collideWall","newHead","unshift","pop","tail","part","collideRect","extraWalls","wallRect","bool","max_width","max_height","Apple","boxLength","avoid","avoidCompare","util","rand_x","rand_y","inAvoid","snakeGame","key","FPS","snakeLength","collideBody","manual","stateType","rewardType","rewardValues","eat","die","closer","away","gridSize","array2d","pix","walls","generateExtraWalls","timer","snake","apple","done","score","best_score","key_pressed","keyboard_events","last_snake","last_apple","rewardMeasures","action","update_state_12bool","new_state","test_case","oppo","state","test","collideWithWall","tf","reward_basic","check","_direction","move_apple","clearInterval","manual_play","update_state","avoid_wall","concat","canvas","clearRect","snakeSprite","wallSprite","appleSprite","self","setInterval","tempTail","changeDirection","addHead","end_game","deleteTail","collideWithBody","addTail","conclude_step","last_distance","distance","next_state","reward","clear_reward","document","addEventListener","event","Deque","maxlen","shift","Agent","state_size","action_size","epsilon","epsilon_decay","epsilon_min","learning_rate","model","build_model","memory","dense","units","inputShape","activation","compile","optimizer","adam","learningRate","loss","pushDeque","exploit","Promise","resolve","reject","predict","reshape","pred","argMax","data","mini_batch","future_value","dataSync","target_state","then","fit","performanceArray","train","env","agent","n_episodes","max_moves","last_episode","exp_replay","cum_reward","act","remember","replay","processLog","EXTRA_WALL","row","col","SnakeEnv","screen_width","screen_height","adaptive_grid_size","screen_size","text_size","round","button_radius","button_x","button_y","env_params","doManual","game","doTest","id","doTrain","stroke","mouseClicked","mouseX","mouseY","Genetic","gameParentRef","useRef","plotParentRef","gameScreenDimension","setGameScreenDimension","setPlotScreenDimension","setSettings","start","setStart","useEffect","offsetWidth","offsetHeight","basename","process","className","css","container","history","to","gameScreen","ref","path","plotScreen","href","textDecoration","Home","home2_gif","setBackground","swipeIndex","setSwipeIndex","GameSwiper","swiperContainer","effect","spaceBetween","slidesPerView","dynamicBullets","mousewheel","pagination","clickable","centeredSlides","loop","initialSlide","square","backgroundImage","snake_png","pong_png","flappybird_png","GameModes","prop","snake_gif","pong_gif","flappybird_gif","grid","smallpic","smallsquare","mode","SwiperCore","use","EffectCoverflow","Pagination","Mousewheel","screen","swiper","Reinforcement","Battle","createBrowserHistory","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.9ecc079d.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"Genetic_background__zkABP\",\"container\":\"Genetic_container__3BPBj\",\"gameScreen\":\"Genetic_gameScreen__3qtyt\",\"name\":\"Genetic_name__vF0vp\",\"text\":\"Genetic_text__1bC0W\",\"plotScreen\":\"Genetic_plotScreen__3dRxY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"Reinforcement_background__1Bv23\",\"container\":\"Reinforcement_container__3LXxV\",\"gameScreen\":\"Reinforcement_gameScreen__1ndi4\",\"name\":\"Reinforcement_name__TAEiF\",\"text\":\"Reinforcement_text__9Aprn\",\"plotScreen\":\"Reinforcement_plotScreen__3DOwi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"Battle_background__2bwgt\",\"container\":\"Battle_container__3Hpn_\",\"gameScreen\":\"Battle_gameScreen__1hthJ\",\"name\":\"Battle_name__EcAiI\",\"text\":\"Battle_text__34_Jy\",\"plotScreen\":\"Battle_plotScreen__6ZSH0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"App_background__3GJc-\"};","import React, { useState } from 'react';\nimport { Form, FormControl, InputGroup, Button, ButtonGroup, Tooltip, OverlayTrigger, Row, Col } from 'react-bootstrap';\n\nfunction GeneticParams(props) {\n    const [numLayer, setNumLayer] = useState(2);\n    const [hiddenLayerArchitecture, setHiddenLayerArchitecture] = useState([12, 6]);\n    const [mutationRate, setMutationRate] = useState(0.5);\n    const [mutationRateType, setMutationRateType] = useState('static');\n    const [numParents, setNumParents] = useState(50);\n    const [numOffsprings, setNumOffsprings] = useState(100);\n\n    return (\n        <div style={{position:'absolute', top:'2.5%', width:'100%'}}>\n            <Form>\n                <Form.Group as={Row}>\n                    <Form.Label column sm='5' style={{color:'white', left:'4%'}}>\n                        Hidden Layer Architecture\n                    </Form.Label>\n                    <Col style={{right:'4%'}}>\n                        <InputGroup>\n                            <InputGroup.Prepend>\n                                <Button style={{backgroundColor:'blueviolet', borderColor:'blueviolet'}} onClick={()=>setNumLayer(numLayer == 1 ? 1 : numLayer-1)}>\n                                    -\n                                </Button>\n                                <Button style={{backgroundColor:'blueviolet', borderColor:'blueviolet'}} onClick={()=>setNumLayer(numLayer == 3 ? 3 : numLayer+1)}>\n                                    +\n                                </Button>\n                            </InputGroup.Prepend>\n                            {\n                                [...Array(numLayer)].map((value, index) => {\n                                    return <FormControl placeholder={'layer'+(index+1).toString()} key={index} defaultValue={hiddenLayerArchitecture[index]}\n                                            // style={{width}}\n                                            onChange={e => {\n                                                var layers = hiddenLayerArchitecture;\n                                                layers[index] = Number(e.target.value);\n                                                setHiddenLayerArchitecture(layers);\n                                            }}/>\n                                })\n                            }\n                            <InputGroup.Append>\n                                <OverlayTrigger overlay={<Tooltip>Enter the number of nodes in each layer</Tooltip>}>\n                                    <Button style={{backgroundColor:'blueviolet', borderColor:'blueviolet', cursor:'default'}}>\n                                        &#9432;\n                                    </Button>\n                                </OverlayTrigger>\n                            </InputGroup.Append>\n                        </InputGroup>               \n                    </Col>\n                </Form.Group>\n                <Form.Group as={Row}>\n                    <Form.Label column sm='5' style={{color:'white', left:'4%'}}>\n                        Mutation Rate\n                    </Form.Label>\n                    <Col style={{right:'4%'}}>\n                        <InputGroup>\n                            <FormControl defaultValue={mutationRate} onChange={e => setMutationRate(Number(e.target.value))}/>\n                            <InputGroup.Append>\n                                <OverlayTrigger overlay={<Tooltip>Enter the number of nodes in each layer</Tooltip>}>\n                                    <Button style={{backgroundColor:'blueviolet', borderColor:'blueviolet', cursor:'default'}}>\n                                        &#9432;\n                                    </Button>\n                                </OverlayTrigger>\n                            </InputGroup.Append>\n                        </InputGroup>\n                    </Col>\n                </Form.Group>\n                <Form.Group as={Row}>\n                    <Form.Label column sm='5' style={{color:'white', left:'4%'}}>\n                        Mutation Rate Type\n                    </Form.Label>\n                    <Col style={{right:'4%'}}>\n                        <ButtonGroup>\n                            <Button style={{backgroundColor:mutationRateType==='static' ? '#6918b4' : 'blueviolet', borderColor:'blueviolet'}} onClick={()=>setMutationRateType('static')}>Static</Button>\n                            <Button style={{backgroundColor:mutationRateType==='decay' ? '#6918b4' : 'blueviolet', borderColor:'blueviolet'}} onClick={()=>setMutationRateType('decay')}>Decay</Button>\n                        </ButtonGroup>\n                    </Col>\n                    <Col style={{left:'13.2%'}}>\n                        <OverlayTrigger overlay={<Tooltip >\n                                                    Static: Mutation rate stays the same throughout generations <br />\n                                                    Decay: Mutation rate decreases as generation increasesr\n                                                </Tooltip>}>\n                            <Button style={{backgroundColor:'blueviolet', borderColor:'blueviolet', cursor:'default'}}>\n                                &#9432;\n                            </Button>\n                        </OverlayTrigger>\n                    </Col>\n                </Form.Group>\n                <Form.Group as={Row}>\n                    <Form.Label column sm='5' style={{color:'white', left:'4%'}}>\n                        Number of Parents\n                    </Form.Label>\n                    <Col style={{right:'4%'}}>\n                        <InputGroup>\n                            <FormControl defaultValue={numParents} onChange={e => setNumParents(Number(e.target.value))}/>\n                            <InputGroup.Append>\n                                <OverlayTrigger overlay={<Tooltip>Enter the number of parents to generate offsprings</Tooltip>}>\n                                    <Button style={{backgroundColor:'blueviolet', borderColor:'blueviolet', cursor:'default'}}>\n                                        &#9432;\n                                    </Button>\n                                </OverlayTrigger>\n                            </InputGroup.Append>\n                        </InputGroup>\n                    </Col>\n                </Form.Group>\n                <Form.Group as={Row}>\n                    <Form.Label column sm='5' style={{color:'white', left:'4%'}}>\n                        Number of Offsprings\n                    </Form.Label>\n                    <Col style={{right:'4%'}}>\n                        <InputGroup>\n                            <FormControl defaultValue={numOffsprings} onChange={e => setNumOffsprings(Number(e.target.value))}/>\n                            <InputGroup.Append>\n                                <OverlayTrigger overlay={<Tooltip>Enter the number of offsprings to be generated by parents</Tooltip>}>\n                                    <Button style={{backgroundColor:'blueviolet', borderColor:'blueviolet', cursor:'default'}}>\n                                        &#9432;\n                                    </Button>\n                                </OverlayTrigger>\n                            </InputGroup.Append>\n                        </InputGroup>\n                    </Col>\n                </Form.Group>\n                <div class='text-center'>\n                    <Button size='lg' \n                            style={{width:'30%', backgroundColor:'blueviolet', borderColor:'blueviolet'}}\n                            onClick={()=>{\n                                        props.updateStart();\n                                        props.updateSettings(hiddenLayerArchitecture,mutationRate,mutationRateType,numParents,numOffsprings);\n                                    }}>\n                        Start \n                    </Button>\n                </div>\n            </Form>\n        </div>\n    )\n}\n\nexport default GeneticParams;","function Individual() {\n    const calculate = () => {\n        throw new Error('calculate_fitness function must be defined');\n    }\n\n    const fitness = () => {\n        throw new Error('fitness property must be defined');\n    }\n\n    const fitness_ = () => {\n        throw new Error('fitness property cannot be set. Use calculate_fitness instead');\n    }\n\n    const encode_chromosome = () => {\n        throw new Error('encode_chromosome function must be defined');\n    }\n\n    const decode_chromosome = () => {\n        throw new Error('decode_chromosome function must be defined');\n    }\n\n    const chromosome = () => {\n        throw new Error('chromosome property must be defined');\n    }\n\n    const chromosome_ = (val) => {\n        throw new Error('chromosome property cannot be set.');\n    }\n}\n\nexport default Individual;","var nj = require('@aas395/numjs');\nconst random = require('random');\n\nexport const sigmoid = x => {return 1.0 / (1.0 + nj.exp(-x))};\nexport const tanh = x => {return nj.tanh(x)};\nexport const relu = x => {\n    var arr = [];\n    for (var i of x) {\n        if (i >= 0)\n            arr.push(i);\n        else\n            arr.push([0]);\n    }\n    return arr;\n};\nexport const linear = x => x;\n\nexport class FeedForwardNetwork {\n    constructor(layer_nodes, hidden_activation, output_activation, init_method='uniform', seed=null) {\n        this.params = {};\n        this.layer_nodes = layer_nodes;\n        this.hidden_activation = hidden_activation;\n        this.output_activation = output_activation;\n        this.inputs = null;\n        this.out = null;\n\n        // Initialize weights and bias\n        for (var l=1; l < this.layer_nodes.length; l++) {\n            if (init_method == 'uniform') {\n                var arrW = []\n                for (var i=0; i < this.layer_nodes[l]; i++) {\n                    var arr = []\n                    for (var j=0; j < this.layer_nodes[l-1]; j++) {\n                        arr.push(random.uniform(-1,1)());\n                    }\n                    arrW.push(arr);\n                }\n                var arrb = [];\n                for (var i=0; i < this.layer_nodes[l]; i++) {\n                    arrb.push([random.uniform(-1,1)()]);\n                }\n                this.params['W' + l.toString()] = arrW;\n                this.params['b' + l.toString()] = arrb;\n            } else {\n                throw new Error('Implement more options, bro');\n            }\n            \n            this.params['A' + l.toString()] = null;\n        }\n    }\n\n    feed_forward = (X) => {\n        var A_prev = X;\n        const L = this.layer_nodes.length - 1;\n        var W = null;\n        var b = null;\n        var Z = null;\n        // Feed hidden layers\n        for (var l=1; l<L; l++) {\n            W = this.params['W' + l.toString()];\n            b = this.params['b' + l.toString()];\n            // console.log(W, A_prev);\n            // console.log('dot', typeof nj.dot(W,A_prev), nj.dot(W, A_prev))\n            // console.log('b', typeof nj.array(b), nj.array(b))\n            Z = nj.dot(W, A_prev).add(nj.array(b));\n            // console.log('Z', typeof Z, Z)\n            A_prev = this.hidden_activation(Z.tolist());\n            // console.log('A_prev', A_prev)\n            this.params['A' + l.toString()] = A_prev;\n        }\n\n        W = this.params['W' + L.toString()];\n        b = this.params['b' + L.toString()];\n        Z = nj.dot(W, A_prev).add(nj.array(b));\n        const out = this.hidden_activation(Z.tolist());\n        this.params['A'+L.toString()] = out;\n        for (var i=0; i<out.length; i++) {\n            if (this.out === null)\n                this.out = i;\n            else {\n                if (out[i][0] > this.out)\n                    this.out = i\n            }\n        }\n        // console.log('a', out)\n        // console.log('out', this.out)\n        return this.out;\n    }\n}\n\nexport const get_activation_by_name = name => {\n    const activations = [['relu', relu],\n                        ['sigmoid', sigmoid],\n                        ['linear', linear],\n                        ['tanh', tanh]\n                        ]\n    var func = [];\n    for (var i=0; i<activations.length; i++) {\n        if (activations[i][0] === name.toLowerCase())\n            func.push(activations[i][1]);\n    }\n    console.assert(func.length == 1);\n    return func[0];\n}","import Individual from '../genetic_algorithm/individual';\nimport {FeedForwardNetwork, linear, sigmoid, tanh, relu, get_activation_by_name} from './neural_network';\n\n// var nj = require('numjs');\n\nclass Paddle extends Individual{\n    constructor(p5, xPaddle=0, yPaddle=200, ySpeed=0, boardSize, chromosome=null, hidden_layer_architecture=[20,12], hidden_activation='relu', output_activation='sigmoid') {\n        super(Individual());\n        this.xPaddle = xPaddle;\n        this.yPaddle = yPaddle;\n        this.ySpeed = ySpeed;\n        this.board_size = boardSize;\n\n        this.fitness = 0;\n        this.hit = 0;\n        this.distance_travelled = 0;\n        this.ball_travelled = 0;\n        this.distance_to_ball = 0;\n        this.is_alive = true;\n\n        this.hidden_layer_architecture = hidden_layer_architecture;\n        this.hidden_activation = hidden_activation;\n        this.output_activation = output_activation;\n\n        // Setting up network architecture\n        // Each \"Vision\" has 3 distances it tracks: wall, apple and self\n        // there are also one-hot encoded direction and one-hot encoded tail direction,\n        // each of which have 4 possibilities.\n        const num_inputs = 5  \n        this.network_architecture = [num_inputs]                          // Inputs\n        this.network_architecture.push(...this.hidden_layer_architecture)  // Hidden layers\n        this.network_architecture.push(3)                               // 3 outputs, ['left', 'still', 'right']\n        this.network = new FeedForwardNetwork(this.network_architecture,\n                                          get_activation_by_name(this.hidden_activation),\n                                          get_activation_by_name(this.output_activation)\n        )\n\n        // If chromosome is set, take it\n        if (chromosome) {\n            // this._chromosome = chromosome\n            this.network.params = chromosome\n            // this.decode_chromosome()\n        } else {\n            // this._chromosome = {}\n            // this.encode_chromosome()\n        }\n        \n    }\n\n    fitness = () => {\n        return this.fitness;\n    }\n\n    calculate_fitness = () => {\n        this.fitness = (2 ** this.hit + this.hit * 2.1) * 200 + ((1 - Math.min(this.distance_travelled / this.ball_travelled, 1)) * 400) + (this.board_size[0] - this.distance_to_ball) * 0.5;\n        this.fitness = Math.max(this.fitness, .1);\n    }\n\n    reset = () => {\n        this.fitness = 0;\n        this.hit = 0;\n        this.distance_travelled = 0;\n        this.distance_to_ball = 0;\n        this.is_alive = 0;\n    }\n\n    update = (inputs=null, ball=null) => {\n        if (inputs !== null) {\n            this.network.feed_forward(inputs);\n        } else if (ball !== null) {\n            this.yPaddle = ball.yBall - 45;\n        }\n        if (this.network.out === 0) {\n            this.ySpeed = -15;\n        } else if (this.network.out === 1) {\n            this.ySpeed = 15;\n        } else if (this.network.out === 2) {\n            this.ySpeed = 0;\n        }\n        return true;\n    }\n\n    move = () => {\n        this.yPaddle += this.ySpeed;\n        this.distance_travelled += Math.abs(this.ySpeed);\n    }\n\n    draw = (p5, winner=false, champion=false) => {\n        if (!this.is_alive) {\n            return;\n        } else if (champion) {\n            p5.fill('#00ff00');\n            p5.rect(this.xPaddle, this.yPaddle, 15, 90);\n        } else if (winner) {\n            p5.fill('#00ff00');\n            p5.rect(this.xPaddle, this.yPaddle, 15, 90);\n        } else {\n            p5.fill('#8A2BE2');\n            p5.rect(this.xPaddle, this.yPaddle, 15, 90);\n        }\n    }\n}\n\nexport default Paddle;","class Ball {\n    constructor(xBall, yBall, xSpeed, ySpeed) {\n        this.xBall = xBall;\n        this.yBall = yBall;\n        this.xSpeed = xSpeed;\n        this.ySpeed = ySpeed;\n        this.xLast = xBall - xSpeed;\n        this.yLast = yBall - ySpeed;\n\n        this.is_alive = true;\n        this.distance_travelled = 0;\n    }\n    \n\n    update = (paddle, boardSize) => {\n        this.distance_travelled += Math.abs(this.ySpeed);\n\n        if (this.yBall < 0) {\n            this.yBall = 0;\n            this.ySpeed *= -1;\n        }\n        else if (this.yBall > boardSize[1]-20) {\n            this.yBall = boardSize[1]-20;\n            this.ySpeed *= -1;\n        }\n        else if (this.xBall > boardSize[0]-35) {\n            this.xBall = boardSize[0]-35;\n            this.xSpeed *= -1;\n        }\n        else if (this.yBall > paddle.yPaddle-10 && this.yBall < paddle.yPaddle + 80 && this.xLast > 15 && this.xBall <= 15) {\n            this.xSpeed *= -1;\n            paddle.hit += 1;\n            paddle.distance_to_ball = 0;\n        }\n        else if (this.xBall < 0) {\n            this.xSpeed *= -1;\n            paddle.ball_travelled = this.distance_travelled;\n            paddle.is_alive = false;\n            paddle.distance_to_ball = Math.abs(this.xBall - paddle.xPaddle);\n        }\n    }\n\n    move = () => {\n        this.xLast = this.xBall;\n        this.yLast = this.yBall;\n\n        this.xBall += this.xSpeed;\n        this.yBall += this.ySpeed;\n    }\n\n    draw = (p5) => {\n        p5.fill('#8A2BE2');\n        p5.ellipse(this.xBall, this.yBall, 20, 20);\n    }\n}\n\nexport default Ball;","const settings = {\n    // Hidden layer activation is specific to hidden layers, i.e. all layers except the input and output\n    'hidden_layer_activation':     'relu',     // Options are [relu, sigmoid, tanh, linear, leaky_relu]\n    // Output layer activation is specific to the output layer \n    'output_layer_activation':     'sigmoid',  // Options are [relu, sigmoid, tanh, linear, leaky_relu]\n    // Hidden network architecture describes the number of nodes in each hidden layer\n    'hidden_network_architecture': [12, 20, 12],   // A list containing number of nodes in each hidden layer\n\n    //### GA stuff ####\n\n    //# Mutation ##\n\n    // Mutation rate is the probability that a given gene in a chromosome will randomly mutate\n    'mutation_rate':               0.05,       // Value must be between [0.00, 1.00)\n    // If the mutation rate type is static, then the mutation rate will always be `mutation_rate`,\n    // otherwise if it is decaying it will decrease as the number of generations increase\n    'mutation_rate_type':          'static',   // Options are [static, decaying]\n    // The probability that if a mutation occurs, it is gaussian\n    'probability_gaussian':        1.0,        // Values must be between [0.00, 1.00]\n    // The probability that if a mutation occurs, it is random uniform\n    'probability_random_uniform':  0.0,        // Values must be between [0.00, 1.00]\n\n    //# Crossover ##\n    \n    // eta related to SBX. Larger values create a distribution closer around the parents while smaller values venture further from them.\n    // Only used if probability_SBX > 0.00\n    'SBX_eta':                     100,\n    // Probability that when crossover occurs, it is simulated binary crossover\n    'probability_SBX':             1,\n    // The type of SPBX to consider. If it is 'r' then it flattens a 2D array in row major ordering.\n    // If SPBX_type is 'c' then it flattens a 2D array in column major ordering.\n    'SPBX_type':                   'r',        // Options are 'r' for row or 'c' for column\n    // Probability that when crossover occurs, it is single point binary crossover\n    'probability_SPBX':            0,\n    // Crossover selection type determines the way in which we select individuals for crossover\n    'crossover_selection_type':    'roulette_wheel',\n\n    //# Selection ##\n\n    // Number of parents that will be used for reproducing\n    'num_parents':                 50,\n    // Number of offspring that will be created. Keep num_offspring >= num_parents\n    'num_offspring':               100,\n    // The selection type to use for the next generation.\n    // If selection_type == 'plus':\n    //     Then the top num_parents will be chosen from (num_offspring + num_parents)\n    // If selection_type == 'comma':\n    //     Then the top num_parents will be chosen from (num_offspring)\n    // @NOTE: if the lifespan of the individual is 1, then it cannot be selected for the next generation\n    // If enough indivduals are unable to be selected for the next generation, new random ones will take their place.\n    // @NOTE: If selection_type == 'comma' then lifespan is ignored.\n    //   This is equivalent to lifespan = 1 in this case since the parents never make it to the new generation.\n    'selection_type':              'plus',     // Options are ['plus', 'comma']\n}\n\nexport default settings;","var nj = require('@aas395/numjs');\n\nclass Population {\n    constructor(individuals) {\n        this.individuals = individuals;\n    }\n\n    num_individuals = () => {\n        return this.individuals.length;\n    }\n\n    num_individuals_ = () => {\n        throw new Error('Cannot set the number of individuals. You must change Population.individuals instead');\n    }\n\n    num_genes = () => {\n        return this.individuals[0].chromosome.shape[1];\n    }\n\n    num_genes_ = () => {\n        throw new Error('Cannot set the number of genes. You must change Population.individuals instead');\n    }\n\n    average_fitness = () => {\n        var sum = 0;\n        for (var individual of this.individuals)\n            sum += individual.fitness;\n        return sum / this.individuals.length;\n    }\n\n    average_fitness_ = () => {\n        throw new Error('Cannot set average fitness. This is a read-only property.');\n    }\n\n    fittest_individual = () => {\n        var best = 0;\n        var indi = null;\n        for (var individual of this.individuals) {\n            if (individual.fitness > best) {\n                best = individual.fitness;\n                indi = individual;\n            }\n        }\n        return indi;\n    }\n\n    fittest_individual_ = () => {\n        throw new Error('Cannot set fittest individual. This is a read-only property');\n    }\n\n    calculate_fitness = () => {\n        for (var individual of this.individuals) {\n            individual.calculate_fitness();\n        }\n    }\n\n    get_fitness_std = () => {\n        return nj.std(nj.array(this.individuals.map(a=>a.fitness)));\n    }\n}\n\nexport default Population;","var nj = require('@aas395/numjs');\nconst random = require('random');\n\nexport function elitism_selection(population, num_individuals) {\n    var individuals = population.individuals.sort(a=>a.fitness).reverse();\n    return individuals.slice(0, num_individuals);\n}\n\nexport function roulette_wheel_selection(population, num_individuals) {\n    var selection = [];\n    var wheel = 0;\n    for (var individual of population.individuals) {\n        wheel += individual.fitness;\n    }\n    for (var i=0; i<num_individuals; i++) {\n        const pick = random.float(0, wheel);\n        var current = 0;\n        for (var individual of population.individuals) {\n            current += individual.fitness;\n            if (current > pick) {\n                selection.push(individual);\n                break;\n            }\n        }\n    }\n    return selection;\n}","var nj = require('@aas395/numjs');\nvar random = require('random');\n\nexport function gaussian_mutation(chromosome, prob_mutation, scale=null, mu=null, sigma=null) {\n    /*\n    Perform a gaussian mutation for each gene in an individual with probability, prob_mutation.\n\n    If mu and sigma are defined then the gaussian distribution will be drawn from that,\n    otherwise it will be drawn from N(0, 1) for the shape of the individual.\n    */\n   // Determine which genes will be mutated\n   var mutation_array = [];\n   for (var i=0; i<chromosome.shape[0]; i++) {\n        var arr = [];\n        for (var j=0; j<chromosome.shape[1]; j++) \n            arr.push(random.float() < prob_mutation ? 1 : 0);\n        mutation_array.push(arr);\n   }\n   // If mu and sigma are defined, create gaussian distribution around each one\n   var gaussian_mutation = [];\n   if (mu && sigma) {\n       gaussian_mutation = random.normal(mu, sigma)();\n   } else {\n        for (var i=0; i<chromosome.shape[0]; i++) {\n            var arr = [];\n            for (var j=0; j<chromosome.shape[1]; j++) \n                arr.push(random.normal()());\n            gaussian_mutation.push(arr);\n        }\n   }\n\n   if (scale) {\n       for (var i = 0; i<chromosome.shape[0]; i++) {\n            for (var j=0; j<chromosome.shape[1]; j++) {\n                if (mutation_array[i][j])\n                    gaussian_mutation[i][j] *= scale;\n            }\n       }\n   }\n   // Update\n   for (var i = 0; i<chromosome.shape[0]; i++) {\n        for (var j=0; j<chromosome.shape[1]; j++) {\n            if (mutation_array[i][j] === 1)\n                chromosome.set(i, j, chromosome.get(i,j) + gaussian_mutation[i][j]);\n        }\n    } \n}\n\nexport function random_uniform_mutation(chromosome, prob_mutation, low, high) {\n    // var mutation_array = nj.random.random(chromosome.shape) < prob_mutation;\n    // if (low isinstanceof Array) {\n\n    // }\n}","var nj = require('@aas395/numjs');\nconst random = require('random');\n\nexport function simulated_binary_crossover(parent1, parent2, eta) {\n    /*\n    This crossover is specific to floating-point representation.\n    Simulate behavior of one-point crossover for binary representations.\n\n    For large values of eta there is a higher probability that offspring will be created near the parents.\n    For small values of eta, offspring will be more distant from parents\n    */\n    var rand = nj.random(nj.array(parent1).shape);\n    var gamma = nj.zeros(nj.array(parent1).shape);\n    for (var i=0; i<gamma.shape[0]; i++) {\n        for (var j=0; j<gamma.shape[1]; j++) {\n            if (rand.get(i,j) <= 0.5) {\n                gamma.set(i, j, ((2 * rand.get(i,j)) ** (1.0 / (eta + 1))));\n            }\n            else {\n                gamma.set(i, j, ((1.0 / (2.0 * (1.0 - rand.get(i,j)))) ** (1.0 / (eta + 1))));\n            }\n        }\n    }\n    // Calculate Child 1 chromosome (Eq. 9.9)\n    var chromosome1 = (((gamma.add(1)).multiply(parent1)).add(nj.ones(gamma.shape).subtract(gamma)).multiply(parent2)).multiply(0.5);\n    // Calculate Child 2 chromosome (Eq. 9.10)\n    var chromosome2 = (((nj.ones(gamma.shape).subtract(gamma)).multiply(parent1)).add((gamma.add(1)).multiply(parent2)).multiply(0.5));\n\n    return [chromosome1, chromosome2];\n}\n\nexport function uniform_binary_crossover(parent1, parent2) {\n    var offspring1 = nj.copy(parent1);\n    var offspring2 = nj.copy(parent2);\n\n    var mask = [];\n    for (var i=0; i<offspring1.shape; i++)\n        mask.push(random.uniform(0, 1));\n    offspring1[mask > 0.5] = parent2[mask > 0.5];\n    offspring2[mask > 0.5] = parent1[mask > 0.5];\n\n    return [offspring1, offspring2];\n}\n\nexport function single_point_binary_crossover(parent1, parent2, major='r') {\n    var offspring1 = nj.copy(parent1);\n    var offspring2 = nj.copy(parent2);\n\n    // var rows, cols = parent2.shape;\n    // const row = random.int(0, rows);\n    // const col = random.int(0, cols);\n\n    // if (major.toLowerCase() === 'r') {\n    //     off\n    // }\n    return [offspring1, offspring2];\n}","import Sketch from 'react-p5';\nimport Paddle from './Paddle';\nimport Ball from './Ball';\nimport settings from './settings';\nimport Population from '../genetic_algorithm/population';\nimport {FeedForwardNetwork, sigmoid, linear, relu} from './neural_network'\nimport {elitism_selection, roulette_wheel_selection} from '../genetic_algorithm/selection';\nimport {gaussian_mutation, random_uniform_mutation} from '../genetic_algorithm/mutation';\nimport {simulated_binary_crossover as SBX} from '../genetic_algorithm/crossover';\nimport {uniform_binary_crossover, single_point_binary_crossover} from '../genetic_algorithm/crossover';\nconst random = require('random');\nvar nj = require('@aas395/numjs');\n\nfunction Pong(props) {\n    const cumulativeSum = (sum => value => sum += value)(0);\n    var _mutation_bins = [settings['probability_gaussian'], settings['probability_random_uniform']].map(cumulativeSum);\n    var _crossover_bins = [settings['probability_SBX'], settings['probability_SPBX']].map(cumulativeSum);\n    var _SPBX_type = settings['SPBX_type'].toLowerCase();\n    var _SBX_eta = settings['SBX_eta'];\n    var _mutation_rate = props.settings['mutationRate'];\n\n    // Determine size of next gen based off selection type\n    var _next_gen_size = null;\n    if (settings['selection_type'].toLowerCase() == 'plus')\n        _next_gen_size = props.settings['numParents'] + props.settings['numOffsprings'];\n    else if (settings['selection_type'].lower() == 'comma')\n        _next_gen_size = props.settings['numOffsprings'];\n    else\n        throw new Error('Selection type \"{}\" is invalid'.format(settings['selectionType']));\n\n    var board_size = props.dimension;\n\n    var individuals = [];\n    var balls = [];\n\n    var population = new Population(individuals);\n    var current_generation = 0;\n    var winner = null;\n    var winner_index = -1;\n    var champion = null;\n    var champion_index = -1;\n    var champion_fitness = Number.NEGATIVE_INFINITY;\n\n    var num_hit = 0;\n    var best_hit = 0;\n\n    var training_paddle = null;\n    var newball = true;\n\n    const setup = (p5, canvasParentRef) => {\n        // use parent to render the canvas in this ref\n        // (without that p5 will render the canvas outside of your component)\n        p5.createCanvas(board_size[0], board_size[1]).parent(canvasParentRef);\n        training_paddle = new Paddle(p5, board_size[0]-15, board_size[1]/2-45, 0, board_size);\n        for (var i=0; i < props.settings['numParents']; i++) {\n            const individual = new Paddle(p5, 0, board_size[1]/2-45, 0, board_size, null,\n                                    props.settings['hiddenLayerArchitecture'], \n                                    settings['hidden_layer_activation', \n                                    settings['output_activation']]);\n            individuals.push(individual);\n        }\n        const button = p5.createButton('Return').parent(canvasParentRef);\n        button.position(30, 10);\n        button.style('background-color', '#8A2BE2')\n        button.mousePressed(props.updateStart);\n    };\n \n    const draw = (p5) => {\n        p5.background(0);\n        p5.textSize(20);\n        p5.fill('#8A2BE2');\n        p5.text('Generation: '+current_generation, board_size[0]-180, 30);\n        p5.text('Hit: '+num_hit, board_size[0]-180, 60);\n        p5.text('Best: '+best_hit, board_size[0]-180, 90);\n        // New set of balls\n        if (newball) {\n            balls = [];\n            const bally = random.int(0, board_size[1]);\n            const speedy = random.int() === 1 ? 15 : -15;\n            for (var i=0; i < _next_gen_size+1; i++) {\n                balls.push(new Ball(board_size[0] / 2, bally, 15, speedy));\n            }\n            newball = false;\n        }\n\n        // Update training paddle\n        training_paddle.update(null, balls[balls.length-1]);\n        balls[balls.length-1].update(training_paddle, board_size);\n        balls[balls.length-1].move();\n        training_paddle.is_alive = true;\n        training_paddle.draw(p5);\n\n        var still_alive = 0;\n        // Loop through the paddles in the generation\n        for (var i=0; i < population.individuals.length; i++) {\n            var paddle = population.individuals[i];\n\n            if (paddle.is_alive) {\n                still_alive++;\n                //----------------------------------------inputs for neural network--------------------------------------------\n                // const distance = ((balls[i].y - paddle.y_pos) ** 2 + (balls[i].x - paddle.x_pos) ** 2) ** 0.5;\n                // const ball_distance_left_wall = balls[i].yBall - 0;\n                // const ball_distance_right_wall = board_size[1] - balls[i].yBall;\n                const inputs = [[paddle.yPaddle], [balls[i].ySpeed], [paddle.ySpeed], [balls[i].yBall], [balls[i].xSpeed]];\n                // inputs = np.array([[paddle.x_pos], [balls[i].xspeed], [paddle.xspeed], [balls[i].x]])\n                //----------------------------------------inputs for neural network--------------------------------------------\n                paddle.update(inputs);\n                balls[i].update(paddle, board_size);\n                num_hit = Math.max(num_hit, paddle.hit);\n                best_hit = Math.max(num_hit, best_hit);\n                balls[i].move();\n                paddle.move();\n            }\n\n            // Draw every paddle except the best ones\n            if (paddle.is_alive && paddle !== winner && paddle !== champion) {\n                // paddle.winner = False\n                // paddle.champion = False\n                balls[i].draw(p5);\n                paddle.draw(p5);\n            }\n        }\n        // Generate new generation when all have died out\n        if (still_alive === 0)\n            next_generation(p5);\n\n        // Draw the winning and champion paddle last\n        if (winner !== null && winner.is_alive) {\n            balls[winner_index].draw(p5);\n            winner.draw(p5, true, false);\n        }\n        if (champion !== null && champion.is_alive) {\n            balls[champion_index].draw(p5);\n            champion.draw(p5, false, true);\n        }\n    };\n\n    const next_generation = (p5) => {\n        current_generation++;\n        newball = true;\n        num_hit = 0;\n        \n        // Calculate fitness of individuals\n        for (var individual of population.individuals)\n            individual.calculate_fitness();\n        \n        // Find winner from each generation and champion\n        winner = population.fittest_individual();\n        winner_index = population.individuals.indexOf(winner);\n        if (winner.fitness > champion_fitness) {\n            champion_fitness = winner.fitness;\n            champion = winner;\n            champion_index = winner_index;\n        }\n        winner.reset();\n        champion.reset();\n\n        // Print results from each generation\n        console.log('======================= Generation', current_generation, '=======================');\n        console.log('----Max fitness:', population.fittest_individual().fitness);\n        // print('----Best Score:', self.population.fittest_individual.score);\n        console.log('----Average fitness:', population.average_fitness());\n        \n        population.individuals = elitism_selection(population, props.settings['numParents']);\n        population.individuals = shuffle(population.individuals);\n        var next_pop = [];\n\n        // parents + offspring selection type ('plus')\n        if (settings['selection_type'].toLowerCase() === 'plus') {\n            next_pop.push(winner);\n            next_pop.push(champion);\n        }\n\n        while (next_pop.length < _next_gen_size) {\n            var [p1, p2] = roulette_wheel_selection(population, 2);\n            const L = p1.network.layer_nodes.length;\n            var c1_params = {};\n            var c2_params = {};\n\n            // Each W_l and b_l are treated as their own chromosome.\n            // Because of this I need to perform crossover/mutation on each chromosome between parents\n            for (var l = 1; l < L; l++) {\n                const p1_W_l = p1.network.params['W' + l.toString()]\n                const p2_W_l = p2.network.params['W' + l.toString()]  \n                const p1_b_l = p1.network.params['b' + l.toString()]\n                const p2_b_l = p2.network.params['b' + l.toString()]\n\n                var c1_W_l = null, c2_W_l = null, c1_b_l = null, c2_b_l = null;\n\n                // Crossover\n                // @NOTE: I am choosing to perform the same type of crossover on the weights and the bias.\n                [c1_W_l, c2_W_l, c1_b_l, c2_b_l] = _crossover(p1_W_l, p2_W_l, p1_b_l, p2_b_l);\n\n                // Mutation\n                // @NOTE: I am choosing to perform the same type of mutation on the weights and the bias.\n                _mutation(c1_W_l, c2_W_l, c1_b_l, c2_b_l);\n\n                // Assign children from crossover/mutation\n                c1_params['W' + l.toString()] = c1_W_l;\n                c2_params['W' + l.toString()] = c2_W_l;\n                c1_params['b' + l.toString()] = c1_b_l;\n                c2_params['b' + l.toString()] = c2_b_l;\n\n                // Clip to [-1, 1]\n                for (var i=0; i<c1_params['W'+l.toString()].shape[0]; i++) {\n                    for (var j=0; j<c1_params['W'+l.toString()].shape[1]; j++) {\n                        c1_params['W'+l.toString()].set(i, j, c1_params['W'+l.toString()].get(i, j) < -1 ? -1 : c1_params['W'+l.toString()].get(i, j));\n                        c1_params['W'+l.toString()].set(i, j, c1_params['W'+l.toString()].get(i, j) > 1 ? 1 : c1_params['W'+l.toString()].get(i, j));\n                        c2_params['W'+l.toString()].set(i, j, c2_params['W'+l.toString()].get(i, j) < -1 ? -1 : c2_params['W'+l.toString()].get(i, j));\n                        c2_params['W'+l.toString()].set(i, j, c2_params['W'+l.toString()].get(i, j) > 1 ? 1 : c2_params['W'+l.toString()].get(i, j));\n                        c1_params['b'+l.toString()].set(i, j, c1_params['b'+l.toString()].get(i, j) < -1 ? -1 : c1_params['b'+l.toString()].get(i, j));\n                        c1_params['b'+l.toString()].set(i, j, c1_params['b'+l.toString()].get(i, j) > 1 ? 1 : c1_params['b'+l.toString()].get(i, j));\n                        c2_params['b'+l.toString()].set(i, j, c2_params['b'+l.toString()].get(i, j) < -1 ? -1 : c2_params['b'+l.toString()].get(i, j));\n                        c2_params['b'+l.toString()].set(i, j, c2_params['b'+l.toString()].get(i, j) > 1 ? 1 : c2_params['b'+l.toString()].get(i, j));\n                    }\n                }\n            }\n\n            // Create children from chromosomes generated above\n            var c1 = new Paddle(p5, 0, board_size[1]/2-45, 0, board_size, c1_params,\n                        props.settings['hiddenLayerArchitecture'], \n                        settings['hidden_layer_activation', \n                        settings['output_activation']]);\n            var c2 = new Paddle(p5, 0, board_size[1]/2-45, 0, board_size, c2_params,\n                        props.settings['hiddenLayerArchitecture'], \n                        settings['hidden_layer_activation', \n                        settings['output_activation']]);\n\n            // Add children to the next generation\n            next_pop.push(...[c1,c2]);\n        }\n        shuffle(next_pop);\n        population.individuals = next_pop;\n        \n    }\n\n    const _crossover = (parent1_weights, parent2_weights, parent1_bias, parent2_bias) => {\n        const rand_crossover = random.float();\n        var crossover_bucket = null;\n        for (var i = 1; i < _crossover_bins.length; i++) {\n            if (rand_crossover < _crossover_bins[i])\n                crossover_bucket = i-1;\n        }\n        var child1_weights = null;\n        var child2_weights = null;\n        var child1_bias = null;\n        var child2_bias = null;\n\n        // SBX\n        if (crossover_bucket === 0) {\n            [child1_weights, child2_weights] =  SBX(parent1_weights, parent2_weights, _SBX_eta);\n            [child1_bias, child2_bias] = SBX(parent1_bias, parent2_bias, _SBX_eta);\n        }\n\n        // Single point binary crossover (SPBX)\n        else if (crossover_bucket === 1) {\n            [child1_weights, child2_weights] = single_point_binary_crossover(parent1_weights, parent2_weights, _SPBX_type);\n            [child1_bias, child2_bias] =  single_point_binary_crossover(parent1_bias, parent2_bias, _SPBX_type);\n        }\n\n        else\n            throw new Error('Unable to determine valid crossover based off probabilities');\n        \n        return [child1_weights, child2_weights, child1_bias, child2_bias];\n    }\n\n    const _mutation = (child1_weights, child2_weights, child1_bias, child2_bias) => {\n        const scale = 0.2;\n        const rand_mutation = random.float();\n        var mutation_bucket = null;\n        for (var i = 1; i < _mutation_bins.length; i++) {\n            if (rand_mutation < _mutation_bins[i])\n                mutation_bucket = i-1;\n        }\n\n        var mutation_rate = _mutation_rate;\n        if (props.settings['mutationRateType'].toLowerCase() === 'decaying')\n            mutation_rate = mutation_rate / Math.sqrt(current_generation + 1);\n        \n        if (mutation_bucket === 0) {\n            // Mutate weights\n            gaussian_mutation(child1_weights, mutation_rate, scale);\n            gaussian_mutation(child2_weights, mutation_rate, scale);\n\n            // Mutate bias\n            gaussian_mutation(child1_bias, mutation_rate, scale);\n            gaussian_mutation(child2_bias, mutation_rate, scale);\n        }\n        \n        // Uniform random\n        else if (mutation_bucket === 1) {\n            // Mutate weights\n            random_uniform_mutation(child1_weights, mutation_rate, -1, 1);\n            random_uniform_mutation(child2_weights, mutation_rate, -1, 1);\n\n            // Mutate bias\n            random_uniform_mutation(child1_bias, mutation_rate, -1, 1);\n            random_uniform_mutation(child2_bias, mutation_rate, -1, 1);\n        }\n\n        else\n            throw new Error('Unable to determine valid mutation based off probabilities.');\n    }\n\n    const shuffle = array => {\n        var currentIndex = array.length, temporaryValue, randomIndex;\n      \n        // While there remain elements to shuffle...\n        while (0 !== currentIndex) {\n      \n          // Pick a remaining element...\n          randomIndex = Math.floor(Math.random() * currentIndex);\n          currentIndex -= 1;\n      \n          // And swap it with the current element.\n          temporaryValue = array[currentIndex];\n          array[currentIndex] = array[randomIndex];\n          array[randomIndex] = temporaryValue;\n        }\n      \n        return array;\n    }\n\n\n    return (\n        <div>\n            <Sketch setup={setup} draw={draw} />\n        </div>\n    );\n}\n\nexport default Pong;","export class colorGrid {\n  constructor(color) {\n      const colorList = {\n          red: \"#B22222\", purple: \"#4B0082\", green: \"#9ACD32\",\n          blue: \"#6495ED\", yellow: \"#DAA520\", black: \"#333333\",\n      };\n      if (color in colorList) {\n          this.color = colorList[color];\n      } else {\n          this.color = color;\n      }\n  }\n  draw(ctx, x, y, w, h) {\n      ctx.fillStyle = this.color;\n      ctx.fillRect(x, y, w, h);\n  }\n}\n\nexport class Rect {\n  constructor(x, y, w, h){\n      this.x = x;\n      this.y = y;\n      this.w = w;\n      this.h = h;\n  }\n\n  draw(context, sprite) {\n      sprite.draw(context, this.x, this.y, this.w, this.h);\n  }\n\n  contains(point) {\n      // check whether p is in [x,x+w) x [y,y+h)\n      // inclusive in x and y; exclusive in x+w, y+h\n      var x = point[0];\n      var y = point[1];\n      if (\n        x >= this.x &&\n        x < this.x + this.w  &&\n        y >= this.y &&\n        y < this.y + this.h\n      ) {\n          return true;\n      } else {\n          return false;\n      }\n  }\n\n  collideRect(rect, overlap=true){\n      if (!(overlap)) {\n          // weak collision detection:\n          // point collision; does not consider area overlap\n          if (this.x == rect.x || this.y == rect.y){\n              return true;\n          } else {\n              return false;\n          }\n      } else {\n          // strong collision; detects area collision\n          if (this.contains([rect.x, rect.y])\n          || rect.contains([this.x, this.y])){\n              return true;\n          } else {\n              return false;\n          }\n      }\n  }\n}\n\nexport var Sprite = function(fname) {\n\n    // Static Variables\n    var TO_RADIAN = Math.PI/180;\n\n    // Instance Variables\n    this.image = null;\n    if (fname != undefined && fname != '' && fname != null) {\n        this.image = new Image();\n        this.image.src = fname;\n        //console.log([this.image.width, this.image.height]);\n    } else {\n      console.log('cannot load file');\n    }\n\n    // Instance Methods\n\n    // draw: start from top-left point\n    this.draw = function(ctx, x, y, w, h) {\n      // ctx.context.scale(ctx.dpr, ctx.dpr);\n      if (w == undefined || h == undefined) {\n        ctx.drawImage(this.image, x, y);\n      } else {\n        ctx.drawImage(this.image, x, y, w, h);\n      }\n    };\n\n    // rotate image: from center of the image\n    this.rotate = function(ctx, x, y, angle) {\n      ctx.save();\n      ctx.scale(ctx.dpr, ctx.dpr);\n      ctx.translate(x, y);\n      ctx.rotate(angle * this.TO_RADIAN);\n      ctx.drawImage(this.image, -this.image.width/2, -this.image.height/2);\n      ctx.restore();\n    };\n};\n\nexport default Sprite;","import {Rect} from \"./sprite\"\n\nexport function getRandInt(min=0, max, step=1) {\n    // return an random integer from min to max\n    // range is [min, max), inclusive in min but not max\n    var min = Math.ceil(min);\n    var max = Math.floor(max);\n    var rand = min + step*Math.floor(Math.random()*(max-min)/step);\n    return rand;\n}\n\nexport function arrayEqual(a, b, compare=(x,y)=>x==y) {\n    /*\n    checks whether two array of \"==\"-comparable elements are equal\n    NOT intended for comparing elements that are NOT \"==\" comparable\n    extension: now you can use \"compare\" function; default is \"==\"\n    */\n    if (a === b) return true;\n    if (a == null || b == null) return false;\n    if (a.length != b.length) return false;\n\n    for (var i = 0; i < a.length; i++) {\n        if (!(compare(a[i], b[i]))) return false;\n    }\n    return true;\n}\n\nexport function arrayContains(arr, obj, compare) {\n    /* check if obj equals to an element of arr with \"compare\"*/\n    if (arr == null) return false;\n    var boo = false;\n    arr.forEach((item, i) => {\n        if (compare(item, obj)) boo = true;\n    });\n    return boo;\n}\n\nString.prototype.format = function () {\n    // string formatter\n    var i = 0, args = arguments;\n    return this.replace(/{}/g, function () {\n        return typeof args[i] != 'undefined' ? args[i++] : '';\n    });\n};\n\nexport function to_csv(array2d) {\n    // convert 2d array to csv\n    var csvContent = \"data:text/csv;charset=utf-8,\" \n    + array2d.map(e => e.join(\",\")).join(\"\\n\");\n    return csvContent;\n}\n\nexport function download(content, fileName) {\n    var encodedUri = encodeURI(content);\n    var link = document.createElement(\"a\");\n\n    link.setAttribute(\"href\", encodedUri);\n    link.setAttribute(\"download\", fileName);\n    document.body.appendChild(link);\n    link.click();\n}\n\nexport function generateExtraWalls(array2d, size, pix) {\n    if (array2d == null) return null;\n    var walls = [];\n    array2d.forEach(([x,y], i) => {\n        if (pix) {\n            x *= size; \n            y *= size;\n        }\n        walls.push(new Rect(x, y, size, size));\n    });\n    return walls;\n}\n\nexport function euclidean(p1, p2) {\n    const [x1, y1] = p1;\n    const [x2, y2] = p2;\n    return Math.sqrt((x1-x2)**2 + (y1-y2)**2);\n}\n\nexport function random_choice(array) {\n    const rand_idx = getRandInt(0, array.length);\n    return array[rand_idx];\n}\n\nexport function random_sample(array, batch_size) {\n    if (array.length < batch_size) return array;\n\n    var array_copy = array.map((item, i) => item);\n    var sample = [];\n    for (var i = 0; i < batch_size; i++) {\n        var rand_idx = getRandInt(0, array_copy.length);\n        sample.push(\n            array_copy.splice(rand_idx, 1)[0]\n        );\n    }\n    return sample;\n}\n\n// https://stackoverflow.com/questions/11488014/asynchronous-process-inside-a-javascript-for-loop\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise","/*\n1. All coordinates are in actual coordinats\n2. (0,0) is at the TOP-LEFT corner\n*/\n\nimport * as util from \"./util\";\nimport {colorGrid, Rect} from \"./sprite\";\nimport \"react-p5\";\n\n\nexport class Snake {\n    // Snake object for snake game.\n    // Attributes:\n    // - length\n    // - x\n    // - y\n    // - color\n    // - direction\n    // - boxSize\n    // - body\n    direction = \"U\";\n    length = 1;\n    constructor(x, y, length, direction, boxSize, board_x, board_y) {\n        this.x = x;\n        this.y = y;\n        this.length = length;\n        this.direction = direction;\n\n        this.boxSize = boxSize;\n        this.board_x = board_x;\n        this.board_y = board_y;\n\n        this.body = [];\n        this.initialize();\n        this.head = this.body[0];\n    }\n\n    initialize() {\n        var k1 = 0; var k2 = 0;\n        if (this.direction == \"R\") k1 = -1;\n        if (this.direction == \"L\") k1 = 1;\n        if (this.direction == \"U\") k2 = 1;\n        if (this.direction == \"D\") k2 = -1;\n\n        for (var i = 0; i < this.length; i++){\n            var tempRect = new Rect(\n                this.x + k1*i * this.boxSize,\n                this.y + k2*i * this.boxSize,\n                this.boxSize, this.boxSize\n            );\n            this.body.push(tempRect);\n        }\n    }\n\n    // change direction\n    changeDirection(direction) {\n        // input: direction in [0, 1, 2, 3]\n        const DIRECTION = [\"U\", \"R\", \"D\", \"L\"];\n\n        const current = DIRECTION.indexOf(this.direction);\n        const opposite = (current + 2) % 4;\n\n        if (direction != opposite && direction != current) {\n            this.direction = DIRECTION[direction];\n        }\n    }\n\n    // move a step forward\n    addHead(collideWall=true) {\n        var k1 = 0; var k2 = 0;\n        if (this.direction == \"R\") k1 = 1;\n        if (this.direction == \"L\") k1 = -1;\n        if (this.direction == \"U\") k2 = -1;\n        if (this.direction == \"D\") k2 = 1;\n\n        if (!(collideWall)) {\n            this.x = (this.x + k1*this.boxSize) % this.board_x;\n            this.y = (this.y + k2*this.boxSize) % this.board_y;\n        } else {\n            this.x = (this.x + k1*this.boxSize);\n            this.y = (this.y + k2*this.boxSize);\n        }\n\n        var newHead = new Rect(\n            this.x, this.y,\n            this.boxSize, this.boxSize\n        );\n        this.body.unshift(newHead);\n        this.head = this.body[0];\n    }\n\n    deleteTail() {\n        return this.body.pop();\n    }\n\n    addTail(tail) {\n        this.body.push(tail);\n    }\n\n    collideWithBody() {\n        for (var i = 1; i < this.body.length; i++) {\n            var part = this.body[i];\n            if (this.head.collideRect(part)) {\n                return true\n            }\n        }\n        return false;\n    }\n\n    collideWithWall(extraWalls=null) {\n        // normal wall check\n        var wallRect = new Rect(0, 0, this.board_x, this.board_y);\n        if ( !(wallRect.contains([this.x, this.y])) ) {\n            return true;\n        }\n        // extra wall check\n        if (extraWalls == null) return false;\n\n        var bool = false;\n        extraWalls.forEach(part => {\n            if (this.head.collideRect(part)) {\n                bool = true;\n            }\n        });\n        return bool;\n    }\n\n    addHead_snakeTwo(max_width, max_height) {\n        return null;\n    }\n\n    draw(p5) {\n        p5.fill(\"#7ffc03\");\n        for (var i=0; i < this.body.length; i++) {\n            var rect = this.body[i];\n            p5.rect(rect.x, rect.y, this.boxSize, this.boxSize);\n        }\n    }\n}\n\n\nexport class Apple {\n    /*\n    Apple Object for the snake game.\n    Attributes:\n    - boxLength\n    - x\n    - y\n    */\n    constructor(boxLength, x, y, board_x, board_y) {\n        this.boxLength = boxLength;\n        this.x = x;\n        this.y = y;\n        this.board_x = board_x;\n        this.board_y = board_y;\n        this.rect = new Rect(this.x, this.y, this.boxLength, this.boxLength);\n    }\n\n    // avoid: list of (x,y) arrays\n    move(avoid=null) {\n      const avoidCompare = (a, b) => util.arrayEqual(a, b);\n      while (true) {\n          var rand_x = util.getRandInt(0, this.board_x, this.boxLength);\n          var rand_y = util.getRandInt(0, this.board_y, this.boxLength);\n          var inAvoid = util.arrayContains(avoid, [rand_x,rand_y], avoidCompare);\n          if (avoid == null || !(inAvoid)){\n              break;\n          }\n      }\n      // to do construct a more efficient random for large avoid.\n      this.rect = new Rect(rand_x, rand_y, this.boxLength, this.boxLength);\n      this.x = rand_x;\n      this.y = rand_y;\n    }\n\n    draw(p5) {\n        p5.fill('#ff0000');\n        p5.rect(this.x, this.y, this.boxLength, this.boxLength);\n        // p5.rect(0,0,50,50);\n    }\n}\n\n\n// export default {Dummy, Snake, Apple};","/*\n1. stateType:\n  - 0: boolean vector of size 12\n  - 1:\n2.\n*/\n\nimport * as tf from '@tensorflow/tfjs';\n// var tf = require(\"tensorflowjs\");\nimport {Snake, Apple} from \"./snakeClass\";\nimport {colorGrid, Rect} from \"./sprite\"\nimport {generateExtraWalls, getRandInt, arrayEqual, arrayContains, euclidean} from \"./util\";\n\n\nexport class snakeGame {\n    constructor(params) {\n        // defaults\n        this.FPS = 10;\n        this.snakeLength = 3;\n\n        this.collideWall = true;\n        this.collideBody = true;\n        this.extraWalls = null;\n\n        this.manual = true;\n\n        this.stateType = \"12bool\";\n        this.rewardType = \"eat-die-close-away\";\n        this.rewardValues = {\n            eat: 10, die: -100, closer: 1, away: -1\n        };\n\n        for (var key in params) {\n            // Game-side Attributes\n            if (key == \"collideWall\") this.collideWall = params[key];\n            if (key == \"collideBody\") this.collideBody = params[key];\n            if (key == \"extraWalls\") this.extraWalls = params[key];\n\n            if (key == \"FPS\") this.FPS = params[key];\n\n            // Train-side Attributes\n            if (key == \"stateType\") this.stateType = params[key];\n            if (key == \"rewardType\") this.rewardType = params[key];\n            if (key == \"rewardValues\") this.rewardValues = params[key];\n\n            // Game Elements\n            if (key == \"snakeLength\") this.snakeLength = params[key];\n            if (key == \"manual\") this.manual = params[key];\n        }\n\n        // Mandatory\n        this.dpr = 1;\n        this.gridSize = params[\"gridSize\"] * this.dpr;\n        this.width = params[\"width\"] * this.gridSize;\n        this.height = params[\"height\"] * this.gridSize;\n\n        this.extraWalls = generateExtraWalls(this.extraWalls, this.gridSize, true);\n\n        // initialize\n        this.timer = null;\n\n        this.snake = null;\n        this.apple = null;\n\n        this.done = 0;\n        this.score = 0;\n        this.best_score = 0;\n        this.key_pressed = 0;\n\n        this.reset();\n        // this.render(); // now move render() inside reset()\n\n        if (this.manual) {\n            // player mode\n            this.keyboard_events();\n            // this.manual_play();\n        }\n\n        // attributes to compute reward\n        this.last_snake = null;\n        this.last_apple = null;\n        this.rewardMeasures = {\n            eat: 0, closer: 0, away: 0\n        };\n    }\n\n    // STATICS\n    _direction(action){\n      const DIRECTION_ARR = [\"U\",\"R\",\"D\",\"L\"];\n      return DIRECTION_ARR[action];\n    }\n\n    _action(direction){\n      const DIRECTION_ARR = [\"U\",\"R\",\"D\",\"L\"];\n      return DIRECTION_ARR.indexOf(direction);\n    }\n\n    // state space\n    update_state() {\n        if (this.stateType == \"12bool\") {\n            return this.update_state_12bool();\n        }\n    }\n    \n    update_state_12bool() {\n        // return a js array\n        // update state from this.snake and this.apple\n        // called after this.snake and this.apple are updated\n        var new_state = Array(12).fill(0);\n\n        // Direction of Snake\n        if (this.snake.direction == \"U\") {\n            new_state[0] = 1;\n        } else if (this.snake.direction == \"R\") {\n            new_state[1] = 1;\n        } else if (this.snake.direction == \"D\") {\n            new_state[2] = 1;\n        } else if (this.snake.direction == \"L\") {\n            new_state[3] = 1;\n        }\n\n        // Apple position (wrt snake head)\n        // (0,0) at Top-Left Corner: U: -y; R: +x\n        if (this.apple.y < this.snake.y) {\n            // apple north snake\n            new_state[4] = 1\n        }\n        if (this.apple.x > this.snake.x) {\n            // apple east snake\n            new_state[5] = 1\n        }\n        if (this.apple.y > this.snake.y) {\n            // apple south snake\n            new_state[6] = 1\n        }\n        if (this.apple.x < this.snake.x) {\n            // apple west snake\n            new_state[7] = 1\n        }\n\n        // Obstacle (Walls, body) position (wrt snake head)\n        var test_snake;\n        const test_case = {\n            \"U\": {oppo: \"D\", x: 0, y: -this.gridSize, state: 8},\n            \"R\": {oppo: \"L\", x: this.gridSize, y: 0, state: 9},\n            \"D\": {oppo: \"U\", x: 0, y: this.gridSize, state: 10},\n            \"L\": {oppo: \"R\", x: -this.gridSize, y: 0, state: 11}\n        };\n        for (var key in test_case) {\n            var test = test_case[key];\n            if (this.snake.direction != test[\"oppo\"]) {\n                test_snake = new Snake(\n                    this.snake.x + test[\"x\"], this.snake.y + test[\"y\"], \n                    1, \"U\", this.gridSize, this.width, this.height\n                )\n                if (test_snake.collideWithWall(this.extraWalls)) {\n                    new_state[test[\"state\"]] = 1;\n                }\n            }\n        }\n        return tf.tensor2d(new_state, [1,12]);\n    }\n\n    // reward function\n    reward() {\n        if (this.rewardType == \"eat-die-close-away\") {\n            return this.reward_basic();\n        }\n    }\n\n    reward_basic() {\n        const value = this.rewardValues;\n        const check = this.rewardMeasures;\n\n        if (this.done) return value[\"die\"];\n        if (check[\"eat\"]) return value[\"eat\"];\n        if (check[\"closer\"]) return value[\"closer\"];\n        if (check[\"away\"]) return value[\"away\"];\n        return 0;\n    }\n\n    clear_reward() {\n        // reset reward_measures\n        for (var key in this.rewardMeasures) {\n            this.rewardMeasures[key] = 0;\n        }\n    }\n\n    // functions\n    reset() {\n        // return a js array\n        this.done = 0;\n        this.score = 0;\n\n        // initialize snake head\n        var rand_x, rand_y, avoid, inAvoid;\n        const avoidCompare = (a, b) => arrayEqual(a, b);\n        if (this.extraWalls == null) {\n            avoid = null;\n        } else {\n            avoid = this.extraWalls.map(rect => [rect.x, rect.y]);\n        }\n        while (true) {\n            rand_x = getRandInt(5*this.gridSize, this.width-5*this.gridSize, this.gridSize);\n            rand_y = getRandInt(5*this.gridSize, this.width-5*this.gridSize, this.gridSize);\n            inAvoid = arrayContains(avoid, [rand_x,rand_y], avoidCompare);\n            console.log(inAvoid);\n            if (avoid == null || !(inAvoid)){\n                break;\n            }\n        }\n\n        this.snake = new Snake(\n            rand_x, rand_y,\n            this.snakeLength, this._direction(getRandInt(0,4)), this.gridSize,\n            this.width, this.height\n        );\n\n        this.apple = new Apple(this.gridSize, 0, 0, this.width, this.height);\n        this.move_apple();\n\n        // this.render()\n\n        // restart moving\n        if (this.manual) {\n            clearInterval(this.timer);\n            this.manual_play();\n        }\n        \n        // add update_state if used for training\n        return this.update_state();\n    }\n\n    move_apple() {\n        var avoid = this.snake.body.map(part => [part.x, part.y]);\n        if (this.extraWalls != null){\n            var avoid_wall = this.extraWalls.map(part => [part.x, part.y]);\n            avoid = avoid.concat(avoid_wall);\n        }\n        this.apple.move(avoid);\n    }\n\n    update_score() {\n        this.score = this.snake.body.length() - this.snakeLength;\n        return this.score;\n    }\n\n    render() {\n        var context = this.canvas.context;\n        context.clearRect(0,0,this.width,this.height);\n        // snake\n        this.snake.body.forEach((part, i) => {\n            part.draw(context, this.snakeSprite);\n        });\n        // extra wall\n        if (this.extraWalls != null){\n            this.extraWalls.forEach((part, i) => {\n                part.draw(context, this.wallSprite);\n            });\n        }\n        // apple\n        this.apple.rect.draw(context, this.appleSprite);\n    }\n\n    manual_play() {\n        // store value of this\n        var self = this;\n        this.timer = setInterval(function(){\n            self.step();\n            self.key_pressed = 0;\n        }, 1000/this.FPS);\n    }\n\n    end_game() {\n        this.done = 1;\n        if (this.manual) {\n            clearInterval(this.timer);\n            console.log(\"You DIED!\");\n        } else {\n\n        }\n    }\n\n    step(action=null) {\n        if (this.done) return;\n\n        // training purpose: change direction\n        if (!(this.manual) && action != null) {\n            // action: integer in [0, 1, 2, 3]\n            this.snake.changeDirection(action);\n            this.last_snake = this.snake.head;\n            this.last_apple = this.apple.rect;\n        }\n\n        // move\n        this.snake.addHead(this.collideWall);\n\n        // wall collision\n        var tempTail;\n        if (this.snake.collideWithWall(this.extraWalls)) {\n            this.end_game();\n        } else {\n            tempTail = this.snake.deleteTail();\n        }\n        // body collision\n        if (this.snake.collideWithBody()) {\n            this.end_game();\n        }\n        // eat apple\n        if (this.snake.head.collideRect(this.apple.rect)) {\n            // add tail back\n            this.snake.addTail(tempTail);\n            // move apple\n            this.move_apple();\n            // update game values (score)\n            this.score += 1;\n            if (this.score > this.best_score) {\n                this.best_score = this.score;\n            }\n        } else {\n            // no longer needs to deleteTail() because we use another time logic\n            // this.snake.deleteTail();\n        }\n\n        // render\n        // this.render();\n\n        // conclude round\n        if (this.manual) {\n            return null;\n        } else {\n            return this.conclude_step();\n        }\n    }\n\n    conclude_step() {\n        // update eat-apple: 1 if apple moves\n        this.rewardMeasures[\"eat\"] = !(arrayEqual(\n            [this.last_apple.x, this.last_apple.y],\n            [this.apple.rect.x, this.apple.rect.y]\n        ));\n        // update closer or not\n        const last_distance = euclidean(\n            [this.last_snake.x, this.last_snake.y],\n            [this.last_apple.x, this.last_apple.y]\n        );\n        const distance = euclidean(\n            [this.snake.head.x, this.snake.head.y],\n            [this.apple.rect.x, this.apple.rect.y]\n        );\n        this.rewardMeasures[\"closer\"] = distance < last_distance;\n        this.rewardMeasures[\"away\"] = distance > last_distance;\n\n        // leave for future uss (if adding new rewards)\n\n        const next_state = this.update_state();\n        const reward = this.reward();\n        // clear reward measures\n        this.clear_reward();\n\n        return [next_state, reward, this.done, this.score];\n    }\n\n    keyboard_events() {\n        // key control of snake\n        document.body.addEventListener(\"keydown\", (event) => {\n            if (this.done) {\n                console.log(\"Game ended\");\n                return null;\n            }\n            if (this.key_pressed) {\n                console.log(\"key pressed in this round\");\n                return null;\n            } else {\n                this.key_pressed = 1;\n            }\n            const ARROW_ACTION = [\"ArrowUp\", \"ArrowRight\", \"ArrowDown\", \"ArrowLeft\"];\n            const key = ARROW_ACTION.indexOf(event.key);\n\n            this.snake.changeDirection(key);\n        });\n    }\n\n}\n","import * as tf from '@tensorflow/tfjs';\nimport * as util from \"./util\";\n\nclass Deque extends Array {\n    constructor(maxlen) {\n        super();\n        this.maxlen = maxlen;\n    }\n\n    pushDeque(item) {\n        if (this.length >= this.maxlen) this.shift();\n        this.push(item);\n    }\n}\n\nexport class Agent {\n    constructor(params) {\n        // mandatory\n        this.state_size = params[\"state_size\"];\n        this.action_size = params[\"action_size\"];\n        // default\n        this.gamma = 0.95;\n        this.epsilon = 1.0;\n        this.epsilon_decay = 0.995;\n        this.epsilon_min = 0.01;\n        this.learning_rate = 0.00025;\n\n        // load from params\n        for (var key in params) {\n            if (key == \"gamma\") this.gamma = params[key];\n            if (key == \"epsilon\") this.epsilon = params[key];\n            if (key == \"epsilon_decay\") this.epsilon_decay = params[key];\n            if (key == \"epsilon_min\") this.epsilon_min = params[key];\n            if (key == \"learning_rate\") this.learning_rate = params[key];\n        }\n\n        // initialize\n        this.model = this.build_model();\n\n        const maxlen = 2000;\n        this.memory = new Deque(maxlen);\n    }\n\n    /*\n    Note:\n    - the format of inputs is an (inputShape, N) matrix\n      N: number of batches/data\n    - for a 1D input, specify it as a tenser2d and its shape\n      e.g. var input = tf.tensor2d([1,2,3,4],[1,4])\n      shape [1,4]: 1 is the number of instances; 4 is the shape of input\n    */\n    build_model() {\n        const model = tf.sequential();\n        model.add(tf.layers.dense({\n            units: 128, inputShape: [this.state_size], activation: \"relu\"\n        }));\n        model.add(tf.layers.dense({\n            units: 128, activation: \"relu\"\n        }));\n        model.add(tf.layers.dense({\n            units: 128, activation: \"relu\"\n        }));\n        model.add(tf.layers.dense({\n            units: this.action_size, action: \"linear\"\n        }));\n        model.compile({\n            optimizer: tf.train.adam({learningRate: this.learning_rate}),\n            loss: 'meanSquaredError'\n        });\n        return model;\n    }\n\n    remember(state, action, reward, next_state, done){\n        this.memory.pushDeque([state, action, reward, next_state, done]);\n    }\n\n    async act(state) {\n        // state: tenser2d of size [1,state_size]\n        if (Math.random() <= this.epsilon) {\n            var action = util.getRandInt(0, this.action_size);\n        } else {\n            var action = await this.exploit(state);\n        }\n        return new Promise((resolve, reject) => {\n            resolve(action);\n        });\n    }\n\n    async exploit(state) {\n        const pred = await this.model.predict(state).reshape([this.action_size]);\n        const action = await pred.argMax().data();\n\n        return new Promise((resolve, reject) => {\n            // action is an array of size 1 -- [act]\n            resolve(action[0]);\n        });\n    }\n\n    async replay(batch_size=32) {\n        if (this.memory.length < batch_size) {\n            return Promise.resolve();\n        }\n\n        // sample mini-batch\n        const mini_batch = util.random_sample(this.memory, batch_size);\n\n        for (var i = 0; i < mini_batch.length; i++) {\n            // test purpose\n            if (i % 100 == 0) console.log(i);\n\n            var [state, action, reward, next_state, done] = mini_batch[i];\n            // compute target\n            var target = reward;\n            if (!(done)) {\n                const future_value = await this.model.predict(next_state).reshape([this.action_size]);\n                target = reward + this.gamma * future_value.max().dataSync()[0];\n            }\n            var target_state = await this.model.predict(state).reshape([this.action_size]);\n            await target_state.data().then(data => data[action] = target);\n            // train\n            await this.model.fit(state, target_state.reshape([1,this.action_size]), {\"epochs\": 1});\n        }\n        // decrease epsilon\n        if (this.epsilon > this.epsilon_min) {\n            this.epsilon *= this.epsilon_decay;\n        }\n        return new Promise((resolve, reject) => {\n            resolve();\n        });\n    }\n\n    async save_model(fname) {\n        await this.model.save(\"downloads://\" + fname);\n    }\n\n    async load_model(fname) {\n        this.model = await tf.loadLayersModel(\"localstorage://\" + fname);\n    }\n}\n","// import * as tf from '@tensorflow/tfjs-node';\n\n// global variable: array of performance\nvar performanceArray = [[\"episode\", \"score\", \"moves\", \"cumulative reward\"]];\n\nexport async function train(\n    env, agent, params = {\n    batch_size: 32, n_episodes: 50, max_moves: 500, last_episode: 0,\n    exp_replay: true\n    }) {\n    // load parameters\n    const batch_size = params[\"batch_size\"];\n    const n_episodes = params[\"n_episodes\"];\n    const max_moves = params[\"max_moves\"];\n    const last_episode = params[\"last_episode\"];\n    const exp_replay = params[\"exp_replay\"];\n\n    // main\n    var done = 0;\n    for (var e = 1; e <= n_episodes; e++) {\n        // start a new episode\n        var state = env.reset();\n        var cum_reward = 0;\n\n        for (var move = 1; move <= max_moves; move++) {\n            // step forward\n            const action = await agent.act(state);\n            var [next_state, reward, done, score] = env.step(action);\n            agent.remember(state, action, reward, next_state, done);\n            // update state \n            state = next_state;\n            cum_reward += reward;\n            // conclude round\n            if (exp_replay) {\n                await agent.replay(batch_size);\n            }\n            if (done) {\n                if (!(exp_replay)) await agent.replay(batch_size);\n                break;\n            }\n        }\n\n        // training process\n        const processLog = \"progress: {}/{}, score: {}, e: {}, moves: {}/{}\";\n        console.log(processLog.format(\n            e, n_episodes, score, agent.epsilon, move, max_moves\n        ));\n        // save performance\n        performanceArray.push([\n            e + last_episode, score, move, cum_reward\n        ]);\n        // console.log(performanceArray);\n        // save model\n        if (e >= 20 && e % 1 == 0) {\n            // uncomment to download trained models\n            // agent.save_model(\"model_{}\".format(e));\n        }\n    }\n    console.log(\"Training Ended.\")\n    return new Promise((resolve, reject) => {\n        resolve(performanceArray);\n    })\n}\n\n// export async function test_DQN(env, agent, params=None) {\n\n//     // fetch parameters\n//     n_tests = load_params(params, \"n_tests\", 10)\n//     max_moves = load_params(params, \"max_games\", 1000)\n//     FPS = load_params(params, \"FPS\", 10)\n//     verbose = load_params(params, \"verbose\", True)\n\n//     // start testing\n//     done = 0\n\n//     // Save data for performance analysis\n//     // each row is one instance: [reward, score, move]\n//     performance = np.zeros((n_tests, 3))\n\n//     for e in range(n_tests):\n\n//         // Step 1: Initialization\n//         state = env.reset()\n//         cum_reward = 0\n\n//         // Step 2: Simulate one trial of the game\n//         for move in range(max_moves):\n//             // action\n//             action = agent.exploit(state)\n//             // step forward\n//             next_state, reward, done, score = env.step(action)\n//             // conclude round\n//             state = next_state\n//             cum_reward += reward    // (this will always -100pt upon dead)\n//             if (done) {\n//                 break\n//             }\n\n//         // Step 3: Update performance\n//         performance[e,:] = [cum_reward, score, move]\n\n//     return performance\n// }\n\nexport default train;","import Sprite from \"./sprite\"\n\nexport const CANVAS_WIDTH = 20;\nexport const CANVAS_HEIGHT = 20;\nexport const GRID_SIZE = 20;\n\nexport const MANUAL_FPS = 3;\nexport const TEST_FPS = 10;\n\nexport const SNAKE_LENGTH = 1;\n\nexport const COLLIDE_WALL = true;\nexport const COLLIDE_BODY = true;\nexport const EXTRA_WALL = [\n    // [6,7], [7,7], [8,7], [7,6], [7,8],\n];\nfor (var row = 10; row <= 11; row++) {\n    for (var col = 6; col <= 15; col++) {\n        EXTRA_WALL.push([col, row]);\n    }\n}\n// export const WALL_PIX_POS = true; // assume to be always true\n\nexport const MANUAL = true;\n\nexport const STATE_TYPE = \"12bool\";\nexport const REWARD_TYPE = \"basic\";\n\nexport const snakeSprite = new Sprite(\"image/skin_1.png\");\nexport const appleSprite = new Sprite(\"image/star.png\");\nexport const wallSprite = new Sprite(\"image/tile.png\");\n","import {snakeGame} from \"./snakeGameClass\";\nimport {Agent} from \"./agentClass\";\nimport {train} from \"./train.js\";\nimport React from \"react\";\nimport Sketch from 'react-p5';\nimport \"p5\";\nimport {\n    CANVAS_WIDTH, CANVAS_HEIGHT, GRID_SIZE, \n    MANUAL_FPS, TEST_FPS, SNAKE_LENGTH,\n    COLLIDE_WALL, COLLIDE_BODY, EXTRA_WALL,\n    MANUAL,\n    STATE_TYPE, REWARD_TYPE\n} from \"./config\";\nimport * as util from \"./util\";\n\nfunction SnakeEnv(props) {\n    // resize parameters\n\n    // screen\n    var screen_width = props.dimension[0];\n    var screen_height = props.dimension[1];\n    var adaptive_grid_size = Math.min(\n        Math.floor(screen_width/CANVAS_WIDTH), Math.floor(screen_height/CANVAS_HEIGHT)\n    );\n    var screen_size = Math.min(screen_width, screen_height);\n    // score text\n    var text_size = Math.round(0.06*screen_size);\n    // restart button\n    var button_radius = Math.round(0.05*screen_width);\n    var button_x = Math.round(0.9*screen_size);\n    var button_y = Math.round(0.1*screen_size);\n\n    // variables\n\n    const env_params = {\n        width: CANVAS_WIDTH, height: CANVAS_HEIGHT, \n        gridSize: adaptive_grid_size, \n        FPS: MANUAL_FPS,\n        snakeLength: SNAKE_LENGTH, \n        extraWalls: EXTRA_WALL,\n        stateType: STATE_TYPE, rewardType: REWARD_TYPE,\n        manual: props.doManual\n    };\n\n    const agent_params  = {\n        state_size: 12, action_size: 4 \n    };\n\n    let game = new snakeGame(env_params);\n    let agent = new Agent(agent_params);\n\n    let img_restart;\n\n    const setup = (p5, canvasParentRef) => {\n        // use parent to render the canvas in this ref\n        // (without that p5 will render the canvas outside of your component)\n        var cnv = p5.createCanvas(screen_size, screen_size).parent(canvasParentRef);\n        cnv.position(\n            (screen_width - screen_size)/2, (screen_height - screen_size)/2\n        );\n\n        // train / test the model\n        if (props.doTrain) {\n            // alert(\"starting training\");\n            const train_params = {\n                batch_size: 512, n_episodes: 100,\n                max_moves: 1000, last_episode: 0,\n                exp_replay: true\n            };\n            train(game, agent, train_params);\n        }\n    };\n \n    const draw = (p5) => {\n        p5.background(220);\n        // p5.ellipse(50,50,80,80);\n\n        // plot snake and apple\n        p5.stroke(0, 0, 0);\n        game.snake.draw(p5);\n        game.apple.draw(p5);\n\n        // plot extra walls\n        p5.stroke(0, 0, 0);\n        p5.fill(\"#999999\");\n        for (var i=0; i < game.extraWalls.length; i++) {\n            var rect = game.extraWalls[i];\n            p5.rect(rect.x, rect.y, game.gridSize, game.gridSize);\n        }\n\n        // draw a restart button\n        p5.stroke(255,0,0);\n        p5.fill(255, 0, 0, 200);\n        p5.ellipse(button_x, button_y, button_radius, button_radius);\n\n        p5.mouseClicked = () => {\n            if (util.euclidean([p5.mouseX, p5.mouseY], [button_x, button_y]) <= 0.8*button_radius){\n                game.reset();\n            }\n        };\n\n        // draw score\n        p5.stroke(0,0,0,0);\n        p5.fill(\"#000000\");\n        p5.textSize(text_size);\n        p5.text(\"Score: \" + game.score, 0.5*text_size, text_size);\n        p5.text(\"Best Score: \" + game.best_score, 0.5*text_size, 2*text_size);\n\n    };\n\n    if (props.doTest) {\n        return null;\n    }\n\n    return (\n        <div id=\"snake_div\">\n            <Sketch setup={setup} draw={draw} />\n        </div>\n    );\n}\n\nexport default SnakeEnv;","import React, { useRef, useEffect, useState, useLayoutEffect } from 'react';\nimport css from './Genetic.module.css';\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Link\n} from \"react-router-dom\";\n\nimport GeneticParams from './GeneticParams';\nimport Pong from '../games/pong/Pong';\nimport SnakeEnv from '../games/snake/SnakeEnv';\n// import Game from './Game'\n\nfunction Genetic(props) {\n    const gameParentRef = useRef(null);\n    const plotParentRef = useRef(null);\n    const [gameScreenDimension, setGameScreenDimension] = useState({width: 0, height: 0});\n    const [plotScreenDimension, setPlotScreenDimension] = useState({width: 0, height: 0});\n    const [settings, setSettings] = useState({\n                                    'hiddenLayerArchitecture': null,\n                                    'mutationRate': null,\n                                    'mutationRateType': null,\n                                    'numParents': null,\n                                    'numOffsprings': null\n                                    })\n    const [start, setStart] = useState(false);\n\n    useEffect ( () => {\n        if (gameParentRef.current) {\n            setGameScreenDimension({\n                width: gameParentRef.current.offsetWidth,\n                height: gameParentRef.current.offsetHeight\n            });\n        }\n        if (plotParentRef.current) {\n            setPlotScreenDimension({\n                width: plotParentRef.current.offsetWidth,\n                height: plotParentRef.current.offsetHeight\n            });\n        }\n    }, [gameParentRef, plotParentRef]);\n\n    const updateSettings = (hiddenLayerArchitecture, \n                            mutationRate, \n                            mutationRateType,\n                            numParents,\n                            numOffsprings) => {\n        setSettings({'hiddenLayerArchitecture': hiddenLayerArchitecture,\n                    'mutationRate': mutationRate,\n                    'mutationRateType': mutationRateType,\n                    'numParents': numParents,\n                    'numOffsprings': numOffsprings})\n    }\n\n    const updateStart = () => {\n        setStart(!start);\n    }\n\n    return (\n        <Router basename={process.env.PUBLIC_URL}>\n            <div className={css.container}>\n                <h1 className={css.name} onClick={()=>{props.history.push(process.env.PUBLIC_URL+'/')}}>\n                    <Link to='/' className={css.text}>\n                        AlphaGame\n                    </Link>\n                </h1>\n                <div className={css.background}>\n                    <div className={css.gameScreen} ref={gameParentRef}>\n                        {\n                            !start ?\n                            <GeneticParams updateSettings={updateSettings} updateStart={updateStart}/>\n                            :\n                            <Switch>\n                                <Route path='/snake'>\n                                    {/* {\n                                        gameScreenDimension.width === 0 ?\n                                        <div></div> : <Snake dimension={[gameScreenDimension.width, gameScreenDimension.height]}\n                                                            settings={settings}/>\n                                    } */}\n                                </Route>\n                                <Route path='/pong'>\n                                    {\n                                        gameScreenDimension.width === 0 ?\n                                        <div></div> : <Pong dimension={[gameScreenDimension.width, gameScreenDimension.height]}\n                                                            settings={settings}\n                                                            updateStart={updateStart}/>\n                                    }\n                                </Route>\n                                <Route path='/flappybird'>\n                                    {/* {\n                                        gameScreenDimension.width === 0 ?\n                                        <div></div> : <FlappyBird dimension={[gameScreenDimension.width, gameScreenDimension.height]}\n                                                            settings={settings}/>\n                                    } */}\n                                </Route>\n                            </Switch>\n                        }\n                    </div>\n                    <div className={css.plotScreen} ref={plotParentRef}>\n                        <Switch>\n                            <Route path='/snake'>\n                                snake\n                            </Route>\n                            <Route path='/pong'>\n                                pong\n                            </Route>\n                            <Route path='/flappybird'>\n                                flappybird\n                            </Route>\n                        </Switch>\n                    </div>\n                </div>\n            </div>\n            <footer>\n                Copyright © 2020 AlphaGame | \n                <a href='https://github.com/Alexduanran/AlphaGame' target='_blank' style={{textDecoration: 'none', color:'white'}}> Github</a>\n            </footer>\n        </Router>\n    );\n}\n\nexport default Genetic;\n","export default __webpack_public_path__ + \"static/media/snake.c6bcedf4.png\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/flappybird.31b09d32.png\";","export default __webpack_public_path__ + \"static/media/home2_gif.f51dd1b0.gif\";","export default __webpack_public_path__ + \"static/media/snake_gif.61188676.gif\";","export default __webpack_public_path__ + \"static/media/pong_gif.34e92973.gif\";","export default __webpack_public_path__ + \"static/media/flappybird_gif.87071256.gif\";","import React, {useState} from 'react';\nimport css from './Home.module.css';\nimport Genetic from './Genetic'\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Link\n} from \"react-router-dom\";\nimport { Swiper, SwiperSlide } from 'swiper/react';\nimport SwiperCore, { Pagination, Mousewheel, EffectCoverflow } from 'swiper';\nimport 'swiper/swiper.scss';\nimport 'swiper/components/navigation/navigation.scss';\nimport 'swiper/components/pagination/pagination.scss';\nimport 'swiper/components/scrollbar/scrollbar.scss';\nimport 'swiper/components/effect-coverflow/effect-coverflow.scss';\nimport snake_png from '../media/snake.png';\nimport pong_png from '../media/pong.png';\nimport flappybird_png from '../media/flappybird.png';\nimport home2_gif from '../media/home2_gif.gif';\nimport snake_gif from '../media/snake_gif.gif';\nimport pong_gif from '../media/pong_gif.gif';\nimport flappybird_gif from '../media/flappybird_gif.gif';\n\nfunction Home(props) {\n    const [background, setBackground] = useState(home2_gif);\n    const [swipeIndex, setSwipeIndex] = useState(0);\n\n    SwiperCore.use([EffectCoverflow, Pagination, Mousewheel]);\n\n    function GameSwiper() {\n        setBackground(home2_gif);\n        return (\n            <Swiper className={css.swiperContainer}\n                    effect='coverflow'\n                    spaceBetween={30}\n                    slidesPerView={3}\n                    dynamicBullets={true}\n                    mousewheel={true}\n                    pagination={{ clickable: true }}\n                    centeredSlides={true}\n                    loop={true}\n                    initialSlide={swipeIndex}\n                    >\n                <SwiperSlide>\n                    <Link to='/snake'>\n                        <div className={css.square} style={{backgroundImage:`url(${snake_png})`}} />    \n                    </Link>\n                </SwiperSlide>\n                <SwiperSlide>\n                    <Link to='/pong'> \n                        <div className={css.square} style={{backgroundImage:`url(${pong_png})`}} />\n                    </Link>\n                </SwiperSlide>\n                <SwiperSlide>\n                    <Link to='/flappybird'>\n                        <div className={css.square} style={{backgroundImage:`url(${flappybird_png})`}} />\n                    </Link>\n                </SwiperSlide>\n            </Swiper>\n        )\n    }\n\n    function GameModes(prop) {\n        var image = null;\n        if (prop.name === 'snake') {\n            setBackground(snake_gif);\n            setSwipeIndex(0);\n            image = snake_png;\n        }\n        else if (prop.name === 'pong') {\n            setBackground(pong_gif);\n            setSwipeIndex(1);\n            image = pong_png;\n        }\n        else if (prop.name === 'flappybird') {\n            setBackground(flappybird_gif);\n            setSwipeIndex(2);\n            image = flappybird_png;\n        }\n        return (\n            <div className={css.grid}>\n                <div className={css.smallpic} style={{backgroundImage:`url(${image})`}} />\n                <div className={css.smallsquare} onClick={()=>{console.log(process.env.PUBLIC_URL);props.history.push(process.env.PUBLIC_URL + '/' + prop.name + '/genetic')}} >\n                    <h1 className={css.mode}>\n                        Genetic\n                        Algorithm\n                    </h1>\n                </div>\n                <div className={css.smallsquare} onClick={()=>{props.history.push(process.env.PUBLIC_URL + '/' + prop.name + '/reinforcement')}} >\n                    <h1 className={css.mode}>\n                        Reinforce-\n                        ment\n                        Learning\n                    </h1>\n                </div>\n                <div className={css.smallsquare} onClick={()=>{props.history.push(process.env.PUBLIC_URL + '/' + prop.name + '/battle')}} >\n                    <h1 className={css.mode}>\n                        Human\n                        vs.\n                        AI\n                    </h1>\n                </div>\n            </div>\n        )\n    }\n\n    return (\n        <Router basename={process.env.PUBLIC_URL}>\n            <div className={css.container}>\n                <h1 className={css.name}>\n                    <Link to='/' className={css.text}>\n                        AlphaGame\n                    </Link>\n                </h1>\n                <div className={css.background}>\n                    <div className={css.screen} style={{backgroundImage:`url(${background})`}}>\n                        <Switch>\n                            <Route path='/snake' >\n                                <GameModes name={'snake'} />\n                            </Route>\n                            <Route path='/pong'>\n                                <GameModes name={'pong'} />\n                            </Route>\n                            <Route path='/flappybird'>\n                                <GameModes name={'flappybird'} />\n                            </Route>\n                            <Route path='/'>\n                                <GameSwiper className={css.swiper}/>\n                            </Route>\n                        </Switch>\n                    </div>\n                </div>\n            </div>\n            <footer>\n                Copyright © 2020 AlphaGame | \n                <a href='https://github.com/Alexduanran/AlphaGame' target='_blank' style={{textDecoration: 'none', color:'white'}}> Github</a>\n            </footer>\n        </Router>\n    );\n    }\n\nexport default Home;\n","import React, { useRef, useEffect, useState, useLayoutEffect } from 'react';\nimport css from './Reinforcement.module.css';\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Link\n} from \"react-router-dom\";\n\nimport SnakeEnv from \"../games/snake/SnakeEnv\"\n\nfunction Reinforcement(props) {\n\n    const gameParentRef = useRef(null);\n    const plotParentRef = useRef(null);\n    const [gameScreenDimension, setGameScreenDimension] = useState({width: 0, height: 0});\n    const [plotScreenDimension, setPlotScreenDimension] = useState({width: 0, height: 0});\n\n    useEffect ( () => {\n        if (gameParentRef.current) {\n            setGameScreenDimension({\n                width: gameParentRef.current.offsetWidth,\n                height: gameParentRef.current.offsetHeight\n            });\n        }\n        if (plotParentRef.current) {\n            setPlotScreenDimension({\n                width: plotParentRef.current.offsetWidth,\n                height: plotParentRef.current.offsetHeight\n            });\n        }\n    }, [gameParentRef, plotParentRef]);\n    return (\n        <Router basename={process.env.PUBLIC_URL}>\n            <div className={css.container}>\n                <h1 className={css.name} onClick={()=>{props.history.push(process.env.PUBLIC_URL+'/')}}>\n                    <Link to='/' className={css.text}>\n                        AlphaGame\n                    </Link>\n                </h1>\n                <div className={css.background}>\n                    <div className={css.gameScreen} ref={gameParentRef}>\n                        <Switch>\n                            <Route path='/snake'>\n                                {/* define env_params as a props.attribute if necessary */}\n                                {\n                                    gameScreenDimension.width === 0 ?\n                                    <div></div> : <SnakeEnv \n                                        doManual={false} \n                                        doTrain={true} \n                                        doTest={false} \n                                        dimension={[gameScreenDimension.width, gameScreenDimension.height]}\n                                    />\n                                }\n                            </Route>\n                            <Route path='/pong'>\n                                pong\n                            </Route>\n                            <Route path='/flappybird'>\n                                flappybird\n                            </Route>\n                        </Switch>\n                    </div>\n                    <div className={css.plotScreen} ref={plotParentRef}>\n                        <Switch>\n                            <Route path='/snake'>\n                                snake\n                            </Route>\n                            <Route path='/pong'>\n                                pong\n                            </Route>\n                            <Route path='/flappybird'>\n                                flappybird\n                            </Route>\n                        </Switch>\n                    </div>\n                </div>\n            </div>\n            <footer>\n                Copyright © 2020 AlphaGame | \n                <a href='https://github.com/Alexduanran/AlphaGame' target='_blank' style={{textDecoration: 'none', color:'white'}}> Github</a>\n            </footer>\n        </Router>\n    );\n}\n\nexport default Reinforcement;\n","import css from './Battle.module.css';\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Link\n} from \"react-router-dom\";\n\nfunction Battle(props) {\n  return (\n    <Router basename={process.env.PUBLIC_URL}>\n        <div className={css.container}>\n            <h1 className={css.name} onClick={()=>{props.history.push(process.env.PUBLIC_URL+'/')}}>\n                <Link to='/' className={css.text}>\n                    AlphaGame\n                </Link>\n            </h1>\n            <div className={css.background}>\n                <div className={css.gameScreen}>\n                    <Switch>\n                        <Route path='/snake'>\n                            snake\n                        </Route>\n                        <Route path='/pong'>\n                            pong\n                        </Route>\n                        <Route path='/flappybird'>\n                            flappybird\n                        </Route>\n                    </Switch>\n                </div>\n                <div className={css.plotScreen}>\n                    <Switch>\n                        <Route path='/snake'>\n                            {/* {\n                                gameScreenDimension.width === 0 ?\n                                <div></div> : \n                                <SnakeEnv dimension={[gameScreenDimension.width, gameScreenDimension.height]}/>\n                            } */}\n                        </Route>\n                        <Route path='/pong'>\n                            pong\n                        </Route>\n                        <Route path='/flappybird'>\n                            flappybird\n                        </Route>\n                    </Switch>\n                </div>\n            </div>\n        </div>\n        <footer>\n            Copyright © 2020 AlphaGame | \n            <a href='https://github.com/Alexduanran/AlphaGame' target='_blank' style={{textDecoration: 'none', color:'white'}}> Github</a>\n        </footer>\n    </Router>\n  );\n}\n\nexport default Battle;\n","import css from './App.module.css';\nimport Home from './Home';\nimport Genetic from './Genetic';\nimport Reinforcement from './Reinforcement';\nimport Battle from './Battle';\nimport {\n  Router,\n  Switch,\n  Route,\n  Link\n} from \"react-router-dom\";\nimport { createBrowserHistory } from 'history';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nconst history = createBrowserHistory();\n\nfunction App() {\n  return (\n    <div className={css.background}>\n      <Router history={history} basename={process.env.PUBLIC_URL}>\n        <Switch>\n          <Route path='/*/genetic'>\n            <Genetic history={history}/>\n          </Route>\n          <Route path='/*/reinforcement'>\n            <Reinforcement history={history}/>\n          </Route>\n          <Route path='*/battle'>\n            <Battle history={history}/>\n          </Route>\n          <Route path='/'>\n            <Home history={history}/>\n          </Route>\n        </Switch>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './pages/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"Home_background__3HbSX\",\"container\":\"Home_container__-DMjm\",\"grid\":\"Home_grid__33I0i\",\"mode\":\"Home_mode__2BOJe\",\"name\":\"Home_name__10Kwj\",\"smallpic\":\"Home_smallpic__3N7EV\",\"smallsquare\":\"Home_smallsquare__1oBA_\",\"screen\":\"Home_screen__3rdgN\",\"square\":\"Home_square__l604N\",\"swiper\":\"Home_swiper__33oto\",\"swiperContainer\":\"Home_swiperContainer__1LfR4\",\"text\":\"Home_text__3zRIA\"};"],"sourceRoot":""}